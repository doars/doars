var E=(s,r,n,e)=>({deconstruct:!!s.deconstruct,name:"$store",create:(t,i,l,{RevocableProxy:o})=>{let c=(v,d)=>l(r,d.join(".")),f=(v,d)=>i.accessed(r,d.join(".")),u=(v,d)=>l(r,d.join("."));e.addEventListener("delete",c),e.addEventListener("get",f),e.addEventListener("set",u);let p=o(n,{});return{value:p.proxy,destroy:()=>{e.removeEventListener("delete",c),e.removeEventListener("get",f),e.removeEventListener("set",u),p.revoke()}}}});var L=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],m=(s,r)=>{let n=!1,e={};for(let t of L)e[t]=(...i)=>{if(n){console.error("illegal operation attempted on a revoked proxy");return}return t in r?r[t](...i):Reflect[t](...i)};return{proxy:new Proxy(s,e),revoke:()=>{n=!0}}};var x=class{constructor(){let r={};this.addEventListener=(n,e,t=null)=>{n in r||(r[n]=[]),r[n].push({callback:e,options:t})},this.removeEventListener=(n,e)=>{if(!Object.keys(r).includes(n))return;let t=r[n],i=-1;for(let l=0;l<t.length;l++)if(t[l].callback===e){i=l;break}i<0||(t.splice(i,1),Object.keys(t).length===0&&delete r[n])},this.removeEventListeners=n=>{!n||delete r[n]},this.removeAllEventListeners=()=>{r={}},this.dispatchEvent=(n,e,t=null)=>{if(!r[n])return;let i=r[n];for(let l=0;l<i.length;l++){let o=t&&t.reverse?i[i.length-(l+1)]:i[l];o.options&&o.options.once&&i.splice(l,1),o.callback(...e)}}}},h=x;var y=class extends h{constructor(r={}){super(),r=Object.assign({delete:!0,get:!0,set:!0},r);let n=new WeakMap;this.add=(e,t=[])=>{if(n.has(e))return n.get(e);for(let o in e)e[o]&&typeof e[o]=="object"&&(e[o]=this.add(e[o],[...t,o]));let i={};r.delete&&(i.deleteProperty=(o,c)=>{if(!Reflect.has(o,c))return!0;this.remove(o,c);let f=Reflect.deleteProperty(o,c);return f&&this.dispatchEvent("delete",[o,Array.isArray(o)?[...t]:[...t,c]]),f}),r.get&&(i.get=(o,c,f)=>(c!==Symbol.unscopables&&this.dispatchEvent("get",[o,[...t,c],f]),Reflect.get(o,c,f))),r.set&&(i.set=(o,c,f,u)=>(o[c]===f||(typeof f=="object"&&(f=this.add(f,[...t,c])),o[c]=f,this.dispatchEvent("set",[o,Array.isArray(o)?[...t]:[...t,c],f,u])),!0));let l=m(e,i);return n.set(l,e),l.proxy},this.remove=e=>{if(!n.has(e))return;let t=n.get(e);n.delete(t);for(let i in t.proxy)typeof t.proxy[i]=="object"&&this.remove(t.proxy[i]);t.revoke()}}},g=y;var a=(s,...r)=>{if(!r.length)return s;let n=r.shift();if(b(s)&&b(n))for(let e in n)b(n[e])?(s[e]||Object.assign(s,{[e]:{}}),a(s[e],n[e])):Array.isArray(n[e])?s[e]=n[e].map(t=>b(t)?a({},t):t):Object.assign(s,{[e]:n[e]});return a(s,...r)};var b=s=>s&&typeof s=="object"&&!Array.isArray(s);function I(s,r=null,n={}){r=Object.assign({deconstruct:!1},r);let e=!1,t,i,l,o,c=function(){i=a({},n),l=new g,o=l.add(i);let u=Symbol("ID_STORE");t=E(r,u,o,l);let p=s.getContexts(),v=0;for(let d=p.length-1;d>=0;d--)if(p[d].name==="$state"){v=d;break}s.addContexts(v,t)},f=function(){s.removeContexts(t),o=null,l.remove(i),l=null,i=null,directiveSyncStore=null,t=null};this.disable=function(){!s.getEnabled()&&e&&(e=!1,s.removeEventListener("enabling",c),s.removeEventListener("disabling",f))},this.enable=function(){e||(e=!0,s.addEventListener("enabling",c),s.addEventListener("disabling",f))},this.enable()}export{I as default};
//# sourceMappingURL=doars-store.esm.min.js.map
