var global,factory;global=this,factory=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e,t,n,r){return{deconstruct:!!e.deconstruct,name:"$store",create:function(e,o,i,a){var c=a.RevocableProxy,f=function(e,n){return i(t,n.join("."))},u=function(e,n){return o.accessed(t,n.join("."))},l=function(e,n){return i(t,n.join("."))};r.addEventListener("delete",f),r.addEventListener("get",u),r.addEventListener("set",l);var s=c(n,{});return{value:s.proxy,destroy:function(){r.removeEventListener("delete",f),r.removeEventListener("get",u),r.removeEventListener("set",l),s.revoke()}}}}},l=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],s=function(e,t){var n,r=!1,o={},i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){f=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(f)throw i}}}}(l);try{var a=function(){var e=n.value;o[e]=function(){if(!r)return e in t?t[e].apply(t,arguments):Reflect[e].apply(Reflect,arguments);console.error("illegal operation attempted on a revoked proxy")}};for(i.s();!(n=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}return{proxy:new Proxy(e,o),revoke:function(){r=!0}}},y=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(l,t);var c,f,u=(c=l,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=r(c);if(f){var n=r(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return i(this,e)});function l(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,l),t=u.call(this),n=Object.assign({delete:!0,get:!0,set:!0},n);var r=new WeakMap;return t.add=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r.has(e))return r.get(e);for(var i in e)e[i]&&"object"==typeof e[i]&&(e[i]=t.add(e[i],[].concat(a(o),[i])));var c={};n.delete&&(c.deleteProperty=function(e,n){if(!Reflect.has(e,n))return!0;t.remove(e,n);var r=Reflect.deleteProperty(e,n);return r&&t.dispatchEvent("delete",[e,Array.isArray(e)?a(o):[].concat(a(o),[n])]),r}),n.get&&(c.get=function(e,n,r){return n!==Symbol.unscopables&&t.dispatchEvent("get",[e,[].concat(a(o),[n]),r]),Reflect.get(e,n,r)}),n.set&&(c.set=function(e,n,r,i){return e[n]===r||("object"==typeof r&&(r=t.add(r,[].concat(a(o),[n]))),e[n]=r,t.dispatchEvent("set",[e,Array.isArray(e)?a(o):[].concat(a(o),[n]),r,i])),!0});var f=s(e,c);return r.set(f,e),f.proxy},t.remove=function(e){if(r.has(e)){var n=r.get(e);for(var o in r.delete(n),n.proxy)"object"==typeof n.proxy[o]&&t.remove(n.proxy[o]);n.revoke()}},t}return n(l)}(n((function t(){e(this,t);var n={};this.addEventListener=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e in n||(n[e]=[]),n[e].push({callback:t,options:r})},this.removeEventListener=function(e,t){if(Object.keys(n).includes(e)){for(var r=n[e],o=-1,i=0;i<r.length;i++)if(r[i].callback===t){o=i;break}o<0||(r.splice(o,1),0===Object.keys(r).length&&delete n[e])}},this.removeEventListeners=function(e){e&&delete n[e]},this.removeAllEventListeners=function(){n={}},this.dispatchEvent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n[e])for(var o=n[e],i=0;i<o.length;i++){var c=r&&r.reverse?o[o.length-(i+1)]:o[i];c.options&&c.options.once&&o.splice(i,1),c.callback.apply(c,a(t))}}}))),p=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(!r.length)return t;var i=r.shift();if(d(t)&&d(i))for(var a in i)d(i[a])?(t[a]||Object.assign(t,{[a]:{}}),e(t[a],i[a])):Array.isArray(i[a])?t[a]=i[a].map((function(t){return d(t)?e({},t):t})):Object.assign(t,{[a]:i[a]});return e.apply(void 0,[t].concat(r))},d=function(e){return e&&"object"==typeof e&&!Array.isArray(e)};return n((function t(n){var r,o,i,a,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,t),c=Object.assign({deconstruct:!1},c),n.addEventListener("enabling",(function(){o=p({},f),i=new y,a=i.add(o);var e=Symbol();r=u(c,e,a,i);for(var t=n.getContexts(),l=0,s=t.length-1;s>=0;s--)if("$state"===t[s].name){l=s;break}n.addContexts(l,r)})),n.addEventListener("disabling",(function(){n.removeContexts(r),a=null,i.remove(o),i=null,o=null,directiveSyncStore=null,r=null}))}))},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global="undefined"!=typeof globalThis?globalThis:global||self).DoarsStore=factory();
