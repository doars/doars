(()=>{var E=(c,n,r,e)=>({deconstruct:!!c.deconstruct,name:"$store",create:(t,s,i,{RevocableProxy:o})=>{let l=(x,p)=>i(n,p.join(".")),f=(x,p)=>s.accessed(n,p.join(".")),d=(x,p)=>i(n,p.join("."));e.addEventListener("delete",l),e.addEventListener("get",f),e.addEventListener("set",d);let u=o(r,{});return{value:u.proxy,destroy:()=>{e.removeEventListener("delete",l),e.removeEventListener("get",f),e.removeEventListener("set",d),u.revoke()}}}});var g=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],h=(c,n)=>{let r=!1,e={};for(let t of g)e[t]=(...s)=>{if(r){console.error("illegal operation attempted on a revoked proxy");return}return t in n?n[t](...s):Reflect[t](...s)};return{proxy:new Proxy(c,e),revoke:()=>{r=!0}}};var m=class{constructor(){let n={};this.addEventListener=(r,e,t=null)=>{r in n||(n[r]=[]),n[r].push({callback:e,options:t})},this.removeEventListener=(r,e)=>{if(!Object.keys(n).includes(r))return;let t=n[r],s=-1;for(let i=0;i<t.length;i++)if(t[i].callback===e){s=i;break}s<0||(t.splice(s,1),Object.keys(t).length===0&&delete n[r])},this.removeEventListeners=r=>{!r||delete n[r]},this.removeAllEventListeners=()=>{n={}},this.dispatchEvent=(r,e,t=null)=>{if(!n[r])return;let s=n[r];for(let i=0;i<s.length;i++){let o=t&&t.reverse?s[s.length-(i+1)]:s[i];o.options&&o.options.once&&s.splice(i,1),o.callback(...e)}}}},j=m;var b=class extends j{constructor(n={}){super(),n=Object.assign({delete:!0,get:!0,set:!0},n);let r=new WeakMap;this.add=(e,t=[])=>{if(r.has(e))return r.get(e);for(let o in e)e[o]&&typeof e[o]=="object"&&(e[o]=this.add(e[o],[...t,o]));let s={};n.delete&&(s.deleteProperty=(o,l)=>{if(!Reflect.has(o,l))return!0;this.remove(o,l);let f=Reflect.deleteProperty(o,l);return f&&this.dispatchEvent("delete",[o,Array.isArray(o)?[...t]:[...t,l]]),f}),n.get&&(s.get=(o,l,f)=>(l!==Symbol.unscopables&&this.dispatchEvent("get",[o,[...t,l],f]),Reflect.get(o,l,f))),n.set&&(s.set=(o,l,f,d)=>(o[l]===f||(typeof f=="object"&&(f=this.add(f,[...t,l])),o[l]=f,this.dispatchEvent("set",[o,Array.isArray(o)?[...t]:[...t,l],f,d])),!0));let i=h(e,s);return r.set(i,e),i.proxy},this.remove=e=>{if(!r.has(e))return;let t=r.get(e);r.delete(t);for(let s in t.proxy)typeof t.proxy[s]=="object"&&this.remove(t.proxy[s]);t.revoke()}}},O=b;var v=(c,...n)=>{if(!n.length)return c;let r=n.shift();if(a(c)&&a(r))for(let e in r)a(r[e])?(c[e]||Object.assign(c,{[e]:{}}),v(c[e],r[e])):Array.isArray(r[e])?c[e]=r[e].map(t=>a(t)?v({},t):t):Object.assign(c,{[e]:r[e]});return v(c,...n)};var a=c=>c&&typeof c=="object"&&!Array.isArray(c);var y=class{constructor(n,r=null,e={}){r=Object.assign({deconstruct:!1},r);let t,s,i,o;n.addEventListener("enabling",()=>{s=v({},e),i=new O,o=i.add(s);let l=Symbol("ID_STORE");t=E(r,l,o,i);let f=n.getContexts(),d=0;for(let u=f.length-1;u>=0;u--)if(f[u].name==="$state"){d=u;break}n.addContexts(d,t)}),n.addEventListener("disabling",()=>{n.removeContexts(t),o=null,i.remove(s),i=null,s=null,directiveSyncStore=null,t=null})}};window.DoarsStore=y;})();
//# sourceMappingURL=doars-store.iife.min.js.map
