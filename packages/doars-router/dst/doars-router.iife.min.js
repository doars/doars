(()=>{var L=(t,...r)=>{if(!r.length)return t;let e=r.shift();if(U(t)&&U(e))for(let n in e)U(e[n])?(t[n]||Object.assign(t,{[n]:{}}),L(t[n],e[n])):Array.isArray(e[n])?t[n]=e[n].map(i=>U(i)?L({},i):i):Object.assign(t,{[n]:e[n]});return L(t,...r)};var U=t=>t&&typeof t=="object"&&!Array.isArray(t);var k=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],V=(t,r)=>{let e=!1,n={};for(let i of k)n[i]=(...o)=>{if(!e)return i in r?r[i](...o):Reflect[i](...o)};return{proxy:new Proxy(t,n),revoke:()=>{e=!0}}};var g=Symbol("ROUTER");function ee(t){for(var r=[],e=0;e<t.length;){var n=t[e];if(n==="*"||n==="+"||n==="?"){r.push({type:"MODIFIER",index:e,value:t[e++]});continue}if(n==="\\"){r.push({type:"ESCAPED_CHAR",index:e++,value:t[e++]});continue}if(n==="{"){r.push({type:"OPEN",index:e,value:t[e++]});continue}if(n==="}"){r.push({type:"CLOSE",index:e,value:t[e++]});continue}if(n===":"){for(var i="",o=e+1;o<t.length;){var s=t.charCodeAt(o);if(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||s===95){i+=t[o++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(e));r.push({type:"NAME",index:e,value:i}),e=o;continue}if(n==="("){var c=1,a="",o=e+1;if(t[o]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(o));for(;o<t.length;){if(t[o]==="\\"){a+=t[o++]+t[o++];continue}if(t[o]===")"){if(c--,c===0){o++;break}}else if(t[o]==="("&&(c++,t[o+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(o));a+=t[o++]}if(c)throw new TypeError("Unbalanced pattern at ".concat(e));if(!a)throw new TypeError("Missing pattern at ".concat(e));r.push({type:"PATTERN",index:e,value:a}),e=o;continue}r.push({type:"CHAR",index:e,value:t[e++]})}return r.push({type:"END",index:e,value:""}),r}function te(t,r){r===void 0&&(r={});for(var e=ee(t),n=r.prefixes,i=n===void 0?"./":n,o="[^".concat(N(r.delimiter||"/#?"),"]+?"),s=[],c=0,a=0,l="",f=function(v){if(a<e.length&&e[a].type===v)return e[a++].value},u=function(v){var b=f(v);if(b!==void 0)return b;var A=e[a],j=A.type,H=A.index;throw new TypeError("Unexpected ".concat(j," at ").concat(H,", expected ").concat(v))},x=function(){for(var v="",b;b=f("CHAR")||f("ESCAPED_CHAR");)v+=b;return v};a<e.length;){var E=f("CHAR"),I=f("NAME"),O=f("PATTERN");if(I||O){var h=E||"";i.indexOf(h)===-1&&(l+=h,h=""),l&&(s.push(l),l=""),s.push({name:I||c++,prefix:h,suffix:"",pattern:O||o,modifier:f("MODIFIER")||""});continue}var m=E||f("ESCAPED_CHAR");if(m){l+=m;continue}l&&(s.push(l),l="");var D=f("OPEN");if(D){var h=x(),P=f("NAME")||"",d=f("PATTERN")||"",R=x();u("CLOSE"),s.push({name:P||(d?c++:""),pattern:P&&!d?o:d,prefix:h,suffix:R,modifier:f("MODIFIER")||""});continue}u("END")}return s}function N(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function B(t){return t&&t.sensitive?"":"i"}function re(t,r){if(!r)return t;for(var e=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,i=e.exec(t.source);i;)r.push({name:i[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),i=e.exec(t.source);return t}function ne(t,r,e){var n=t.map(function(i){return M(i,r,e).source});return new RegExp("(?:".concat(n.join("|"),")"),B(e))}function ie(t,r,e){return oe(te(t,e),r,e)}function oe(t,r,e){e===void 0&&(e={});for(var n=e.strict,i=n===void 0?!1:n,o=e.start,s=o===void 0?!0:o,c=e.end,a=c===void 0?!0:c,l=e.encode,f=l===void 0?function(H){return H}:l,u=e.delimiter,x=u===void 0?"/#?":u,E=e.endsWith,I=E===void 0?"":E,O="[".concat(N(I),"]|$"),h="[".concat(N(x),"]"),m=s?"^":"",D=0,P=t;D<P.length;D++){var d=P[D];if(typeof d=="string")m+=N(f(d));else{var R=N(f(d.prefix)),v=N(f(d.suffix));if(d.pattern)if(r&&r.push(d),R||v)if(d.modifier==="+"||d.modifier==="*"){var b=d.modifier==="*"?"?":"";m+="(?:".concat(R,"((?:").concat(d.pattern,")(?:").concat(v).concat(R,"(?:").concat(d.pattern,"))*)").concat(v,")").concat(b)}else m+="(?:".concat(R,"(").concat(d.pattern,")").concat(v,")").concat(d.modifier);else d.modifier==="+"||d.modifier==="*"?m+="((?:".concat(d.pattern,")").concat(d.modifier,")"):m+="(".concat(d.pattern,")").concat(d.modifier);else m+="(?:".concat(R).concat(v,")").concat(d.modifier)}}if(a)i||(m+="".concat(h,"?")),m+=e.endsWith?"(?=".concat(O,")"):"$";else{var A=t[t.length-1],j=typeof A=="string"?h.indexOf(A[A.length-1])>-1:A===void 0;i||(m+="(?:".concat(h,"(?=").concat(O,"))?")),j||(m+="(?=".concat(h,"|").concat(O,")"))}return new RegExp(m,B(e))}function M(t,r,e){return t instanceof RegExp?re(t,r):Array.isArray(t)?ne(t,r,e):ie(t,r,e)}var S=class{constructor(){let r={};this.addEventListener=(e,n,i=null)=>{e in r||(r[e]=[]),r[e].push({callback:n,options:i})},this.removeEventListener=(e,n)=>{if(!Object.keys(r).includes(e))return;let i=r[e],o=-1;for(let s=0;s<i.length;s++)if(i[s].callback===n){o=s;break}o<0||(i.splice(o,1),Object.keys(i).length===0&&delete r[e])},this.removeEventListeners=e=>{e&&delete r[e]},this.removeAllEventListeners=()=>{r={}},this.dispatchEvent=(e,n,i=null)=>{if(!r[e])return;let o=r[e];for(let s=0;s<o.length;s++){let c=i&&i.reverse?o[o.length-(s+1)]:o[s];c.options&&c.options.once&&o.splice(s,1),c.callback(...n)}}}};var C=class extends S{constructor(r={}){super();let e=Symbol("ID_ROUTER");r=Object.assign({basePath:"",path:null,pathToRegexp:{},updateHistory:!1},r);let n=r.path,i=null,o={},s=()=>{this.setPath(window.location.pathname)};r.updateHistory&&window.addEventListener("popstate",s);let c=(a,l,f)=>{if(n=l,i=f,r.updateHistory){let u=a.includes(r.basePath)?a:r.basePath+a;u!==window.location.pathname&&window.history.pushState(null,window.document.title,u)}this.dispatchEvent("changed",[this,i,n])};this.getId=()=>e,this.getPath=()=>n,this.getRoute=()=>i,this.getRoutes=()=>Object.keys(o),this.destroy=()=>{r.updateHistory&&window.removeEventListener("popstate",s),r=null,n=null,i=null,o=null,this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.addRoute=a=>{if(o[a]=M(a,[],r.pathToRegexp),this.dispatchEvent("added",[this,a]),n){let l=n.replace(r.basePath,"");o[a].test(l)&&c(n,l,a)}},this.removeRoute=a=>{delete o[a],this.dispatchEvent("removed",[this,a]),i===a&&(n=null,i=null,this.dispatchEvent("changed",[this,i,n]))},this.setPath=a=>{let l=a.replace(r.basePath,"");if(n===l)return;let f=null;for(let u in o)if(o[u].test(l)){f=u;break}c(a,l,f)}}};var q=t=>{if(t.parentElement)return t=t.parentElement,t[g]?t[g]:q(t)},w=q;var K=({routerContextName:t})=>({name:t,create:(r,e)=>{let n=e.getElement(),i=null,o=V({},{get:(s,c,a)=>{if(i===null&&(n[g]?i=n[g]:i=w(n),i||(i=!1)),e.accessed(i.getId(),""),!!i)return Reflect.get(i,c,a)}});return{value:o.proxy,destroy:()=>{o.revoke()}}}});var X=(t,r)=>{t.nextSibling?t.parentNode.insertBefore(r,t.nextSibling):t.parentNode.appendChild(r)};var _=t=>{if(typeof t=="string"&&(t=t.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(t))return;let r={};for(let e of t)switch(e=e.trim(),e[0]){case"#":r.id=e.substring(1);break;case".":e=e.substring(1),r.class||(r.class=[]),r.class.includes(e)||r.class.push(e);break;case"[":let[n,i,o]=e.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);r[i]=o;break}return r};var $=(t,r)=>{for(let e in r){if(e==="class"){for(let n of r.class)t.classList.add(n);continue}t.setAttribute(e,r[e])}};var T=(t,r)=>{for(let e in r){if(e==="class"){for(let n of r.class)t.classList.remove(n);continue}r[e]&&t.attributes[e]!==r[e]||t.removeAttribute(e)}};var se="-transition:",Y=(t,r,e,n=null)=>{if(e.nodeType!==1){n&&n();return}let i=r.prefix+se+t,o=x=>{e.dispatchEvent(new CustomEvent("transition-"+x)),e.dispatchEvent(new CustomEvent("transition-"+t+"-"+x))},s,c,a,l,f=!1,u={};return s=i,c=e.getAttribute(s),c&&(u.during=_(c),$(e,u.during)),s=i+".from",c=e.getAttribute(s),c&&(u.from=_(c),$(e,u.from)),o("start"),l=requestAnimationFrame(()=>{if(l=null,f)return;if(u.from&&(T(e,u.from),u.from=void 0),s=i+".to",c=e.getAttribute(s),c)u.to=_(c),$(e,u.to);else if(!u.during){o("end"),n&&n(),f=!0;return}let x=getComputedStyle(e),E=Number(x.transitionDuration.replace(/,.*/,"").replace("s",""))*1e3;E===0&&(E=Number(x.animationDuration.replace("s",""))*1e3),a=setTimeout(()=>{a=null,!f&&(u.during&&(T(e,u.during),u.during=void 0),u.to&&(T(e,u.to),u.to=void 0),o("end"),n&&n(),f=!0)},E)}),()=>{f&&(f=!0,u.during&&(T(e,u.during),u.during=void 0),u.from?(T(e,u.from),u.from=void 0):u.to&&(T(e,u.to),u.to=void 0),l?(cancelAnimationFrame(l),l=null):a&&(clearTimeout(a),a=null),o("end"),n&&n())}},F=(t,r,e)=>Y("in",t,r,e),W=(t,r,e)=>Y("out",t,r,e);var p=Symbol("ROUTE"),G=({routeDirectiveName:t})=>({name:t,update:(r,e)=>{let n=r.getLibrary().getOptions(),i=e.getElement(),o,s=()=>{if(o&&e[p]&&(o.removeEventListener("changed",e[p].handler),o.removeEventListener("destroyed",e[p].setup),delete e[p]),o=w(i),!o)return;e[p]={setup:s};let c=e.getValue();o.addRoute(c);let a=(l,f)=>{if(f!==c)if(i.tagName==="TEMPLATE"){if(e[p]&&e[p].element){let u=e[p].element;W(n,u,()=>{u.remove(),e[p].element=void 0})}}else W(n,i,()=>{i.style.display="none"});else if(i.tagName==="TEMPLATE"){let u=document.importNode(i.content,!0);X(i,u),e[p].element=i.nextSibling,F(n,e[p].element)}else i.style.display=null,F(n,i)};e[p].handler=a,o.addEventListener("changed",a),a(o,o.getRoute()),o.addEventListener("destroyed",s)};s()},destroy:(r,e,{transitionOut:n})=>{let i=r.getLibrary().getOptions(),o=e.getElement();if(o.tagName==="TEMPLATE"){if(e[p]&&e[p].element){let c=e[p].element;n(i,c,()=>{c.remove(),e[p].element=void 0})}}else n(i,o,()=>{o.style.display="none"});let s=w(o);s&&e[p]&&(s.removeEventListener("destroyed",e[p].setup),e[p].handler&&s.removeEventListener("change",e[p].handler))}});var J=t=>({name:t.routerDirectiveName,update:(r,e,n)=>{let i=e.getElement(),o=i[g];o||(o=i[g]=new C(Object.assign({},t,n(r,e,e.getValue()))))},destroy:(r,e)=>{let n=e.getElement(),i=n[g];if(!i)return;delete n[g];let o=i.getId();i.destroy(),r.getLibrary().update([{id:o,path:""}])}});var y=Symbol("ROUTE_TO"),z="click",Q=({routeToDirectiveName:t})=>({name:t,update:(r,e)=>{let n=e.getElement(),i=e.getModifiers(),o=e.getValue();if(e[y]){if(e[y].value===o)return;e[y].target.removeEventListener(z,e[y].handler)}let s=c=>{if(i.self&&c.target!==n)return;i.prevent&&c.preventDefault(),i.stop&&c.stopPropagation();let a=w(n);a&&a.setPath(o)};n.addEventListener(z,s),e[y]={handler:s,value:o}},destroy:(r,e)=>{if(!e[y])return;e.getElement().removeEventListener(z,e[y].handler),delete e[y]}});function Z(t,r=null){r=L({basePath:"",path:"",pathToRegexp:{},updateHistory:!1,routerContextName:"$router",routeDirectiveName:"route",routerDirectiveName:"router",routeToDirectiveName:"route-to"},r);let e=!1,n=K(r),i=G(r),o=J(r),s=Q(r),c=()=>{t.addContexts(0,n),t.addDirectives(-1,i,o,s)},a=()=>{t.removeContexts(n),t.removeDirectives(i,o,s)};this.disable=()=>{!t.getEnabled()&&e&&(e=!1,t.removeEventListener("enabling",c),t.removeEventListener("disabling",a))},this.enable=()=>{e||(e=!0,t.addEventListener("enabling",c),t.addEventListener("disabling",a))},this.enable()}window.DoarsRouter=Z;})();
//# sourceMappingURL=doars-router.iife.min.js.map
