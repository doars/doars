(()=>{var I=(t,...r)=>{if(!r.length)return t;let e=r.shift();if($(t)&&$(e))for(let n in e)$(e[n])?(t[n]||Object.assign(t,{[n]:{}}),I(t[n],e[n])):Array.isArray(e[n])?t[n]=e[n].map(i=>$(i)?I({},i):i):Object.assign(t,{[n]:e[n]});return I(t,...r)};var $=t=>t&&typeof t=="object"&&!Array.isArray(t);var te=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],K=(t,r)=>{let e=!1,n={};for(let i of te)n[i]=(...o)=>{if(!e)return i in r?r[i](...o):Reflect[i](...o)};return{proxy:new Proxy(t,n),revoke:()=>{e=!0}}};var E=Symbol("ROUTER");function re(t){for(var r=[],e=0;e<t.length;){var n=t[e];if(n==="*"||n==="+"||n==="?"){r.push({type:"MODIFIER",index:e,value:t[e++]});continue}if(n==="\\"){r.push({type:"ESCAPED_CHAR",index:e++,value:t[e++]});continue}if(n==="{"){r.push({type:"OPEN",index:e,value:t[e++]});continue}if(n==="}"){r.push({type:"CLOSE",index:e,value:t[e++]});continue}if(n===":"){for(var i="",o=e+1;o<t.length;){var a=t.charCodeAt(o);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||a===95){i+=t[o++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(e));r.push({type:"NAME",index:e,value:i}),e=o;continue}if(n==="("){var c=1,f="",o=e+1;if(t[o]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(o));for(;o<t.length;){if(t[o]==="\\"){f+=t[o++]+t[o++];continue}if(t[o]===")"){if(c--,c===0){o++;break}}else if(t[o]==="("&&(c++,t[o+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(o));f+=t[o++]}if(c)throw new TypeError("Unbalanced pattern at ".concat(e));if(!f)throw new TypeError("Missing pattern at ".concat(e));r.push({type:"PATTERN",index:e,value:f}),e=o;continue}r.push({type:"CHAR",index:e,value:t[e++]})}return r.push({type:"END",index:e,value:""}),r}function ne(t,r){r===void 0&&(r={});for(var e=re(t),n=r.prefixes,i=n===void 0?"./":n,o=r.delimiter,a=o===void 0?"/#?":o,c=[],f=0,l=0,u="",s=function(h){if(l<e.length&&e[l].type===h)return e[l++].value},x=function(h){var m=s(h);if(m!==void 0)return m;var y=e[l],F=y.type,ee=y.index;throw new TypeError("Unexpected ".concat(F," at ").concat(ee,", expected ").concat(h))},R=function(){for(var h="",m;m=s("CHAR")||s("ESCAPED_CHAR");)h+=m;return h},H=function(h){for(var m=0,y=a;m<y.length;m++){var F=y[m];if(h.indexOf(F)>-1)return!0}return!1},L=function(h){var m=c[c.length-1],y=h||(m&&typeof m=="string"?m:"");if(m&&!y)throw new TypeError('Must have text between two parameters, missing text after "'.concat(m.name,'"'));return!y||H(y)?"[^".concat(A(a),"]+?"):"(?:(?!".concat(A(y),")[^").concat(A(a),"])+?")};l<e.length;){var T=s("CHAR"),v=s("NAME"),N=s("PATTERN");if(v||N){var g=T||"";i.indexOf(g)===-1&&(u+=g,g=""),u&&(c.push(u),u=""),c.push({name:v||f++,prefix:g,suffix:"",pattern:N||L(g),modifier:s("MODIFIER")||""});continue}var p=T||s("ESCAPED_CHAR");if(p){u+=p;continue}u&&(c.push(u),u="");var O=s("OPEN");if(O){var g=R(),b=s("NAME")||"",S=s("PATTERN")||"",C=R();x("CLOSE"),c.push({name:b||(S?f++:""),pattern:b&&!S?L(g):S,prefix:g,suffix:C,modifier:s("MODIFIER")||""});continue}x("END")}return c}function A(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function X(t){return t&&t.sensitive?"":"i"}function ie(t,r){if(!r)return t;for(var e=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,i=e.exec(t.source);i;)r.push({name:i[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),i=e.exec(t.source);return t}function oe(t,r,e){var n=t.map(function(i){return z(i,r,e).source});return new RegExp("(?:".concat(n.join("|"),")"),X(e))}function se(t,r,e){return ae(ne(t,e),r,e)}function ae(t,r,e){e===void 0&&(e={});for(var n=e.strict,i=n===void 0?!1:n,o=e.start,a=o===void 0?!0:o,c=e.end,f=c===void 0?!0:c,l=e.encode,u=l===void 0?function(m){return m}:l,s=e.delimiter,x=s===void 0?"/#?":s,R=e.endsWith,H=R===void 0?"":R,L="[".concat(A(H),"]|$"),T="[".concat(A(x),"]"),v=a?"^":"",N=0,g=t;N<g.length;N++){var p=g[N];if(typeof p=="string")v+=A(u(p));else{var O=A(u(p.prefix)),b=A(u(p.suffix));if(p.pattern)if(r&&r.push(p),O||b)if(p.modifier==="+"||p.modifier==="*"){var S=p.modifier==="*"?"?":"";v+="(?:".concat(O,"((?:").concat(p.pattern,")(?:").concat(b).concat(O,"(?:").concat(p.pattern,"))*)").concat(b,")").concat(S)}else v+="(?:".concat(O,"(").concat(p.pattern,")").concat(b,")").concat(p.modifier);else{if(p.modifier==="+"||p.modifier==="*")throw new TypeError('Can not repeat "'.concat(p.name,'" without a prefix and suffix'));v+="(".concat(p.pattern,")").concat(p.modifier)}else v+="(?:".concat(O).concat(b,")").concat(p.modifier)}}if(f)i||(v+="".concat(T,"?")),v+=e.endsWith?"(?=".concat(L,")"):"$";else{var C=t[t.length-1],h=typeof C=="string"?T.indexOf(C[C.length-1])>-1:C===void 0;i||(v+="(?:".concat(T,"(?=").concat(L,"))?")),h||(v+="(?=".concat(T,"|").concat(L,")"))}return new RegExp(v,X(e))}function z(t,r,e){return t instanceof RegExp?ie(t,r):Array.isArray(t)?oe(t,r,e):se(t,r,e)}var j=class{constructor(){let r={};this.addEventListener=(e,n,i=null)=>{e in r||(r[e]=[]),r[e].push({callback:n,options:i})},this.removeEventListener=(e,n)=>{if(!Object.keys(r).includes(e))return;let i=r[e],o=-1;for(let a=0;a<i.length;a++)if(i[a].callback===n){o=a;break}o<0||(i.splice(o,1),Object.keys(i).length===0&&delete r[e])},this.removeEventListeners=e=>{e&&delete r[e]},this.removeAllEventListeners=()=>{r={}},this.dispatchEvent=(e,n,i=null)=>{if(!r[e])return;let o=r[e];for(let a=0;a<o.length;a++){let c=i&&i.reverse?o[o.length-(a+1)]:o[a];c.options&&c.options.once&&o.splice(a,1),c.callback(...n)}}}};var U=class extends j{constructor(r={}){super();let e=Symbol("ID_ROUTER");r=Object.assign({basePath:"",path:null,pathToRegexp:{},updateHistory:!1},r);let n=r.path,i=null,o={},a=()=>{this.setPath(window.location.pathname)};r.updateHistory&&window.addEventListener("popstate",a);let c=(f,l,u)=>{if(n=l,i=u,r.updateHistory){let s=f.includes(r.basePath)?f:r.basePath+f;s!==window.location.pathname&&window.history.pushState(null,window.document.title,s)}this.dispatchEvent("changed",[this,i,n])};this.getId=()=>e,this.getPath=()=>n,this.getRoute=()=>i,this.getRoutes=()=>Object.keys(o),this.destroy=()=>{r.updateHistory&&window.removeEventListener("popstate",a),r=null,n=null,i=null,o=null,this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.addRoute=f=>{if(o[f]=z(f,[],r.pathToRegexp),this.dispatchEvent("added",[this,f]),n){let l=n.replace(r.basePath,"");o[f].test(l)&&c(n,l,f)}},this.removeRoute=f=>{delete o[f],this.dispatchEvent("removed",[this,f]),i===f&&(n=null,i=null,this.dispatchEvent("changed",[this,i,n]))},this.setPath=f=>{let l=f.replace(r.basePath,"");if(n===l)return;let u=null;for(let s in o)if(o[s].test(l)){u=s;break}c(f,l,u)}}};var Y=t=>{if(t.parentElement)return t=t.parentElement,t[E]?t[E]:Y(t)},D=Y;var B=({routerContextName:t})=>({name:t,create:(r,e)=>{let n=e.getElement(),i=null,o=K({},{get:(a,c,f)=>{if(i===null&&(n[E]?i=n[E]:i=D(n),i||(i=!1)),e.accessed(i.getId(),""),!!i)return Reflect.get(i,c,f)}});return{value:o.proxy,destroy:()=>{o.revoke()}}}});var M=t=>{if(typeof t=="string"&&(t=t.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(t))return;let r={};for(let e of t)switch(e=e.trim(),e[0]){case"#":r.id=e.substring(1);break;case".":e=e.substring(1),r.class||(r.class=[]),r.class.includes(e)||r.class.push(e);break;case"[":let[n,i,o]=e.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);r[i]=o;break}return r};var _=(t,r)=>{for(let e in r){if(e==="class"){for(let n of r.class)t.classList.add(n);continue}t.setAttribute(e,r[e])}};var P=(t,r)=>{for(let e in r){if(e==="class"){for(let n of r.class)t.classList.remove(n);continue}r[e]&&t.attributes[e]!==r[e]||t.removeAttribute(e)}};var ce="-transition:",G=(t,r,e,n=null)=>{if(e.nodeType!==1){n&&n();return}let i=r.prefix+ce+t,o=x=>{e.dispatchEvent(new CustomEvent("transition-"+x)),e.dispatchEvent(new CustomEvent("transition-"+t+"-"+x))},a,c,f,l,u=!1,s={};return a=i,c=e.getAttribute(a),c&&(s.during=M(c),_(e,s.during)),a=i+".from",c=e.getAttribute(a),c&&(s.from=M(c),_(e,s.from)),o("start"),l=requestAnimationFrame(()=>{if(l=null,u)return;if(s.from&&(P(e,s.from),s.from=void 0),a=i+".to",c=e.getAttribute(a),c)s.to=M(c),_(e,s.to);else if(!s.during){o("end"),n&&n(),u=!0;return}let x=getComputedStyle(e),R=Number(x.transitionDuration.replace(/,.*/,"").replace("s",""))*1e3;R===0&&(R=Number(x.animationDuration.replace("s",""))*1e3),f=setTimeout(()=>{f=null,!u&&(s.during&&(P(e,s.during),s.during=void 0),s.to&&(P(e,s.to),s.to=void 0),o("end"),n&&n(),u=!0)},R)}),()=>{u&&(u=!0,s.during&&(P(e,s.during),s.during=void 0),s.from?(P(e,s.from),s.from=void 0):s.to&&(P(e,s.to),s.to=void 0),l?(cancelAnimationFrame(l),l=null):f&&(clearTimeout(f),f=null),o("end"),n&&n())}},W=(t,r,e)=>G("in",t,r,e),V=(t,r,e)=>G("out",t,r,e);var d=Symbol("ROUTE"),J=({routeDirectiveName:t})=>({name:t,update:(r,e)=>{let n=r.getLibrary().getOptions(),i=e.getElement(),o,a=()=>{if(o&&e[d]&&(o.removeEventListener("changed",e[d].handler),o.removeEventListener("destroyed",e[d].setup),delete e[d]),o=D(i),!o)return;e[d]={setup:a};let c=e.getValue();o.addRoute(c);let f=(l,u)=>{if(u!==c)if(i.tagName==="TEMPLATE"){if(e[d]&&e[d].element){let s=e[d].element;V(n,s,()=>{s.remove(),e[d].element=void 0})}}else V(n,i,()=>{i.style.display="none"});else if(i.tagName==="TEMPLATE"){let s=document.importNode(i.content,!0).firstElementChild;i.insertAdjacentElement("afterend",s),e[d].element=i,W(n,e[d].element)}else i.style.display=null,W(n,i)};e[d].handler=f,o.addEventListener("changed",f),f(o,o.getRoute()),o.addEventListener("destroyed",a)};a()},destroy:(r,e,{transitionOut:n})=>{let i=r.getLibrary().getOptions(),o=e.getElement();if(o.tagName==="TEMPLATE"){if(e[d]&&e[d].element){let c=e[d].element;n(i,c,()=>{c.remove(),e[d].element=void 0})}}else n(i,o,()=>{o.style.display="none"});let a=D(o);a&&e[d]&&(a.removeEventListener("destroyed",e[d].setup),e[d].handler&&a.removeEventListener("change",e[d].handler))}});var Q=t=>({name:t.routerDirectiveName,update:(r,e,n)=>{let i=e.getElement(),o=i[E];o||(o=i[E]=new U(Object.assign({},t,n(r,e,e.getValue()))))},destroy:(r,e)=>{let n=e.getElement(),i=n[E];if(!i)return;delete n[E];let o=i.getId();i.destroy(),r.getLibrary().update([{id:o,path:""}])}});var w=Symbol("ROUTE_TO"),q="click",Z=({routeToDirectiveName:t})=>({name:t,update:(r,e)=>{let n=e.getElement(),i=e.getModifiers(),o=e.getValue();if(e[w]){if(e[w].value===o)return;e[w].target.removeEventListener(q,e[w].handler)}let a=c=>{if(i.self&&c.target!==n)return;i.prevent&&c.preventDefault(),i.stop&&c.stopPropagation();let f=D(n);f&&f.setPath(o)};n.addEventListener(q,a),e[w]={handler:a,value:o}},destroy:(r,e)=>{if(!e[w])return;e.getElement().removeEventListener(q,e[w].handler),delete e[w]}});function k(t,r=null){r=I({basePath:"",path:"",pathToRegexp:{},updateHistory:!1,routerContextName:"$router",routeDirectiveName:"route",routerDirectiveName:"router",routeToDirectiveName:"route-to"},r);let e=!1,n=B(r),i=J(r),o=Q(r),a=Z(r),c=()=>{t.addContexts(0,n),t.addDirectives(-1,i,o,a)},f=()=>{t.removeContexts(n),t.removeDirectives(i,o,a)};this.disable=()=>{!t.getEnabled()&&e&&(e=!1,t.removeEventListener("enabling",c),t.removeEventListener("disabling",f))},this.enable=()=>{e||(e=!0,t.addEventListener("enabling",c),t.addEventListener("disabling",f))},this.enable()}window.DoarsRouter=k;})();
//# sourceMappingURL=doars-router.iife.min.js.map
