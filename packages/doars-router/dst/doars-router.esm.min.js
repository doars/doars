function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],s=Symbol(),p=Symbol(),d=Symbol(),v=function e(t){if(t.parentElement)return(t=t.parentElement)[p]?t[p]:e(t)},y={name:"$router",create:function(e,t){var n=t.getElement(),r=null,o=function(e,t){var n,r=!1,o={},i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(l);try{var a=function(){var e=n.value;o[e]=function(){if(!r)return e in t?t[e].apply(t,arguments):Reflect[e].apply(Reflect,arguments);console.error("illegal operation attempted on a revoked proxy")}};for(i.s();!(n=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}return{proxy:new Proxy({},o),revoke:function(){r=!0}}}(0,{get:function(e,o,i){if(null===r&&((r=n[p]?n[p]:v(n))||(r=!1)),t.accessed(r.getId(),""),r)return Reflect.get(r,o,i)}});return{value:o.proxy,destroy:function(){o.revoke()}}}};function h(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function m(e){return e&&e.sensitive?"":"i"}function g(e,t,n){return e instanceof RegExp?function(e,t){if(!t)return e;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,r=0,o=n.exec(e.source);o;)t.push({name:o[1]||r++,prefix:"",suffix:"",modifier:"",pattern:""}),o=n.exec(e.source);return e}(e,t):Array.isArray(e)?function(e,t,n){var r=e.map((function(e){return g(e,t,n).source}));return new RegExp("(?:".concat(r.join("|"),")"),m(n))}(e,t,n):function(e,t,n){return function(e,t,n){void 0===n&&(n={});for(var r=n.strict,o=void 0!==r&&r,i=n.start,a=void 0===i||i,c=n.end,u=void 0===c||c,f=n.encode,l=void 0===f?function(e){return e}:f,s=n.delimiter,p=void 0===s?"/#?":s,d=n.endsWith,v="[".concat(h(void 0===d?"":d),"]|$"),y="[".concat(h(p),"]"),g=a?"^":"",E=0,b=e;E<b.length;E++){var w=b[E];if("string"==typeof w)g+=h(l(w));else{var x=h(l(w.prefix)),O=h(l(w.suffix));if(w.pattern)if(t&&t.push(w),x||O)if("+"===w.modifier||"*"===w.modifier){var A="*"===w.modifier?"?":"";g+="(?:".concat(x,"((?:").concat(w.pattern,")(?:").concat(O).concat(x,"(?:").concat(w.pattern,"))*)").concat(O,")").concat(A)}else g+="(?:".concat(x,"(").concat(w.pattern,")").concat(O,")").concat(w.modifier);else"+"===w.modifier||"*"===w.modifier?g+="((?:".concat(w.pattern,")").concat(w.modifier,")"):g+="(".concat(w.pattern,")").concat(w.modifier);else g+="(?:".concat(x).concat(O,")").concat(w.modifier)}}if(u)o||(g+="".concat(y,"?")),g+=n.endsWith?"(?=".concat(v,")"):"$";else{var P=e[e.length-1],R="string"==typeof P?y.indexOf(P[P.length-1])>-1:void 0===P;o||(g+="(?:".concat(y,"(?=").concat(v,"))?")),R||(g+="(?=".concat(y,"|").concat(v,")"))}return new RegExp(g,m(n))}(function(e,t){void 0===t&&(t={});for(var n=function(e){for(var t=[],n=0;n<e.length;){var r=e[n];if("*"!==r&&"+"!==r&&"?"!==r)if("\\"!==r)if("{"!==r)if("}"!==r)if(":"!==r)if("("!==r)t.push({type:"CHAR",index:n,value:e[n++]});else{var o=1,i="";if("?"===e[c=n+1])throw new TypeError('Pattern cannot start with "?" at '.concat(c));for(;c<e.length;)if("\\"!==e[c]){if(")"===e[c]){if(0==--o){c++;break}}else if("("===e[c]&&(o++,"?"!==e[c+1]))throw new TypeError("Capturing groups are not allowed at ".concat(c));i+=e[c++]}else i+=e[c++]+e[c++];if(o)throw new TypeError("Unbalanced pattern at ".concat(n));if(!i)throw new TypeError("Missing pattern at ".concat(n));t.push({type:"PATTERN",index:n,value:i}),n=c}else{for(var a="",c=n+1;c<e.length;){var u=e.charCodeAt(c);if(!(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||95===u))break;a+=e[c++]}if(!a)throw new TypeError("Missing parameter name at ".concat(n));t.push({type:"NAME",index:n,value:a}),n=c}else t.push({type:"CLOSE",index:n,value:e[n++]});else t.push({type:"OPEN",index:n,value:e[n++]});else t.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});else t.push({type:"MODIFIER",index:n,value:e[n++]})}return t.push({type:"END",index:n,value:""}),t}(e),r=t.prefixes,o=void 0===r?"./":r,i="[^".concat(h(t.delimiter||"/#?"),"]+?"),a=[],c=0,u=0,f="",l=function(e){if(u<n.length&&n[u].type===e)return n[u++].value},s=function(e){var t=l(e);if(void 0!==t)return t;var r=n[u],o=r.type,i=r.index;throw new TypeError("Unexpected ".concat(o," at ").concat(i,", expected ").concat(e))},p=function(){for(var e,t="";e=l("CHAR")||l("ESCAPED_CHAR");)t+=e;return t};u<n.length;){var d=l("CHAR"),v=l("NAME"),y=l("PATTERN");if(v||y){var m=d||"";-1===o.indexOf(m)&&(f+=m,m=""),f&&(a.push(f),f=""),a.push({name:v||c++,prefix:m,suffix:"",pattern:y||i,modifier:l("MODIFIER")||""})}else{var g=d||l("ESCAPED_CHAR");if(g)f+=g;else if(f&&(a.push(f),f=""),l("OPEN")){m=p();var E=l("NAME")||"",b=l("PATTERN")||"",w=p();s("CLOSE"),a.push({name:E||(b?c++:""),pattern:E&&!b?i:b,prefix:m,suffix:w,modifier:l("MODIFIER")||""})}else s("END")}}return a}(e,n),t,n)}(e,t,n)}var E=n((function t(){e(this,t);var n={};this.addEventListener=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e in n||(n[e]=[]),n[e].push({callback:t,options:r})},this.removeEventListener=function(e,t){if(Object.keys(n).includes(e)){for(var r=n[e],o=-1,i=0;i<r.length;i++)if(r[i].callback===t){o=i;break}o<0||(r.splice(o,1),0===Object.keys(r).length&&delete n[e])}},this.removeEventListeners=function(e){e&&delete n[e]},this.removeAllEventListeners=function(){n={}},this.dispatchEvent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n[e])for(var o=n[e],i=0;i<o.length;i++){var a=r&&r.reverse?o[o.length-(i+1)]:o[i];a.options&&a.options.once&&o.splice(i,1),a.callback.apply(a,c(t))}}})),b=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(l,E);var c,u,f=(c=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=r(c);if(u){var n=r(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function l(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,l),t=f.call(this);var r=Symbol(),o=(n=Object.assign({basePath:"",path:null,pathToRegexp:{},updateHistory:!1},n)).path,a=null,c={},u=function(){t.setPath(window.location.pathname)};n.updateHistory&&window.addEventListener("popstate",u);var s=function(e,r,c){if(o=r,a=c,n.updateHistory){var u=e.includes(n.basePath)?e:n.basePath+e;u!==window.location.pathname&&window.history.pushState(null,window.document.title,u)}t.dispatchEvent("changed",[i(t),a,o])};return t.getId=function(){return r},t.getPath=function(){return o},t.getRoute=function(){return a},t.getRoutes=function(){return Object.keys(c)},t.destroy=function(){n.updateHistory&&window.removeEventListener("popstate",u),n=null,o=null,a=null,c=null,t.dispatchEvent("destroyed",[i(t)]),t.removeAllEventListeners()},t.addRoute=function(e){if(c[e]=g(e,[],n.pathToRegexp),t.dispatchEvent("added",[i(t),e]),o){var r=o.replace(n.basePath,"");c[e].test(r)&&s(o,r,e)}},t.removeRoute=function(e){delete c[e],t.dispatchEvent("removed",[i(t),e]),a===e&&(o=null,a=null,t.dispatchEvent("changed",[i(t),a,o]))},t.setPath=function(e){var t=e.replace(n.basePath,"");if(o!==t){var r=null;for(var i in c)if(c[i].test(t)){r=i;break}s(e,t,r)}},t}return n(l)}(),w=function(e){return{name:"router",update:function(t,n,r){var o=r.processExpression,i=n.getElement(),a=i[p];if(!a){var c=Object.assign({},e,o(t,n.clone(),n.getValue()));a=i[p]=new b(c)}},destroy:function(e,t){var n=t.getElement(),r=n[p];if(r){delete n[p];var o=r.getId();r.destroy(),e.getLibrary().update([{id:o,path:""}])}}}},x={name:"route",update:function(e,t,n){var r,o=n.transitionIn,i=n.transitionOut,a=t.getElement();!function n(){if(r&&t[d]&&(r.removeEventListener("changed",t[d].handler),r.removeEventListener("destroyed",t[d].setup),delete t[d]),r=v(a)){t[d]={setup:n};var c=t.getValue();r.addRoute(c);var u=function(n,r){if(r!==c)if("TEMPLATE"===a.tagName){if(t[d]&&t[d].element){var u=t[d].element;i(e,u,(function(){u.remove(),t[d].element=void 0}))}}else i(e,a,(function(){a.style.display="none"}));else"TEMPLATE"===a.tagName?(l=document.importNode(a.content,!0),(f=a).nextSibling?f.parentNode.insertBefore(l,f.nextSibling):f.parentNode.appendChild(l),t[d].element=a.nextSibling,o(e,t[d].element)):(a.style.display=null,o(e,a));var f,l};t[d].handler=u,r.addEventListener("changed",u),u(0,r.getRoute()),r.addEventListener("destroyed",n)}}()},destroy:function(e,t,n){var r=n.transitionOut,o=t.getElement();if("TEMPLATE"===o.tagName){if(t[d]&&t[d].element){var i=t[d].element;r(e,i,(function(){i.remove(),t[d].element=void 0}))}}else r(e,o,(function(){o.style.display="none"}));var a=v(o);a&&t[d]&&(a.removeEventListener("destroyed",t[d].setup),t[d].handler&&a.removeEventListener("change",t[d].handler))}},O={name:"route-to",update:function(e,t){var n=t.getElement(),r=t.getModifiers(),o=t.getValue();if(t[s]){if(t[s].value===o)return;t[s].target.removeEventListener("click",t[s].handler)}var i=function(e){if(!r.self||e.target===n){r.prevent&&e.preventDefault(),r.stop&&e.stopPropagation();var t=v(n);t&&t.setPath(o)}};n.addEventListener("click",i),t[s]={handler:i,value:o}},destroy:function(e,t){t[s]&&(t.getElement().removeEventListener("click",t[s].handler),delete t[s])}},A=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(!r.length)return t;var i=r.shift();if(P(t)&&P(i))for(var a in i)P(i[a])?(t[a]||Object.assign(t,{[a]:{}}),e(t[a],i[a])):Array.isArray(i[a])?t[a]=i[a].map((function(t){return P(t)?e({},t):t})):Object.assign(t,{[a]:i[a]});return e.apply(void 0,[t].concat(r))},P=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},R=n((function t(n){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e(this,t),o=A({},o),n.addEventListener("enabling",(function(){n.addContexts(0,y),r=w(o),n.addDirectives(-1,r,x,O)})),n.addEventListener("disabling",(function(){n.removeContexts(y),n.removeDirectives(r,x,O),r=null}))}));export{R as default};
