var z=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],$=(r,e)=>{let t=!1,n={};for(let i of z)n[i]=(...o)=>{if(!t)return i in e?e[i](...o):Reflect[i](...o)};return{proxy:new Proxy(r,n),revoke:()=>{t=!0}}};var g=Symbol("ROUTE_TO"),E=Symbol("ROUTER"),d=Symbol("ROUTE");var V=r=>{if(r.parentElement)return r=r.parentElement,r[E]?r[E]:V(r)},w=V;var I={name:"$router",create:(r,e)=>{let t=e.getElement(),n=null,i=$({},{get:(o,a,s)=>{if(n===null&&(t[E]?n=t[E]:n=w(t),n||(n=!1)),e.accessed(n.getId(),""),!!n)return Reflect.get(n,a,s)}});return{value:i.proxy,destroy:()=>{i.revoke()}}}};function G(r){for(var e=[],t=0;t<r.length;){var n=r[t];if(n==="*"||n==="+"||n==="?"){e.push({type:"MODIFIER",index:t,value:r[t++]});continue}if(n==="\\"){e.push({type:"ESCAPED_CHAR",index:t++,value:r[t++]});continue}if(n==="{"){e.push({type:"OPEN",index:t,value:r[t++]});continue}if(n==="}"){e.push({type:"CLOSE",index:t,value:r[t++]});continue}if(n===":"){for(var i="",o=t+1;o<r.length;){var a=r.charCodeAt(o);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||a===95){i+=r[o++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(t));e.push({type:"NAME",index:t,value:i}),t=o;continue}if(n==="("){var s=1,c="",o=t+1;if(r[o]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(o));for(;o<r.length;){if(r[o]==="\\"){c+=r[o++]+r[o++];continue}if(r[o]===")"){if(s--,s===0){o++;break}}else if(r[o]==="("&&(s++,r[o+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(o));c+=r[o++]}if(s)throw new TypeError("Unbalanced pattern at ".concat(t));if(!c)throw new TypeError("Missing pattern at ".concat(t));e.push({type:"PATTERN",index:t,value:c}),t=o;continue}e.push({type:"CHAR",index:t,value:r[t++]})}return e.push({type:"END",index:t,value:""}),e}function J(r,e){e===void 0&&(e={});for(var t=G(r),n=e.prefixes,i=n===void 0?"./":n,o="[^".concat(O(e.delimiter||"/#?"),"]+?"),a=[],s=0,c=0,u="",f=function(v){if(c<t.length&&t[c].type===v)return t[c++].value},p=function(v){var y=f(v);if(y!==void 0)return y;var R=t[c],U=R.type,b=R.index;throw new TypeError("Unexpected ".concat(U," at ").concat(b,", expected ").concat(v))},S=function(){for(var v="",y;y=f("CHAR")||f("ESCAPED_CHAR");)v+=y;return v};c<t.length;){var A=f("CHAR"),H=f("NAME"),T=f("PATTERN");if(H||T){var h=A||"";i.indexOf(h)===-1&&(u+=h,h=""),u&&(a.push(u),u=""),a.push({name:H||s++,prefix:h,suffix:"",pattern:T||o,modifier:f("MODIFIER")||""});continue}var m=A||f("ESCAPED_CHAR");if(m){u+=m;continue}u&&(a.push(u),u="");var L=f("OPEN");if(L){var h=S(),P=f("NAME")||"",l=f("PATTERN")||"",x=S();p("CLOSE"),a.push({name:P||(l?s++:""),pattern:P&&!l?o:l,prefix:h,suffix:x,modifier:f("MODIFIER")||""});continue}p("END")}return a}function O(r){return r.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function K(r){return r&&r.sensitive?"":"i"}function Q(r,e){if(!e)return r;for(var t=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,i=t.exec(r.source);i;)e.push({name:i[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),i=t.exec(r.source);return r}function X(r,e,t){var n=r.map(function(i){return _(i,e,t).source});return new RegExp("(?:".concat(n.join("|"),")"),K(t))}function Y(r,e,t){return Z(J(r,t),e,t)}function Z(r,e,t){t===void 0&&(t={});for(var n=t.strict,i=n===void 0?!1:n,o=t.start,a=o===void 0?!0:o,s=t.end,c=s===void 0?!0:s,u=t.encode,f=u===void 0?function(b){return b}:u,p=t.delimiter,S=p===void 0?"/#?":p,A=t.endsWith,H=A===void 0?"":A,T="[".concat(O(H),"]|$"),h="[".concat(O(S),"]"),m=a?"^":"",L=0,P=r;L<P.length;L++){var l=P[L];if(typeof l=="string")m+=O(f(l));else{var x=O(f(l.prefix)),v=O(f(l.suffix));if(l.pattern)if(e&&e.push(l),x||v)if(l.modifier==="+"||l.modifier==="*"){var y=l.modifier==="*"?"?":"";m+="(?:".concat(x,"((?:").concat(l.pattern,")(?:").concat(v).concat(x,"(?:").concat(l.pattern,"))*)").concat(v,")").concat(y)}else m+="(?:".concat(x,"(").concat(l.pattern,")").concat(v,")").concat(l.modifier);else l.modifier==="+"||l.modifier==="*"?m+="((?:".concat(l.pattern,")").concat(l.modifier,")"):m+="(".concat(l.pattern,")").concat(l.modifier);else m+="(?:".concat(x).concat(v,")").concat(l.modifier)}}if(c)i||(m+="".concat(h,"?")),m+=t.endsWith?"(?=".concat(T,")"):"$";else{var R=r[r.length-1],U=typeof R=="string"?h.indexOf(R[R.length-1])>-1:R===void 0;i||(m+="(?:".concat(h,"(?=").concat(T,"))?")),U||(m+="(?=".concat(h,"|").concat(T,")"))}return new RegExp(m,K(t))}function _(r,e,t){return r instanceof RegExp?Q(r,e):Array.isArray(r)?X(r,e,t):Y(r,e,t)}var C=class{constructor(){let e={};this.addEventListener=(t,n,i=null)=>{t in e||(e[t]=[]),e[t].push({callback:n,options:i})},this.removeEventListener=(t,n)=>{if(!Object.keys(e).includes(t))return;let i=e[t],o=-1;for(let a=0;a<i.length;a++)if(i[a].callback===n){o=a;break}o<0||(i.splice(o,1),Object.keys(i).length===0&&delete e[t])},this.removeEventListeners=t=>{t&&delete e[t]},this.removeAllEventListeners=()=>{e={}},this.dispatchEvent=(t,n,i=null)=>{if(!e[t])return;let o=e[t];for(let a=0;a<o.length;a++){let s=i&&i.reverse?o[o.length-(a+1)]:o[a];s.options&&s.options.once&&o.splice(a,1),s.callback(...n)}}}};var D=class extends C{constructor(e={}){super();let t=Symbol("ID_ROUTER");e=Object.assign({basePath:"",path:null,pathToRegexp:{},updateHistory:!1},e);let n=e.path,i=null,o={},a=()=>{this.setPath(window.location.pathname)};e.updateHistory&&window.addEventListener("popstate",a);let s=(c,u,f)=>{if(n=u,i=f,e.updateHistory){let p=c.includes(e.basePath)?c:e.basePath+c;p!==window.location.pathname&&window.history.pushState(null,window.document.title,p)}this.dispatchEvent("changed",[this,i,n])};this.getId=()=>t,this.getPath=()=>n,this.getRoute=()=>i,this.getRoutes=()=>Object.keys(o),this.destroy=()=>{e.updateHistory&&window.removeEventListener("popstate",a),e=null,n=null,i=null,o=null,this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.addRoute=c=>{if(o[c]=_(c,[],e.pathToRegexp),this.dispatchEvent("added",[this,c]),n){let u=n.replace(e.basePath,"");o[c].test(u)&&s(n,u,c)}},this.removeRoute=c=>{delete o[c],this.dispatchEvent("removed",[this,c]),i===c&&(n=null,i=null,this.dispatchEvent("changed",[this,i,n]))},this.setPath=c=>{let u=c.replace(e.basePath,"");if(n===u)return;let f=null;for(let p in o)if(o[p].test(u)){f=p;break}s(c,u,f)}}};var B=r=>({name:"router",update:(e,t,{processExpression:n})=>{let i=t.getElement(),o=i[E];if(!o){let a=Object.assign({},r,n(e,t.clone(),t.getValue()));o=i[E]=new D(a)}},destroy:(e,t)=>{let n=t.getElement(),i=n[E];if(!i)return;delete n[E];let o=i.getId();i.destroy(),e.getLibrary().update([{id:o,path:""}])}});var q=(r,e)=>{r.nextSibling?r.parentNode.insertBefore(e,r.nextSibling):r.parentNode.appendChild(e)};var j={name:"route",update:(r,e,{transitionIn:t,transitionOut:n})=>{let i=e.getElement(),o,a=()=>{if(o&&e[d]&&(o.removeEventListener("changed",e[d].handler),o.removeEventListener("destroyed",e[d].setup),delete e[d]),o=w(i),!o)return;e[d]={setup:a};let s=e.getValue();o.addRoute(s);let c=(u,f)=>{if(f!==s)if(i.tagName==="TEMPLATE"){if(e[d]&&e[d].element){let p=e[d].element;n(r,p,()=>{p.remove(),e[d].element=void 0})}}else n(r,i,()=>{i.style.display="none"});else if(i.tagName==="TEMPLATE"){let p=document.importNode(i.content,!0);q(i,p),e[d].element=i.nextSibling,t(r,e[d].element)}else i.style.display=null,t(r,i)};e[d].handler=c,o.addEventListener("changed",c),c(o,o.getRoute()),o.addEventListener("destroyed",a)};a()},destroy:(r,e,{transitionOut:t})=>{let n=e.getElement();if(n.tagName==="TEMPLATE"){if(e[d]&&e[d].element){let o=e[d].element;t(r,o,()=>{o.remove(),e[d].element=void 0})}}else t(r,n,()=>{n.style.display="none"});let i=w(n);i&&e[d]&&(i.removeEventListener("destroyed",e[d].setup),e[d].handler&&i.removeEventListener("change",e[d].handler))}};var F="click",W={name:"route-to",update:(r,e)=>{let t=e.getElement(),n=e.getModifiers(),i=e.getValue();if(e[g]){if(e[g].value===i)return;e[g].target.removeEventListener(F,e[g].handler)}let o=a=>{if(n.self&&a.target!==t)return;n.prevent&&a.preventDefault(),n.stop&&a.stopPropagation();let s=w(t);s&&s.setPath(i)};t.addEventListener(F,o),e[g]={handler:o,value:i}},destroy:(r,e)=>{if(!e[g])return;e.getElement().removeEventListener(F,e[g].handler),delete e[g]}};var N=(r,...e)=>{if(!e.length)return r;let t=e.shift();if(M(r)&&M(t))for(let n in t)M(t[n])?(r[n]||Object.assign(r,{[n]:{}}),N(r[n],t[n])):Array.isArray(t[n])?r[n]=t[n].map(i=>M(i)?N({},i):i):Object.assign(r,{[n]:t[n]});return N(r,...e)};var M=r=>r&&typeof r=="object"&&!Array.isArray(r);function De(r,e=null){e=N({},e);let t=!1,n,i=()=>{r.addContexts(0,I),n=B(e),r.addDirectives(-1,n,j,W)},o=()=>{r.removeContexts(I),r.removeDirectives(n,j,W),n=null};this.disable=()=>{!r.getEnabled()&&t&&(t=!1,r.removeEventListener("enabling",i),r.removeEventListener("disabling",o))},this.enable=()=>{t||(t=!0,r.addEventListener("enabling",i),r.addEventListener("disabling",o))},this.enable()}export{De as default};
//# sourceMappingURL=doars-router.min.js.map
