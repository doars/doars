(()=>{var n=Symbol("VIEW");var t={NONE:0,BUFFER:1,DEBOUNCE:2,THROTTLE:3},T=u=>({name:"view",update:(i,e,{processExpression:c})=>{let l=e.getElement(),s=e.getKey(),f=e.getValue();if(e[n]){if(e[n].value===f)return;u.remove(l,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}let o=e.getModifiers(),r=t.NONE;o.buffer?(r=t.BUFFER,o.buffer===!0&&(o.buffer=5)):o.debounce?(r=t.DEBOUNCE,o.debounce===!0&&(o.debounce=500)):o.throttle&&(r=t.THROTTLE,o.throttle===!0&&(o.throttle=500));let h=d=>{if(!(e[n].isIntersecting!==d.isIntersecting))return;if(e[n].isIntersecting=d.isIntersecting,s==="enter"&&!d.isIntersecting||s==="leave"&&d.isIntersecting){e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null);return}let g=()=>{c(i,e.clone(),f,{$event:d},{return:!1}),e[n].buffer=[]};if(e[n].buffer.push(d),r===t.BUFFER){if(e[n].buffer.length<o.buffer)return;g()}else if(r===t.BUFFER)e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null),e[n].timeout=setTimeout(g,o.debounce);else if(r===t.THROTTLE){let O=window.performance.now();if(e[n].lastExecution&&O-e[n].lastExecution<o.throttle)return;g(),e[n].lastExecution=O}else g()};u.add(l,h),e[n]={buffer:[],handler:h,isIntersecting:!1,timeout:e[n]?e[n].timeout:null,value:f}},destroy:(i,e)=>{if(!e[n])return;let c=e.getElement();u.remove(c,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}});var m=class{constructor(i=null){i=Object.assign({root:null,rootMargin:"0px",threshold:0},i);let e=new WeakMap,c=s=>{for(let f of s)for(let o of e.get(f.target))o(f)},l=new IntersectionObserver(c,i);this.add=(s,f)=>{e.has(s)||e.set(s,[]),e.get(s).push(f),l.observe(s)},this.remove=(s,f)=>{if(!e.has(s))return;let o=e.get(s),r=o.indexOf(f);r>=0&&o.splice(r,1),o.length===0&&(e.delete(s),l.unobserve(s))}}};var E=class{constructor(i,e=null){e=Object.assign({},e);let c,l;i.addEventListener("enabling",()=>{let s=Object.assign({},e);s.root||(s.root=i.getOptions().root),l=new m(e),c=T(l),i.addDirectives(-1,c)}),i.addEventListener("disabling",()=>{i.removeDirectives(c),c=null,l=null})}};})();
//# sourceMappingURL=doars-view.iife.min.js.map
