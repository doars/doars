var k=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],x=(r,o)=>{let e=!1,n={};for(let t of k)n[t]=(...s)=>{if(!e)return t in o?o[t](...s):Reflect[t](...s)};return{proxy:new Proxy(r,n),revoke:()=>{e=!0}}};var g=class{constructor(){let o={};this.addEventListener=(e,n,t=null)=>{e in o||(o[e]=[]),o[e].push({callback:n,options:t})},this.removeEventListener=(e,n)=>{if(!Object.keys(o).includes(e))return;let t=o[e],s=-1;for(let l=0;l<t.length;l++)if(t[l].callback===n){s=l;break}s<0||(t.splice(s,1),Object.keys(t).length===0&&delete o[e])},this.removeEventListeners=e=>{e&&delete o[e]},this.removeAllEventListeners=()=>{o={}},this.dispatchEvent=(e,n,t=null)=>{if(!o[e])return;let s=o[e];for(let l=0;l<s.length;l++){let i=t&&t.reverse?s[s.length-(l+1)]:s[l];i.options&&i.options.once&&s.splice(l,1),i.callback(...n)}}}};var f=class extends g{constructor(o={}){super(),o=Object.assign({delete:!0,get:!0,set:!0},o);let e=new WeakMap;this.add=(n,t=[])=>{if(e.has(n))return e.get(n);for(let i in n)n[i]&&typeof n[i]=="object"&&(n[i]=this.add(n[i],[...t,i]));let s={};o.delete&&(s.deleteProperty=(i,c)=>{if(!Reflect.has(i,c))return!0;this.remove(i,c);let a=Reflect.deleteProperty(i,c);return a&&this.dispatchEvent("delete",[i,Array.isArray(i)?[...t]:[...t,c]]),a}),o.get&&(s.get=(i,c,a)=>(c!==Symbol.unscopables&&this.dispatchEvent("get",[i,[...t,c],a]),Reflect.get(i,c,a))),o.set&&(s.set=(i,c,a,d)=>(i[c]===a||(a&&typeof a=="object"&&(a=this.add(a,[...t,c])),i[c]=a,this.dispatchEvent("set",[i,Array.isArray(i)?[...t]:[...t,c],a,d])),!0));let l=x(n,s);return e.set(l,n),l.proxy},this.remove=n=>{if(!e.has(n))return;let t=e.get(n);e.delete(t);for(let s in t.proxy)typeof t.proxy[s]=="object"&&this.remove(t.proxy[s]);t.revoke()}}};var b=(r,o,e,n)=>(t,s,l)=>{let i=(v,p)=>l(o,r+"."+p.join(".")),c=(v,p)=>s.accessed(o,r+"."+p.join(".")),a=(v,p)=>l(o,r+"."+p.join("."));n.addEventListener("delete",i),n.addEventListener("get",c),n.addEventListener("set",a);let d=x(e,{});return{value:d.proxy,destroy:()=>{n.removeEventListener("delete",i),n.removeEventListener("get",c),n.removeEventListener("set",a),d.revoke()}}};var m=(r,o,e,n,t)=>({deconstruct:t,name:r,create:b(r,o,e,n)});var u=null,S=()=>(u===null&&(u=Object.fromEntries(document.cookie.split(/; */).map(r=>{let[o,...e]=r.split("=");return[o,decodeURIComponent(e.join("="))]}))),u),h=(r,o="",e=60)=>{if(r=r.trim(),!o||o==="")document.cookie=r+"=; Expires=Thu, 01 Jan 1970 00:00:01 GMT; Path=/; SameSite=Strict;",u!==null&&delete u[r];else{let n="";if(e){let t=new Date;t.setTime(t.getTime()+e*24*60*60*1e3),n="; expires="+t.toUTCString()}document.cookie=r+"="+encodeURIComponent(o)+n+"; Path=/; SameSite=Strict;",S(),u[r]=o}};var E=({cookiesContextDeconstruct:r,cookiesContextName:o})=>{let e=new f,n=(t,s)=>{s.length>1,h(s[0],t[s[0]])};return e.addEventListener("delete",n),e.addEventListener("set",n),m(o,Symbol("ID_COOKIES"),e.add(S()),e,!!r)};var C=()=>{let r={},o=Object.keys(localStorage);for(let e=o.length-1;e>=0;e--)r[o[e]]=localStorage.getItem(o[e]);return r};var L=({localStorageContextDeconstruct:r,localStorageContextName:o})=>{let e=new f;return e.addEventListener("delete",(n,t)=>{t.length>1,localStorage.removeItem(t[0])}),e.addEventListener("set",(n,t)=>{t.length>1,localStorage.setItem(t[0],n[t[0]])}),m(o,Symbol("ID_LOCAL_STORAGE"),e.add(C()),e,!!r)};var y=()=>{let r={},o=Object.keys(sessionStorage);for(let e=o.length-1;e>=0;e--)r[o[e]]=sessionStorage.getItem(o[e]);return r};var j=({sessionStorageContextDeconstruct:r,sessionStorageContextName:o})=>{let e=new f;return e.addEventListener("delete",(n,t)=>{t.length>1,sessionStorage.removeItem(t[0])}),e.addEventListener("set",(n,t)=>{t.length>1,sessionStorage.setItem(t[0],n[t[0]])}),m(o,Symbol("ID_LOCAL_STORAGE"),e.add(y()),e,!!r)};function ee(r,o=null){o=Object.assign({cookiesContextDeconstruct:!1,cookiesContextName:"$cookies",localStorageContextDeconstruct:!1,localStorageContextName:"$localStorage",sessionStorageContextDeconstruct:!1,sessionStorageContextName:"$sessionStorage"},o);let e=!1,n,t,s,l=()=>{n=E(o),t=L(o),s=j(o);let c=r.getContexts(),a=0;for(let d=c.length-1;d>=0;d--)if(c[d].name==="$state"){a=d;break}r.addContexts(a,n,t,s)},i=()=>{r.removeContexts(n,t,s),n=null,t=null,s=null};this.disable=()=>{!r.getEnabled()&&e&&(e=!1,r.removeEventListener("enabling",l),r.removeEventListener("disabling",i))},this.enable=()=>{e||(e=!0,r.addEventListener("enabling",l),r.addEventListener("disabling",i))},this.enable()}export{ee as default};
//# sourceMappingURL=doars-persist.esm.min.js.map
