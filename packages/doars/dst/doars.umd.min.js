var global,factory;global=this,factory=function(){const e=Symbol(),t=Symbol(),n=Symbol(),r=Symbol(),s=Symbol(),i=Symbol(),o=Symbol(),a=Symbol(),c=Symbol();class l{constructor(){let e={};this.addEventListener=(t,n,r=null)=>{t in e||(e[t]=[]),e[t].push({callback:n,options:r})},this.removeEventListener=(t,n)=>{if(!Object.keys(e).includes(t))return;const r=e[t];let s=-1;for(let e=0;e<r.length;e++)if(r[e].callback===n){s=e;break}s<0||(r.splice(s,1),0===Object.keys(r).length&&delete e[t])},this.removeEventListeners=t=>{t&&delete e[t]},this.removeAllEventListeners=()=>{e={}},this.dispatchEvent=(t,n,r=null)=>{if(!e[t])return;const s=e[t];for(let e=0;e<s.length;e++){const t=r&&r.reverse?s[s.length-(e+1)]:s[e];t.options&&t.options.once&&s.splice(e,1),t.callback(...n)}}}}const u=e=>{if("string"==typeof e&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return;const t={};for(let n of e)switch(n=n.trim(),n[0]){case"#":t.id=n.substring(1);break;case".":n=n.substring(1),t.class||(t.class=[]),t.class.includes(n)||t.class.push(n);break;case"[":const[e,r,s]=n.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);t[r]=s}return t};class d extends l{constructor(t,n,r,s,i=!1){super();const o=Symbol();i||(n[e]||(n[e]=[]),n[e].push(this));let a,c,l,u,f,h={};if(r){const[e,n,s,i]=((e,t)=>{if(!(t=t.match(new RegExp("^"+e+"-([a-z][0-9a-z-]{1,}):?([a-z][0-9a-z-]*)?(\\..*]*)?$","i"))))return;let[n,r,s,i]=t;s=""!==s?s:null;const o=s?s.replace(/-(\w)/g,((e,t)=>t.toUpperCase())):null;return i=i?i.substring(1).split("."):[],[r,s,o,i]})(t.getLibrary().getOptions().prefix,r);a=e,c=s,l=n,u=i,i&&(f=(e=>{const t={};for(const n of e){const e=n.indexOf("-");if(e<0){t[n]=!0;continue}if(0===e){t[n.substring(1)]=!1;continue}const r=n.substring(0,e);let s=n.substring(e+1);const i=Number.parseInt(s);isNaN(i)||(s=i),t[r]=s}return t})(i))}this.getComponent=()=>t,this.getElement=()=>n,this.getId=()=>o,this.getDirective=()=>a,this.getKey=()=>c,this.getKeyRaw=()=>l,this.getModifiers=()=>Object.assign({},f),this.getModifiersRaw=()=>u,this.getName=()=>r,this.getValue=()=>s,this.setValue=e=>{s=e,this.dispatchEvent("changed",[this])},this.destroy=()=>{this.clearAccessed();const t=n[e].indexOf(this);t>=0&&n[e].splice(t,1),this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.accessed=(e,t)=>{if(h[e]){if(h[e].includes(t))return}else h[e]=[];h[e].push(t),this.dispatchEvent("accessed",[this,e,t])},this.clearAccessed=()=>{h={}},this.hasAccessed=(e,t)=>{if(!(e in h))return!1;const n=h[e];for(const e of t)if(n.includes(e))return!0;return!1},this.clone=()=>new d(t,n,r,s,!0)}}const f=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"];function h(e,t){let n=!1;const r={};for(const e of f)r[e]=(...r)=>{if(!n)return e in t?t[e](...r):Reflect[e](...r)};return{proxy:new Proxy(e,r),revoke:()=>{n=!0}}}class p extends l{constructor(e={}){super(),e=Object.assign({delete:!0,get:!0,set:!0},e);const t=new WeakMap;this.add=(n,r=[])=>{if(t.has(n))return t.get(n);for(const e in n)n[e]&&"object"==typeof n[e]&&(n[e]=this.add(n[e],[...r,e]));const s={};e.delete&&(s.deleteProperty=(e,t)=>{if(!Reflect.has(e,t))return!0;this.remove(e,t);const n=Reflect.deleteProperty(e,t);return n&&this.dispatchEvent("delete",[e,Array.isArray(e)?[...r]:[...r,t]]),n}),e.get&&(s.get=(e,t,n)=>(t!==Symbol.unscopables&&this.dispatchEvent("get",[e,[...r,t],n]),Reflect.get(e,t,n))),e.set&&(s.set=(e,t,n,s)=>(e[t]===n||("object"==typeof n&&(n=this.add(n,[...r,t])),e[t]=n,this.dispatchEvent("set",[e,Array.isArray(e)?[...r]:[...r,t],n,s])),!0));const i=h(n,s);return t.set(i,n),i.proxy},this.remove=e=>{if(!t.has(e))return;const n=t.get(e);t.delete(n);for(const e in n.proxy)"object"==typeof n.proxy[e]&&this.remove(n.proxy[e]);n.revoke()}}}const g=(e,t)=>{for(const n in t)if("class"!==n)e.setAttribute(n,t[n]);else for(const n of t.class)e.classList.add(n)},m=(e,t)=>{for(const n in t)if("class"!==n)t[n]&&e.attributes[n]!==t[n]||e.removeAttribute(n);else for(const n of t.class)e.classList.remove(n)},b=(e,t,n)=>{if("value"!==t||"INPUT"!==e.tagName)"checked"!==t||"checkbox"!==e.type&&"radio"!==e.type?("class"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).filter((([e,t])=>t)).map((([e])=>e)).join(" "))),"style"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).map((([e,t])=>e+":"+t)).join(";"))),!1===n||null==n?e.removeAttribute(t):e.setAttribute(t,n)):e.checked=!!n;else{if(n||(n=""),e.getAttribute(t)===n)return;e.setAttribute(t,n)}},v=(e,t)=>{for(const n in t)b(e,n,t[n])},y=(e,t)=>{e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},E=(e,t)=>e.isSameNode?e.isSameNode(t):e.tagName===t.tagName&&3===e.type&&e.nodeValue===t.nodeValue,x=(e,t)=>{let n=-1,r=null;return()=>{if(n>=0&&r){const e=r();if(e)return e}let s=null;do{if(n++,n>=e.childElementCount)return null;s=e.children[n]}while(!t(s));return s.childElementCount&&(r=x(s,t)),s}},A=(e,t)=>{const n=t.nodeType,r=t.nodeName;1===n&&((e,t)=>{const n=e.attributes,r=t.attributes;let s=null,i=null,o=null,a=null,c=null;for(let t=r.length-1;t>=0;--t)c=r[t],a=c.name,s=c.namespaceURI,i=c.value,s?(a=c.localName||a,o=e.getAttributeNS(s,a),o!==i&&e.setAttributeNS(s,a,i)):e.hasAttribute(a)?(o=e.getAttribute(a),o!==i&&("null"===i||"undefined"===i?e.removeAttribute(a):e.setAttribute(a,i))):e.setAttribute(a,i);for(let r=n.length-1;r>=0;--r)c=n[r],!1!==c.specified&&(a=c.name,s=c.namespaceURI,s?(a=c.localName||a,t.hasAttributeNS(s,a)||e.removeAttributeNS(s,a)):t.hasAttributeNS(null,a)||e.removeAttribute(a))})(e,t),3!==n&&8!==n||e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),"INPUT"===r?N(e,t):"OPTION"===r?O(e,t,"selected"):"TEXTAREA"===r&&k(e,t)},N=(e,t)=>{const n=t.value,r=e.value;O(e,t,"checked"),O(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(e.indeterminate=t.indeterminate),"file"!==e.type&&(r!==n&&(e.setAttribute("value",n),e.value=n),"null"===n&&(e.value="",e.removeAttribute("value")),t.hasAttributeNS(null,"value")?"range"===e.type&&(e.value=n):e.removeAttribute("value"))},k=(e,t)=>{const n=t.value;if(e.value!==n&&(e.value=n),e.firstChild&&e.firstChild.nodeValue!==n){if(e.firstChild.nodeValue===e.placeholder&&""===n)return;e.firstChild.nodeValue=n}},O=(e,t,n)=>{e[n]!==t[n]&&(e[n]=t[n],t[n]?e.setAttribute(n,""):e.removeAttribute(n))},L=(e,t)=>e?t?e.isSameNode&&e.isSameNode(t)?e:e.tagName!==t.tagName?t:(A(e,t),w(e,t),e):null:t,w=(e,t)=>{let n,r,s,i,o=0;for(let a=0;n=e.childNodes[a],r=t.childNodes[a-o],n||r;a++)if(r)if(n)if(E(n,r))s=L(n,r),s!==n&&(e.replaceChild(s,n),o++);else{i=null;for(let t=a;t<e.childNodes.length;t++)if(E(e.childNodes[t],r)){i=e.childNodes[t];break}i?(s=L(i,r),s!==i&&o++,e.insertBefore(s,n)):r.id||n.id?(e.insertBefore(r,n),o++):(s=L(n,r),s!==n&&(e.replaceChild(s,n),o++))}else e.appendChild(r),o++;else e.removeChild(n),a--},j=e=>{if(e.parentElement)return(e=e.parentElement)[t]?e[t]:j(e)},C=()=>({createContexts:S,createContextsProxy:T,RevocableProxy:h}),S=(e,t,n,r=null)=>{const s={},i=[];let o="",a="";const c=e.getLibrary().getContexts();for(const r of c){if(!r||!r.name)continue;const c=r.create(e,t,n,C());c&&c.value&&(c.destroy&&"function"==typeof c.destroy&&i.push(c.destroy),r.deconstruct&&"object"==typeof c.value&&(a+="with("+r.name+") { ",o+=" }"),s[r.name]=c.value)}if("object"==typeof r)for(const e in r)s[e]=r[e];return{after:o,before:a,destroy:()=>{for(const e of i)e(C())},contexts:s}},T=(e,t,n,r=null)=>{let s=null;const i=h({},{get:(i,o)=>(s||(s=S(e,t,n,r)),o in s.contexts?(t.accessed(e.getId(),o),s.contexts[o]):s.contexts.$state&&o in s.contexts.$state?(t.accessed(e.getId(),"$state"),s.contexts.$state[o]):void 0)});return{contexts:i.proxy,destroy:()=>{s&&s.destroy&&s.destroy(e,t),i.revoke()}}},$=(e,t,n,r=null,s=null)=>{s=Object.assign({return:!0},s);const i=[];let o,{after:a,before:c,contexts:l,destroy:u}=S(e,t,((e,t)=>{i.push({id:e,path:t})}),r);s.return&&(c+="return ");try{o=new Function(...Object.keys(l),c+n+a)(...Object.values(l))}catch(e){o=null}return u(),i.length>0&&e.getLibrary().update(i),o},P=(e,t,n,r=null)=>{if(1!==n.nodeType)return void(r&&r());const{prefix:s}=t.getLibrary().getOptions(),i=s+"-transition:"+e,o=t=>{n.dispatchEvent(new CustomEvent("transition-"+t)),n.dispatchEvent(new CustomEvent("transition-"+e+"-"+t))};let a,c,l,d,f=!1;const h={};return a=i,c=n.getAttribute(a),c&&(h.during=u(c),g(n,h.during)),a=i+".from",c=n.getAttribute(a),c&&(h.from=u(c),g(n,h.from)),o("start"),d=requestAnimationFrame((()=>{if(d=null,f)return;if(h.from&&(m(n,h.from),h.from=void 0),a=i+".to",c=n.getAttribute(a),c)h.to=u(c),g(n,h.to);else if(!h.during)return o("end"),r&&r(),void(f=!0);const e=getComputedStyle(n);let t=1e3*Number(e.transitionDuration.replace(/,.*/,"").replace("s",""));0===t&&(t=1e3*Number(e.animationDuration.replace("s",""))),l=setTimeout((()=>{l=null,f||(h.during&&(m(n,h.during),h.during=void 0),h.to&&(m(n,h.to),h.to=void 0),o("end"),r&&r(),f=!0)}),t)})),()=>{f&&(f=!0,h.during&&(m(n,h.during),h.during=void 0),h.from?(m(n,h.from),h.from=void 0):h.to&&(m(n,h.to),h.to=void 0),d?(cancelAnimationFrame(d),d=null):l&&(clearTimeout(l),l=null),o("end"),r&&r())}},I=(e,t,n)=>P("in",e,t,n),V=(e,t,n)=>P("out",e,t,n),R=Object.freeze({executeExpression:$,morphNode:A,morphTree:(e,t,n)=>{if("object"!=typeof e)throw new Error("Existing tree should be an object.");if("string"==typeof t)t=(e=>{const t=document.createElement("template");return t.innerHTML=e,t.content.childNodes[0]})(t);else if("object"!=typeof t)throw new Error("New tree should be an object.");return n&&n.childrenOnly||11===t.nodeType?(w(e,t),e):L(e,t)},transition:P,transitionIn:I,transitionOut:V});class D{constructor(e,n){const r=Symbol(),{prefix:s}=e.getOptions();let i,o,a,c=[],l=!1,u=!1;if(!n.attributes[s+"-state"])return;n[t]=this;const f=[];let h=j(n);h&&(h.getChildren().includes(this)||(h.getChildren().push(this),e.update([{id:h.getId(),path:"children"}]))),this.getAttributes=()=>c,this.getChildren=()=>f,this.getElement=()=>n,this.getId=()=>r,this.getLibrary=()=>e,this.getParent=()=>h,this.getProxy=()=>o,this.getState=()=>a,this.setParent=e=>{h=e},this.initialize=()=>{if(u)return;u=!0;const e=s+"-state",t=n.attributes[e].value;i=$(this,new d(this,n,null,t),t)??{},Array.isArray(i)||"object"!=typeof i||(o=new p,a=o.add(i),this.scanAttributes(n))},this.destroy=()=>{if(!u)return;if(c.length>0){const t=e.getDirectivesObject();for(const e in t)t[e].destroy||(t[e]=void 0);for(const e of c){const n=t[e.getKey()];n&&n.destroy(this,e,R),e.destroy()}}delete n[t],c=[],u=!1,o.remove(i),a=null,o=null,i=null;const s=[];if(f.length>0){for(const e of f)e.setParent(h),s.push({id:e.getId(),path:"parent"});s.push({id:r,path:"children"})}h&&(f.length>0&&(h.getChildren().push(...f),s.push({id:h.getId(),path:"children"})),s.push({id:r,path:"parent"})),s.length>0&&e.update(s),g("destroyed",{element:n,id:r})},this.addAttribute=(t,n,r)=>{const s=e.getDirectivesNames(),i=new d(this,t,n,r);let o=i.length;const a=s.indexOf(i.getDirective());for(let e=c.length-1;e>=0;e--)if(s.indexOf(c[e].getDirective())<=a){o=e+1;break}return c.splice(o,0,i),i},this.removeAttribute=t=>{const n=c.indexOf(t);if(n<0)return;const r=e.getDirectivesObject[t.getKey()];r&&r.destroy&&r.destroy(this,t,R),c.splice(n,1),t.destroy()},this.scanAttributes=t=>{const n=s+"-state",r=s+"-ignore",i=[],o=x(t,(e=>!e.hasAttribute(n)&&!e.hasAttribute(r)));do{for(const{name:n,value:r}of t.attributes)e.isDirectiveName(n)&&i.push(this.addAttribute(t,n,r))}while(t=o());return i},this.updateAttribute=t=>{if(!t.getElement()||null===t.getValue()||void 0===t.getValue())return void this.removeAttribute(t);const n=e.getDirectivesObject();t.clearAccessed();const r=n[t.getDirective()];r&&r.update(this,t,R)},this.updateAttributes=e=>{if(!u||e.length<=0)l||(l=!0,g("updated",{attributes:e,element:n,id:r}));else{for(const t of e)this.updateAttribute(t);l=!0,g("updated",{attributes:e,element:n,id:r})}},this.update=e=>{if(!u)return;const t=Object.getOwnPropertySymbols(e),s=[];for(const n of c)for(const r of t)n.hasAccessed(r,e[r])&&(this.updateAttribute(n),s.push(n));(!l||s.length>0)&&(l=!0,g("updated",{attributes:s,element:n,id:r}))};const g=(e,t)=>{n.dispatchEvent(new CustomEvent(s+"-"+e,{detail:t,bubbles:!0}))}}}var z={name:"$children",create:(e,t,n,{createContextsProxy:r,RevocableProxy:s})=>{let i;const o=s(e.getChildren(),{get:(s,o,a)=>{if(i||(i=s.map((e=>r(e,t,n))),t.accessed(e.getId(),"children")),isNaN(o))return Reflect.get(i,o,a);const c=Reflect.get(i,o,a);return c?c.contexts:void 0}});return{value:o.proxy,destroy:()=>{i&&i.forEach((e=>e.destroy())),o.revoke()}}}},M={name:"$component",create:e=>({value:e.getElement()})},_={name:"$element",create:(e,t)=>({value:t.getElement()})},K={name:"$dispatch",create:e=>({value:(t,n={})=>{e.getElement().dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0}))}})},U={deconstruct:!0,name:"$for",create:(e,t,r,{RevocableProxy:s})=>{if(e!==t.getComponent())return;let i=t.getElement();const o=e.getElement(),a=[],c={};for(;i&&!i.isSameNode(o);){const e=i[n];if(e){a.push(e);for(const t in e.variables)c[t]=e.variables[t]}i=i.parentNode}if(0===a.length)return;const l=s(c,{get:(e,n)=>{for(const e of a)if(n in e.variables)return t.accessed(e.id,"$for"),e.variables[n]}});return{value:l.proxy,destroy:()=>{l.revoke()}}}},q={name:"$inContext",create:(e,t,n,{createContexts:r})=>({value:n=>{const s=[],{contexts:i,destroy:o}=r(e,t,((e,t)=>{s.push({id:e,path:t})}),{}),a=n(i);return o(),s.length>0&&e.getLibrary().update(s),a}})},W={name:"$nextTick",create:(e,t,n,{createContexts:r})=>{let s,i=!1;return{value:o=>{(()=>{if(i)return;i=!0;const o=e.getLibrary();s=[];const a=()=>{c();const{contexts:i,destroy:o}=r(e,t,n,{});for(const e of s)e(i);o()},c=()=>{o.removeEventListener("updated",a),t.removeEventListener("changed",c),t.removeEventListener("destroyed",c)};o.addEventListener("updated",a),t.addEventListener("changed",c),t.addEventListener("destroyed",c)})(),s.push(o)}}}},F={name:"$parent",create:(e,t,n,{createContextsProxy:r})=>{const s=e.getParent();if(!s)return{key:"$parent",value:null};const{contexts:i,destroy:o}=r(s,t,n);return{value:i,destroy:o}}},H={name:"$references",create:(e,t,n,{RevocableProxy:r})=>{if(!e[o])return{key:"$references",value:[]};let s=e[a];if(!s){const t=e[o],n=Object.getOwnPropertySymbols(t);s={};for(const e of n){const{element:n,name:r}=t[e];s[r]=n}e[a]=s}const i=r(s,{get:(n,r,s)=>(t.accessed(e.getId(),"$references."+r),Reflect.get(n,r,s))});return{value:i.proxy,destroy:()=>{i.revoke()}}}},X={deconstruct:!0,name:"$state",create:(e,t,n,{RevocableProxy:r})=>{const s=e.getProxy(),i=e.getState();if(!s||!i)return;const o=(t,r)=>n(e.getId(),"$state."+r.join(".")),a=(n,r)=>t.accessed(e.getId(),"$state."+r.join(".")),c=(t,r)=>n(e.getId(),"$state."+r.join("."));s.addEventListener("delete",o),s.addEventListener("get",a),s.addEventListener("set",c);const l=r(i,{});return{value:l.proxy,destroy:()=>{s.removeEventListener("delete",o),s.removeEventListener("get",a),s.removeEventListener("set",c),l.revoke()}}}},B={name:"attribute",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers();let i=n(e,t,t.getValue());if(s.selector){if("string"!=typeof i)return;return i=u(i),void v(r,i)}if(Array.isArray(i))return;if("object"==typeof i)return void v(r,i);const o=t.getKeyRaw();b(r,o,i)}},G={name:"cloak",update:function(e,t,{transitionIn:n}){const r=t.getElement();r.removeAttribute(e.getLibrary().getOptions().prefix+"-"+this.name),n(e,r)}};const J=(e,...t)=>{const n={};for(let r=0;r<t.length&&!(r>=e.length);r++)n[e[r]]=t[r];return n},Q=(e,t,r=-1)=>++r>=e.length?-1:e[r][n].value===t?r:Q(e,t,r),Y=(e,t,r,s,i,o,a)=>{const c=Q(s,o,i);if(c>=0){if(c===i+1)return;const e=s[c];return y(s[i]??r,e),void t(e[n].id)}let l=document.importNode(r.content,!0);const u=-1===i?r:s[i];y(u,l),l=u.nextElementSibling,I(e,l),l[n]={id:Symbol(),value:o,variables:a},s.splice(i+1,0,l)},Z=(e,t,n)=>{if(!(t.length<n))for(let r=t.length-1;r>=n;r--){const n=t[r];t.splice(r,1),V(e,n,(()=>{n.remove()}))}};var ee={name:"for",update:(e,t,{executeExpression:r})=>{const s=t.getElement();if("TEMPLATE"!==s.tagName)return;const i=(e=>{const t=e.match(/^([$_a-z0-9,(){}\s]{1,}?)\s+(?:in|of)\s+([\s\S]{1,})$/i);if(!t)return;let n=t[1].replace(/^[\s({]*|[)}\s]*$/g,"");return n=n.match(/^([$_a-z0-9]{1,})?(?:,\s+?)?([$_a-z0-9]{1,})?(?:,\s+)?([$_a-z0-9]{1,})?$/i),n?(n.shift(),{iterable:t[2].trim(),variables:[...n]}):void 0})(t.getValue());if(!i)return;t[n]||(t[n]=[]);const o=t[n],a={},c=e=>{a[e]||(a[e]=["$for"])};let l;l=isNaN(i.iterable)?r(e,t,i.iterable):Number(i.iterable);const u=typeof l;if("number"===u){for(let t=0;t<l;t++){const n=J(i.variables,t);Y(e,c,s,o,t-1,l,n)}Z(e,o,l)}else if("string"===u){for(let t=0;t<l.length;t++){const n=l[t],r=J(i.variables,n,t);Y(e,c,s,o,t-1,n,r)}Z(e,o,l.length)}else{let t,n;try{const e=[...l];t=!0,n=e.length}catch{}if(t)for(let t=0;t<n;t++){const n=l[t],r=J(i.variables,n,t);Y(e,c,s,o,t-1,n,r)}else{const t=Object.keys(l);n=t.length;for(let r=0;r<n;r++){const n=t[r],a=l[n],u=J(i.variables,n,a,r);Y(e,c,s,o,r-1,a,u)}}Z(e,o,n)}Object.getOwnPropertySymbols(a).length>0&&e.update(a)},destroy:(e,t)=>{if(!e[n])return;if(!t[n])return;const r=t[n];for(const t of r)V(e,t,(()=>{t.remove()}));delete t[n]}};const te={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},ne=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var re={name:"html",update:(e,t,{executeExpression:n,morphTree:r})=>{const s=t.getElement(),i=t.getModifiers();let o=n(e,t,t.getValue());var a;if(i.decode&&"string"==typeof o&&(o="string"!=typeof(a=o)?a:a.replaceAll(ne,(e=>te[e]))),i.morph){if(0===s.children.length)s.appendChild(document.createElement("div"));else if(s.children.length>1)for(let e=s.children.length-1;e>=1;e--)s.children[e].remove();r(s.children[0],o)}else if(o instanceof HTMLElement){for(const e of s.children)e.remove();s.appendChild(o.cloneNode(!0))}else"string"!=typeof o||s.innerHTML!==o&&(s.innerHTML=o)}},se={name:"if",update:(e,t,{executeExpression:n,transitionIn:s,transitionOut:i})=>{const o=t.getElement();if("TEMPLATE"!==o.tagName)return;if(o.childCount>1)return;const a=n(e,t,t.getValue());let c=o[r];a?c||(c=document.importNode(o.content,!0),y(o,c),o[r]=c=o.nextElementSibling,s(e,c)):c&&i(e,c,(()=>{c.remove()}))},destroy:(e,t,{transitionOut:n})=>{const s=t.getElement(),i=s[r];i&&n(e,i,(()=>{i.remove(),s[r]=void 0}))}};const ie=(e,t)=>{if(!t[s])return;const n=e.getElement(),r=e.getLibrary().getOptions().prefix+"-updated";n.removeEventListener(r,t[s].handler),delete t[s]};var oe={name:"initialized",update:(e,t,{executeExpression:n})=>{const r=e.getElement(),i=t.getValue(),o=e.getLibrary().getOptions().prefix+"-updated";if(t[s]){if(t[s].value===i)return;r.removeEventListener(o,t[s].handler),delete t[s]}const a=({detail:s})=>{s.element===r&&(n(e,t.clone(),i,{},{return:!1}),ie(e,t))};r.addEventListener(o,a,{once:!0}),t[s]={handler:a,value:i}},destroy:ie};const ae=["alt","ctrl","meta","shift"];var ce={name:"on",update:(e,t,{executeExpression:n})=>{let r,s=t.getKeyRaw();if(!s)return;s.startsWith("keydown-")?(r=s.substring(8).toLowerCase(),s="keydown"):s.startsWith("keyup-")&&(r=s.substring(6).toLowerCase(),s="keyup");const o=t.getElement(),a=t.getValue();if(t[i]){if(t[i].value===a)return;t[i].target.removeEventListener(s,t[i].handler),t[i].timeout&&clearTimeout(t[i].timeout),delete t[i]}const c=t.getModifiers(),l={};c.capture&&(l.capture=!0),c.once&&(l.once=!0),c.passive&&(l.passive=!0);let u=0;c.buffer?(u=1,!0===c.buffer&&(c.buffer=5)):c.debounce?(u=2,!0===c.debounce&&(c.debounce=500)):c.throttle&&(u=3,!0===c.throttle&&(c.throttle=500));const d=[];if(r){c.meta=!!c.meta||c.cmd||c.super;for(const e of ae)c[e]&&d.push(e)}const f=l=>{if(c.self&&l.target!==o)return;if(c.outside&&o.contains(l.target))return;if(("keydown"===s||"keyup"===s)&&r){for(const e of d)if(!l[e+"Key"])return;let e=c.code?l.code:l.key;if(" "===e&&(e="space"),e=e.toLowerCase(),r!==e)return}c.prevent&&l.preventDefault(),c.stop&&l.stopPropagation();const f=()=>{n(e,t.clone(),a,{$event:l,$events:t[i].buffer},{return:!1}),t[i].buffer=[]};if(t[i].buffer.push(l),1===u){if(t[i].buffer.length<c.buffer)return;f()}else if(1===u)t[i].timeout&&(clearTimeout(t[i].timeout),t[i].timeout=null),t[i].timeout=setTimeout(f,c.debounce);else if(3===u){const e=window.performance.now();if(t[i].lastExecution&&e-t[i].lastExecution<c.throttle)return;f(),t[i].lastExecution=e}else f()},h=c.outside?document:o;h.addEventListener(s,f,l),t[i]={buffer:[],handler:f,target:h,timeout:t[i]?t[i].timeout:void 0,value:a}},destroy:(e,t)=>{if(!t[i])return;const n=t.getKeyRaw();t[i].target.removeEventListener(n,t[i].handler),t[i].timeout&&clearTimeout(t[i].timeout),delete t[i]}};const le=(e,t)=>{if(!e[o])return;const n=t.getId();if(!e[o][n])return;const r=e.getLibrary(),s=e.getId(),i=t.getValue().trim();delete e[o][n],delete e[a],0===Object.keys(e[o]).length&&delete e[o],r.update([{id:s,path:"$references."+i}])};var ue={name:"reference",update:(e,t)=>{const n=t.getValue().trim();if(!/^[_$a-z]{1}[_\-$a-z0-9]{0,}$/i.test(n))return void le(e,t);const r=e.getLibrary(),s=e.getId(),i=t.getElement(),c=t.getId();e[o]||(e[o]={}),e[o][c]={element:i,name:n},delete e[a],r.update([{id:s,path:"$references."+n}])},destroy:le},de={name:"select",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=r.getAttribute("type");if("SELECT"!==r.tagName&&("INPUT"!==r.tagName||"checkbox"!==s&&"radio"!==s))return;const i=n(e,t,t.getValue());if("SELECT"===r.tagName)for(const e of Array.from(r.options)){const t=Array.isArray(i)?i.includes(e.value):i===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}else if("checkbox"===s){const e=i.includes(r.value);r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}else{const e=i===r.value;r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}}},fe={name:"show",update:(e,t,{executeExpression:n,transitionIn:r,transitionOut:s})=>{const i=t.getElement();n(e,t,t.getValue())?(i.style.display=null,r(e,i)):s(e,i,(()=>{i.style.display="none"}))}};const he=(e,t,n)=>{if("object"!=typeof e)return;let r=0;for(;r<t.length-1;r++)if("object"!=typeof(e=e[t[r]]))return;e[t[r]]=n},pe="$state.",ge=function(e,t,n){const r=(t,n)=>{n[e]&&(n.getElement().removeEventListener("input",n[e]),delete n[e])};return{update:(t,s,{executeExpression:i})=>{const o=s.getElement(),a=!s[e];if(a&&("DIV"!==o.tagName||!o.hasAttribute("contenteditable"))&&"INPUT"!==o.tagName&&"SELECT"!==o.tagName&&"TEXTAREA"!==o.tagName)return;const c=s.getValue();if(!/^[_$a-z]{1}[._$a-z0-9]{0,}$/i.test(c))return void r(0,s);let l=c;if(l.startsWith(n)&&(l=l.substring(n.length)),l=l.split("."),a){const{data:n,id:r,path:a}=((e,t)=>{let n=t.getValue();return n.startsWith(pe)||(n=pe+n),{data:e.getState(),id:e.getId(),path:n}})(t,s);let u;switch(o.tagName){case"DIV":u=()=>(he(n,l,o.innerText),!0);break;case"INPUT":u=()=>{if("checkbox"===o.type){const e=i(t,s.clone(),c);if(o.checked){if(!e)return he(n,l,[o.value]),!0;if(!e.includes(o.value))return e.push(o.value),!0}else if(e){const t=e.indexOf(o.value);if(t>=0)return e.splice(t,1),!0}}else{if("radio"!==o.type)return he(n,l,o.value),!0;{const e=i(t,s.clone(),c);if(o.checked){if(e!==o.value)return he(n,l,o.value),!0}else if(e===o.value)return he(n,l,null),!0}}return!1};break;case"TEXTAREA":u=()=>(he(n,l,o.value),!0);break;case"SELECT":u=()=>{if(o.multiple){const e=[];for(const t of o.selectedOptions)e.push(t.value);return he(n,l,e),!0}return he(n,l,o.selectedOptions[0].value),!0}}const d=()=>{u()&&t.getLibrary().update([{id:r,path:a}])};o.addEventListener("input",d),s[e]=d}const u=i(t,s,c);switch(o.tagName){case"DIV":case"TEXTAREA":u!==o.innerText&&(o.innerText=u);break;case"INPUT":if("checkbox"===o.type){const e=u.includes(o.value);o.checked!==e&&(o.checked=e,e?o.setAttribute("checked",""):o.removeAttribute("checked"))}else if("radio"===o.type){const e=u===o.value;o.checked!==e&&(o.checked=e,e?o.setAttribute("checked",""):o.removeAttribute("checked"))}else u!==o.value&&o.setAttribute("value",u);break;case"SELECT":for(const e of Array.from(o.options)){const t=Array.isArray(u)?u.includes(e.value):u===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}}},destroy:r}}(c,0,pe);ge.name="sync-state";var me={name:"text",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers(),i=n(e,t,t.getValue());s.content?r.textContent!==i&&(r.textContent=i):r.innerText!==i&&(r.innerText=i)}},be={name:"watch",update:(e,t,{executeExpression:n})=>{const r=t.getValue();n(e,t,r,{},{return:!1})}};return class extends l{constructor(n){super();let{prefix:r,root:s}=n=Object.assign({prefix:"d",root:document.body.firstElementChild},n);if("string"==typeof s&&(n.root=s=document.querySelector(s)),!r)return;if("string"!=typeof r)return;if(!s)return;if("object"!=typeof s)return;const i=Symbol();let o,a,c,l=!1,u=!1;const d=[],f=[z,M,_,K,q,W,F,H,X,U],h=[ue,B,ee,re,se,me,G,oe,ce,de,fe,ge,be];let p,g,m;this.getEnabled=()=>l,this.getId=()=>i,this.getOptions=()=>Object.assign({},n),this.enable=()=>{if(l)return this;u=!1,o=[],c={},this.dispatchEvent("enabling",[this]),l=!0,p=h.map((e=>e.name)),g={};for(const e of h)g[e.name]=e;m=new RegExp("^"+r+"-("+p.join("|")+")(?:[$-_.a-z0-9]{0,})?$","i"),a=new MutationObserver(y.bind(this)),a.observe(s,{attributes:!0,childList:!0,subtree:!0});const e=r+"-state",t=r+"-ignore",n=[...s.querySelectorAll("["+e+"]")];for(let e=n.length-1;e>=0;e--)n[e].closest("["+t+"]")&&n.splice(e,1);return b(s.hasAttribute(e)&&!s.hasAttribute(t)?s:null,...n),this.dispatchEvent("enabled",[this]),this.dispatchEvent("updated",[this]),this},this.disable=()=>l?(a.disconnect(),a=null,u=o=c=null,this.dispatchEvent("disabling",[this],{reverse:!0}),v(...d),p=g=m=null,l=!1,this.dispatchEvent("disabled",[this],{reverse:!0}),this):this;const b=(...e)=>{const n=[],r=[];for(const s of e){if(!s)continue;if(s[t])continue;const e=new D(this,s);d.push(e),n.push(e),r.push(s)}r.length>0&&this.dispatchEvent("components-added",[this,r]);for(const e of n)e.initialize();for(const e of n)e.updateAttributes(e.getAttributes());return n},v=(...e)=>{const t=[];for(const n of e){const e=d.indexOf(n);e<0||(t.push(n.getElement()),n.destroy(),d.splice(e,1))}return t.length>0&&this.dispatchEvent("components-removed",[this,t]),t};this.getContexts=()=>[...f],this.addContexts=(e,...t)=>{if(l)return;e<0?e=f.length+e%f.length:e>f.length&&(e=f.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];f.includes(s)||(f.splice(e+r,0,s),n.push(s))}return n.length>0&&this.dispatchEvent("contexts-added",[this,n]),n},this.removeContexts=(...e)=>{if(l)return;const t=[];for(const n of e)f.indexOf(n)<0||t.push(n);return t.length>0&&this.dispatchEvent("contexts-removed",[this,t]),t},this.getDirectives=()=>[...h],this.getDirectivesNames=()=>[...p],this.getDirectivesObject=()=>Object.assign({},g),this.isDirectiveName=e=>m.test(e),this.addDirectives=(e,...t)=>{if(l)return;e<0?e=h.length+e%h.length:e>h.length&&(e=h.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];h.includes(s)||(h.splice(e+r,0,s),n.push(s))}return n.length>0&&(p=g=m=null,this.dispatchEvent("directives-added",[this,n])),n},this.removeDirectives=(...e)=>{if(l)return;const t=[];for(const n of e)h.indexOf(n)<0||t.push(n);return t.length>0&&(p=g=m=null,this.dispatchEvent("directives-removed",[this,t])),t},this.update=e=>{if(l){if(e)for(const t of e){const{id:e,path:n}=t;e in c?c[e].includes(n)||c[e].push(n):c[e]=[n]}if(!u&&0!==Object.getOwnPropertySymbols(c).length){u=!0,e=c,c={};for(const t of d)t.update(e);u=!1,Object.getOwnPropertySymbols(c).length>0?window.requestAnimationFrame((()=>this.update())):o.length>0?y():this.dispatchEvent("updated",[this])}}};const y=n=>{if(o.push(...n),u)return;if(0===o.length)return;u=!0,n=[...o],o=[];const s=r+"-state",i=r+"-ignore",a=[],l=[],d=n=>{if(1===n.nodeType)if(n[t]){l.unshift(n[t]);const e=n.querySelectorAll(s);for(const n of e)n[t]&&l.unshift(n)}else{const r=x(n,(e=>!e[t]||(l.unshift(e[t]),!1)));do{if(n[e])for(const t of n[e])t.getComponent().removeAttribute(t)}while(n=r())}},f=e=>{if(1!==e.nodeType)return;if(e.closest("["+i+"]"))return;const t=e.querySelectorAll("["+s+"]");for(const e of t)e.closest("["+i+"]")||a.push(e);if(e.hasAttribute(s))return void a.push(e);const n=j(e);if(n){const t=n.scanAttributes(e);n.updateAttributes(t)}};for(const r of n)if("childList"===r.type){for(const e of r.removedNodes)d(e);for(const e of r.addedNodes)f(e)}else if("attributes"===r.type){const n=r.target;if(r.attributeName===s){if(n[t])continue;const r=j(n);if(r){let t=n;const i=x(n,(e=>e.hasAttribute(s)));do{for(const n of t[e])r.removeAttribute(n)}while(t=i())}b(n);continue}if(r.attributeName===i){if(n.hasAttribute(i)){d(n);continue}f(n);continue}if(!m.test(r.attributeName))continue;const o=j(n);if(!o)continue;let a=null;for(const t of n[e])if(t.getName()===r.attributeName){a=t;break}const c=n.getAttribute(r.attributeName);if(!a){c&&o.addAttribute(n,r.attributeName,c);continue}a.setValue(c),o.updateAttribute(a)}l.length>0&&v(...l),a.length>0&&b(...a),u=!1,o.length>0?y():Object.getOwnPropertySymbols(c).length>0&&this.update()}}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global="undefined"!=typeof globalThis?globalThis:global||self).Doars=factory();
