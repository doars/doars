var n=Symbol("INTERSECT"),d={NONE:0,BUFFER:1,DEBOUNCE:2,THROTTLE:3},a=({intersectDirectiveName:c},t)=>({name:c,update:(s,e,r)=>{let o=e.getElement(),l=e.getKey(),f=e.getValue();if(e[n]){if(e[n].value===f)return;t.remove(o,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}let i=e.getModifiers(),u=d.NONE;i.buffer?(u=d.BUFFER,i.buffer===!0&&(i.buffer=5)):i.debounce?(u=d.DEBOUNCE,i.debounce===!0&&(i.debounce=500)):i.throttle&&(u=d.THROTTLE,i.throttle===!0&&(i.throttle=500));let h=m=>{if(!(e[n].isIntersecting!==m.isIntersecting))return;if(e[n].isIntersecting=m.isIntersecting,l==="enter"&&!m.isIntersecting||l==="leave"&&m.isIntersecting){e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null);return}let E=()=>{r(s,e.clone(),f,{$event:m},{return:!1}),e[n].buffer=[]};if(e[n].buffer.push(m),u===d.BUFFER){if(e[n].buffer.length<i.buffer)return;E()}else if(u===d.BUFFER)e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null),e[n].timeout=setTimeout(E,i.debounce);else if(u===d.THROTTLE){let T=window.performance.now();if(e[n].lastExecution&&T-e[n].lastExecution<i.throttle)return;E(),e[n].lastExecution=T}else E()};t.add(o,h),e[n]={buffer:[],handler:h,isIntersecting:!1,timeout:e[n]?e[n].timeout:null,value:f}},destroy:(s,e)=>{if(!e[n])return;let r=e.getElement();t.remove(r,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}});var g=class c{constructor(t=null){let s=new WeakMap,e=o=>{for(let l of o)for(let f of s.get(l.target))f(l)},r=new c(e,t);this.add=(o,l)=>{s.has(o)||s.set(o,[]),s.get(o).push(l),r.observe(o)},this.remove=(o,l)=>{if(!s.has(o))return;let f=s.get(o),i=f.indexOf(l);i>=0&&f.splice(i,1),f.length===0&&(s.delete(o),r.unobserve(o))}}};function N(c,t=null){t=Object.assign({intersectDirectiveName:"intersect",intersectionRoot:null,intersectionMargin:"0px",intersectionThreshold:0},t);let s=!1,e,r,o=()=>{let f=Object.assign({},t);f.root||(f.root=c.getOptions().root),r=new g({root:t.intersectionRoot?t.intersectionRoot:c.getOptions().root,rootMargin:t.intersectionMargin,threshold:t.intersectionThreshold}),e=a(t,r),c.addDirectives(-1,e)},l=()=>{c.removeDirectives(e),e=null,r=null};this.disable=()=>{!c.getEnabled()&&s&&(s=!1,c.removeEventListener("enabling",o),c.removeEventListener("disabling",l))},this.enable=()=>{s||(s=!0,c.addEventListener("enabling",o),c.addEventListener("disabling",l))},this.enable()}export{N as default};
//# sourceMappingURL=doars-intersect.esm.min.js.map
