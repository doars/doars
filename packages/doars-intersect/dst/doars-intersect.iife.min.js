(()=>{var n=Symbol("INTERSECT"),d={NONE:0,BUFFER:1,DEBOUNCE:2,THROTTLE:3},a=({intersectDirectiveName:c},i)=>({name:c,update:(s,e,f)=>{let o=e.getElement(),r=e.getKey(),l=e.getValue();if(e[n]){if(e[n].value===l)return;i.remove(o,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}let t=e.getModifiers(),m=d.NONE;t.buffer?(m=d.BUFFER,t.buffer===!0&&(t.buffer=5)):t.debounce?(m=d.DEBOUNCE,t.debounce===!0&&(t.debounce=500)):t.throttle&&(m=d.THROTTLE,t.throttle===!0&&(t.throttle=500));let h=u=>{if(!(e[n].isIntersecting!==u.isIntersecting))return;if(e[n].isIntersecting=u.isIntersecting,r==="enter"&&!u.isIntersecting||r==="leave"&&u.isIntersecting){e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null);return}let E=()=>{f(s,e.clone(),l,{$event:u},{return:!1}),e[n].buffer=[]};if(e[n].buffer.push(u),m===d.BUFFER){if(e[n].buffer.length<t.buffer)return;E()}else if(m===d.BUFFER)e[n].timeout&&(clearTimeout(e[n].timeout),e[n].timeout=null),e[n].timeout=setTimeout(E,t.debounce);else if(m===d.THROTTLE){let T=window.performance.now();if(e[n].lastExecution&&T-e[n].lastExecution<t.throttle)return;E(),e[n].lastExecution=T}else E()};i.add(o,h),e[n]={buffer:[],handler:h,isIntersecting:!1,timeout:e[n]?e[n].timeout:null,value:l}},destroy:(s,e)=>{if(!e[n])return;let f=e.getElement();i.remove(f,e[n].handler),e[n].timeout&&clearTimeout(e[n].timeout),delete e[n]}});var g=class c{constructor(i=null){let s=new WeakMap,e=o=>{for(let r of o)for(let l of s.get(r.target))l(r)},f=new c(e,i);this.add=(o,r)=>{s.has(o)||s.set(o,[]),s.get(o).push(r),f.observe(o)},this.remove=(o,r)=>{if(!s.has(o))return;let l=s.get(o),t=l.indexOf(r);t>=0&&l.splice(t,1),l.length===0&&(s.delete(o),f.unobserve(o))}}};function v(c,i=null){i=Object.assign({intersectDirectiveName:"intersect",intersectionRoot:null,intersectionMargin:"0px",intersectionThreshold:0},i);let s=!1,e,f,o=()=>{let l=Object.assign({},i);l.root||(l.root=c.getOptions().root),f=new g({root:i.intersectionRoot?i.intersectionRoot:c.getOptions().root,rootMargin:i.intersectionMargin,threshold:i.intersectionThreshold}),e=a(i,f),c.addDirectives(-1,e)},r=()=>{c.removeDirectives(e),e=null,f=null};this.disable=()=>{!c.getEnabled()&&s&&(s=!1,c.removeEventListener("enabling",o),c.removeEventListener("disabling",r))},this.enable=()=>{s||(s=!0,c.addEventListener("enabling",o),c.addEventListener("disabling",r))},this.enable()}window.DoarsIntersect=v;})();
//# sourceMappingURL=doars-intersect.iife.min.js.map
