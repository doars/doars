var S=({updateContextName:F},B)=>{let J=B.getId(),L=B.getProxy(),z=B.getTime();return{name:F,create:(K,G)=>{let T=(Q,V)=>G.accessed(J,V.join("."));return L.addEventListener("get",T),{value:z,destroy:()=>{L.removeEventListener("get",T)}}}}};var X=({defaultOrder:F,updateDirectiveName:B})=>{let J=[],L=[],z={name:B,update:(K,G,T)=>{if(!z._execute)z._execute=T;let Q=G.getId();if(J.indexOf(Q)>=0)return;let{order:V}=G.getModifiers();if(!V)V=F;let C=0;for(let W=0;W<L.length;W++)if(L[W].order>=V){C=W;break}L.splice(C,0,{attribute:G,component:K,order:V})},destroy:(K,G)=>{let T=G.getId(),Q=J.indexOf(T);if(Q>=0)return;J.splice(Q,1);for(let V=0;V<L.length;V++)if(L[V].attribute===G){L.splice(V,1);break}}};return[z,()=>{for(let K of L)z._execute(K.component,K.attribute.clone(),K.attribute.getValue(),{},{return:!1})}]};var _=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","has","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],Y=(F,B)=>{let J=!1,L={};for(let z of _)L[z]=(...K)=>{if(J)return;if(z in B)return B[z](...K);return Reflect[z](...K)};return{proxy:new Proxy(F,L),revoke:()=>{J=!0}}};class Z{constructor(){let F={};this.addEventListener=(B,J,L=null)=>{if(!(B in F))F[B]=[];F[B].push({callback:J,options:L})},this.removeEventListener=(B,J)=>{if(!Object.keys(F).includes(B))return;let L=F[B],z=-1;for(let K=0;K<L.length;K++)if(L[K].callback===J){z=K;break}if(z<0)return;if(L.splice(z,1),Object.keys(L).length===0)delete F[B]},this.removeEventListeners=(B)=>{if(!B)return;delete F[B]},this.removeAllEventListeners=()=>{F={}},this.dispatchEvent=(B,J,L=null)=>{if(!F[B])return;let z=F[B];for(let K=0;K<z.length;K++){let G=L&&L.reverse?z[z.length-(K+1)]:z[K];if(G.options&&G.options.once)z.splice(K,1);G.callback(...J)}}}}class $ extends Z{constructor(F={}){super();F=Object.assign({delete:!0,get:!0,set:!0},F);let B=new WeakMap;this.add=(J,L=[])=>{if(B.has(J))return B.get(J);for(let G in J)if(J[G]&&typeof J[G]==="object")J[G]=this.add(J[G],[...L,G]);let z={};if(F.delete)z.deleteProperty=(G,T)=>{if(!Reflect.has(G,T))return!0;this.remove(G,T);let Q=Reflect.deleteProperty(G,T);if(Q)this.dispatchEvent("delete",[G,Array.isArray(G)?[...L]:[...L,T]]);return Q};if(F.get)z.get=(G,T,Q)=>{if(T!==Symbol.unscopables)this.dispatchEvent("get",[G,[...L,T],Q]);return Reflect.get(G,T,Q)};if(F.set)z.set=(G,T,Q,V)=>{if(G[T]===Q)return!0;if(Q&&typeof Q==="object")Q=this.add(Q,[...L,T]);return G[T]=Q,this.dispatchEvent("set",[G,Array.isArray(G)?[...L]:[...L,T],Q,V]),!0};let K=Y(J,z);return B.set(K,J),K.proxy},this.remove=(J)=>{if(!B.has(J))return;let L=B.get(J);B.delete(L);for(let z in L.proxy)if(typeof L.proxy[z]==="object")this.remove(L.proxy[z]);L.revoke()}}}class w{constructor({stepMinimum:F},B){let J=Symbol("ID_UPDATE"),L=!1,z,K=new $({delete:!1,set:!1}),G=K.add({}),T=(Q)=>{if(!L)return;if(z=window.requestAnimationFrame(T),!G.startMs){G.currentMs=G.lastMs=G.startMs=Q,G.current=G.last=G.start=Q/1000,G.delta=G.passed=G.deltaMs=G.passedMs=0;return}let V=Q-G.lastMs;if(V<=F)return;G.lastMs=G.currentMs,G.last=G.current,G.currentMs=Q,G.current=Q/1000,G.deltaMs=V,G.delta=V/1000,G.passedMs+=V,G.passed=G.passedMs/1000,B()};this.isEnabled=()=>{return L},this.getId=()=>{return J},this.getProxy=()=>{return K},this.getTime=()=>{return G},this.enable=()=>{if(L)return;L=!0,z=window.requestAnimationFrame(T)},this.disable=()=>{if(!L)return;if(L=!1,z)cancelAnimationFrame(z),z=null}}}function H(F,B=null){B=Object.assign({defaultOrder:500,stepMinimum:0,updateContextName:"$update",updateDirectiveName:"update"},B);let J=!1,L=new w(B,()=>{G(),F.update([{id:L.getId(),path:"current"},{id:L.getId(),path:"delta"},{id:L.getId(),path:"last"},{id:L.getId(),path:"passed"}])}),z=S(B,L),[K,G]=X(B),T=()=>{F.addContexts(0,z),F.addDirectives(-1,K),L.enable()},Q=()=>{F.removeContexts(z),F.removeDirectives(K),L.disable()};this.disable=()=>{if(!F.getEnabled()&&J)J=!1,F.removeEventListener("enabling",T),F.removeEventListener("disabling",Q)},this.enable=()=>{if(!J)J=!0,F.addEventListener("enabling",T),F.addEventListener("disabling",Q)},this.enable()}export{H as default};

//# debugId=D0B12BC575F76BF264756E2164756E21
