function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}var f=function(e){var t=e.getId(),n=e.getProxy(),r=e.getTime();return{name:"$update",create:function(e,o){var i=function(e,n){return o.accessed(t,n.join("."))};return n.addEventListener("get",i),{value:r,destroy:function(){n.removeEventListener("get",i)}}}}},d=function(e){e=Object.assign({defaultOrder:500},e);var t=[],n=[],r={name:"update",update:function(r,o,i){var a=i.executeExpression;this._execute||(this._execute=a);var u=o.getId();if(!(t.indexOf(u)>=0)){var c=o.getModifiers().order;c||(c=e.defaultOrder);for(var l=0,s=0;s<n.length;s++)if(n[s].order>=c){l=s;break}n.splice(l,0,{attribute:o,component:r,order:c})}},destroy:function(e,r){var o=r.getId(),i=t.indexOf(o);if(!(i>=0)){t.splice(i,1);for(var a=0;a<n.length;a++)if(n[a].attribute===r){n.splice(a,1);break}}}};return[r,function(){var e,t=s(n);try{for(t.s();!(e=t.n()).done;){var o=e.value;r._execute(o.component,o.attribute.clone(),o.attribute.getValue(),{},{return:!1})}}catch(e){t.e(e)}finally{t.f()}}]},p=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],y=function(e,t){var n,r=!1,o={},i=s(p);try{var a=function(){var e=n.value;o[e]=function(){if(!r)return e in t?t[e].apply(t,arguments):Reflect[e].apply(Reflect,arguments);console.error("illegal operation attempted on a revoked proxy")}};for(i.s();!(n=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}return{proxy:new Proxy(e,o),revoke:function(){r=!0}}},v=n((function t(){e(this,t);var n={};this.addEventListener=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e in n||(n[e]=[]),n[e].push({callback:t,options:r})},this.removeEventListener=function(e,t){if(Object.keys(n).includes(e)){for(var r=n[e],o=-1,i=0;i<r.length;i++)if(r[i].callback===t){o=i;break}o<0||(r.splice(o,1),0===Object.keys(r).length&&delete n[e])}},this.removeEventListeners=function(e){e&&delete n[e]},this.removeAllEventListeners=function(){n={}},this.dispatchEvent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n[e])for(var o=n[e],i=0;i<o.length;i++){var a=r&&r.reverse?o[o.length-(i+1)]:o[i];a.options&&a.options.once&&o.splice(i,1),a.callback.apply(a,u(t))}}})),h=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(s,v);var a,c,l=(a=s,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=r(a);if(c){var n=r(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return i(this,e)});function s(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,s),t=l.call(this),n=Object.assign({delete:!0,get:!0,set:!0},n);var r=new WeakMap;return t.add=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r.has(e))return r.get(e);for(var i in e)e[i]&&"object"==typeof e[i]&&(e[i]=t.add(e[i],[].concat(u(o),[i])));var a={};n.delete&&(a.deleteProperty=function(e,n){if(!Reflect.has(e,n))return!0;t.remove(e,n);var r=Reflect.deleteProperty(e,n);return r&&t.dispatchEvent("delete",[e,Array.isArray(e)?u(o):[].concat(u(o),[n])]),r}),n.get&&(a.get=function(e,n,r){return n!==Symbol.unscopables&&t.dispatchEvent("get",[e,[].concat(u(o),[n]),r]),Reflect.get(e,n,r)}),n.set&&(a.set=function(e,n,r,i){return e[n]===r||("object"==typeof r&&(r=t.add(r,[].concat(u(o),[n]))),e[n]=r,t.dispatchEvent("set",[e,Array.isArray(e)?u(o):[].concat(u(o),[n]),r,i])),!0});var c=y(e,a);return r.set(c,e),c.proxy},t.remove=function(e){if(r.has(e)){var n=r.get(e);for(var o in r.delete(n),n.proxy)"object"==typeof n.proxy[o]&&t.remove(n.proxy[o]);n.revoke()}},t}return n(s)}(),b=n((function t(n,r){e(this,t),n=Object.assign({stepMinimum:0},n);var o,i=Symbol(),a=!1,u=new h({delete:!1,set:!1}),c=u.add({}),l=function e(t){if(a){if(o=window.requestAnimationFrame(e),!c.startMs)return c.currentMs=c.lastMs=c.startMs=t,c.current=c.last=c.start=t/1e3,void(c.delta=c.passed=c.deltaMs=c.passedMs=0);var i=t-c.lastMs;i<=n.stepMinimum||(c.lastMs=c.currentMs,c.last=c.current,c.currentMs=t,c.current=t/1e3,c.deltaMs=i,c.delta=i/1e3,c.passedMs+=i,c.passed=c.passedMs/1e3,r())}};this.isEnabled=function(){return a},this.getId=function(){return i},this.getProxy=function(){return u},this.getTime=function(){return c},this.enable=function(){a||(a=!0,o=window.requestAnimationFrame(l))},this.disable=function(){a&&(a=!1,o&&(cancelAnimationFrame(o),o=null))}})),g=n((function t(n){var r,o,i,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e(this,t),u=Object.assign({},u),n.addEventListener("enabling",(function(){var e=a(d(u),2),t=e[0],c=e[1];o=t,n.addDirectives(-1,o),i=new b(u,(function(){c(),n.update([{id:i.getId(),path:"current"},{id:i.getId(),path:"delta"},{id:i.getId(),path:"last"},{id:i.getId(),path:"passed"}])})),r=f(i),n.addContexts(0,r),i.enable()})),n.addEventListener("disabling",(function(){n.removeContexts(r),n.removeDirectives(o),i.disable(),r=null,o=null,i=null}))}));export{g as default};
