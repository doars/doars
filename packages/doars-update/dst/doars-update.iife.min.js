var DoarsUpdate=function(){"use strict";const e=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"];class t extends class{constructor(){let e={};this.addEventListener=(t,s,r=null)=>{t in e||(e[t]=[]),e[t].push({callback:s,options:r})},this.removeEventListener=(t,s)=>{if(!Object.keys(e).includes(t))return;const r=e[t];let n=-1;for(let e=0;e<r.length;e++)if(r[e].callback===s){n=e;break}n<0||(r.splice(n,1),0===Object.keys(r).length&&delete e[t])},this.removeEventListeners=t=>{t&&delete e[t]},this.removeAllEventListeners=()=>{e={}},this.dispatchEvent=(t,s,r=null)=>{if(!e[t])return;const n=e[t];for(let e=0;e<n.length;e++){const t=r&&r.reverse?n[n.length-(e+1)]:n[e];t.options&&t.options.once&&n.splice(e,1),t.callback(...s)}}}}{constructor(t={}){super(),t=Object.assign({delete:!0,get:!0,set:!0},t);const s=new WeakMap;this.add=(r,n=[])=>{if(s.has(r))return s.get(r);for(const e in r)r[e]&&"object"==typeof r[e]&&(r[e]=this.add(r[e],[...n,e]));const o={};t.delete&&(o.deleteProperty=(e,t)=>{if(!Reflect.has(e,t))return!0;this.remove(e,t);const s=Reflect.deleteProperty(e,t);return s&&this.dispatchEvent("delete",[e,Array.isArray(e)?[...n]:[...n,t]]),s}),t.get&&(o.get=(e,t,s)=>(t!==Symbol.unscopables&&this.dispatchEvent("get",[e,[...n,t],s]),Reflect.get(e,t,s))),t.set&&(o.set=(e,t,s,r)=>(e[t]===s||("object"==typeof s&&(s=this.add(s,[...n,t])),e[t]=s,this.dispatchEvent("set",[e,Array.isArray(e)?[...n]:[...n,t],s,r])),!0));const i=function(t,s){let r=!1;const n={};for(const t of e)n[t]=(...e)=>{if(!r)return t in s?s[t](...e):Reflect[t](...e);console.error("illegal operation attempted on a revoked proxy")};return{proxy:new Proxy(t,n),revoke:()=>{r=!0}}}(r,o);return s.set(i,r),i.proxy},this.remove=e=>{if(!s.has(e))return;const t=s.get(e);s.delete(t);for(const e in t.proxy)"object"==typeof t.proxy[e]&&this.remove(t.proxy[e]);t.revoke()}}}class s{constructor(e,s){e=Object.assign({stepMinimum:0},e);const r=Symbol();let n,o=!1;const i=new t({delete:!1,set:!1}),a=i.add({}),c=function(t){if(!o)return;if(n=window.requestAnimationFrame(c),!a.startMs)return a.currentMs=a.lastMs=a.startMs=t,a.current=a.last=a.start=t/1e3,void(a.delta=a.passed=a.deltaMs=a.passedMs=0);const r=t-a.lastMs;r<=e.stepMinimum||(a.lastMs=a.currentMs,a.last=a.current,a.currentMs=t,a.current=t/1e3,a.deltaMs=r,a.delta=r/1e3,a.passedMs+=r,a.passed=a.passedMs/1e3,s())};this.isEnabled=()=>o,this.getId=()=>r,this.getProxy=()=>i,this.getTime=()=>a,this.enable=()=>{o||(o=!0,n=window.requestAnimationFrame(c))},this.disable=()=>{o&&(o=!1,n&&(cancelAnimationFrame(n),n=null))}}}return class{constructor(e,t=null){let r,n,o;t=Object.assign({},t),e.addEventListener("enabling",(()=>{const[i,a]=function(e){e=Object.assign({defaultOrder:500},e);const t=[],s=[],r={name:"update",update:function(r,n,{executeExpression:o}){this._execute||(this._execute=o);const i=n.getId();if(t.indexOf(i)>=0)return;let{order:a}=n.getModifiers();a||(a=e.defaultOrder);let c=0;for(let e=0;e<s.length;e++)if(s[e].order>=a){c=e;break}s.splice(c,0,{attribute:n,component:r,order:a})},destroy:(e,r)=>{const n=r.getId(),o=t.indexOf(n);if(!(o>=0)){t.splice(o,1);for(let e=0;e<s.length;e++)if(s[e].attribute===r){s.splice(e,1);break}}}};return[r,()=>{for(const e of s)r._execute(e.component,e.attribute.clone(),e.attribute.getValue(),{},{return:!1})}]}(t);n=i,e.addDirectives(-1,n),o=new s(t,(()=>{a(),e.update([{id:o.getId(),path:"current"},{id:o.getId(),path:"delta"},{id:o.getId(),path:"last"},{id:o.getId(),path:"passed"}])})),r=function(e){const t=e.getId(),s=e.getProxy(),r=e.getTime();return{name:"$update",create:(e,n)=>{const o=(e,s)=>n.accessed(t,s.join("."));return s.addEventListener("get",o),{value:r,destroy:()=>{s.removeEventListener("get",o)}}}}}(o),e.addContexts(0,r),o.enable()})),e.addEventListener("disabling",(()=>{e.removeContexts(r),e.removeDirectives(n),o.disable(),r=null,n=null,o=null}))}}}();
