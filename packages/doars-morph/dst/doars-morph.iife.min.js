(()=>{var d=(t,e)=>{let r=t.attributes,o=e.attributes,i=null,s=null,u=null,l=null,n=null;for(let c=o.length-1;c>=0;--c)n=o[c],l=n.name,i=n.namespaceURI,s=n.value,i?(l=n.localName||l,u=t.getAttributeNS(i,l),u!==s&&t.setAttributeNS(i,l,s)):t.hasAttribute(l)?(u=t.getAttribute(l),u!==s&&(s==="null"||s==="undefined"?t.removeAttribute(l):t.setAttribute(l,s))):t.setAttribute(l,s);for(let c=r.length-1;c>=0;--c)n=r[c],n.specified!==!1&&(l=n.name,i=n.namespaceURI,i?(l=n.localName||l,e.hasAttributeNS(i,l)||t.removeAttributeNS(i,l)):e.hasAttributeNS(null,l)||t.removeAttribute(l))};var A=t=>{let e=t.substring(0,15).toLowerCase();if(e.startsWith("<!doctype html>")||e.startsWith("<html>")){let i=document.createElement("html");return i.innerHTML=t,i}let o=document.createElement("template");return o.innerHTML=t,o.content.childNodes[0]};var p=(t,e)=>t.isSameNode&&t.isSameNode(e)?!0:t.type===3?t.nodeValue===e.nodeValue:t.tagName===e.tagName;var j=(t,e)=>{let r=e.nodeType,o=e.nodeName;r===1&&d(t,e),(r===3||r===8)&&t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue),o==="INPUT"?y(t,e):o==="OPTION"?m(t,e,"selected"):o==="TEXTAREA"&&D(t,e)},f=(t,e,r)=>{if(typeof t!="object")throw new Error("Existing tree should be an object.");if(typeof e=="string")e=A(e);else if(typeof e!="object")throw new Error("New tree should be an object.");return r&&r.childrenOnly||e.nodeType===11?(v(t,e),t):a(t,e)},y=(t,e)=>{let r=e.value,o=t.value;m(t,e,"checked"),m(t,e,"disabled"),t.indeterminate!==e.indeterminate&&(t.indeterminate=e.indeterminate),t.type!=="file"&&(o!==r&&(t.setAttribute("value",r),t.value=r),r==="null"&&(t.value="",t.removeAttribute("value")),e.hasAttributeNS(null,"value")?t.type==="range"&&(t.value=r):t.removeAttribute("value"))},D=(t,e)=>{let r=e.value;t.value!==r&&(t.value=r),t.firstChild&&t.firstChild.nodeValue!==r&&(t.firstChild.nodeValue=r)},m=(t,e,r)=>{t[r]!==e[r]&&(t[r]=e[r],e[r]?t.setAttribute(r,""):t.removeAttribute(r))},a=(t,e)=>t?e?t.isSameNode&&t.isSameNode(e)?t:t.tagName!==e.tagName?e:(j(t,e),v(t,e),t):null:e,v=(t,e)=>{let r,o,i,s,u=0;for(let l=0;r=t.childNodes[l],o=e.childNodes[l-u],!(!r&&!o);l++)if(!o)t.removeChild(r),l--;else if(!r)t.appendChild(o),u++;else if(p(r,o))i=a(r,o),i!==r&&(t.replaceChild(i,r),u++);else{s=null;for(let n=l;n<t.childNodes.length;n++)if(p(t.childNodes[n],o)){s=t.childNodes[n];break}s?(i=a(s,o),i!==s&&u++,t.insertBefore(i,r)):!o.id&&!r.id?(i=a(r,o),i!==r&&(t.replaceChild(i,r),u++)):(t.insertBefore(o,r),u++)}};var h={name:"$morph",create:()=>({value:f})};var O={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},P=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var E=t=>typeof t!="string"?t:t.replaceAll(P,e=>O[e]);var q=Function.prototype.toString.call(Function).replace("Function","Promise").replace(/\(.*\)/,"()");var S=t=>t&&Object.prototype.toString.call(t)==="[object Promise]";var b={name:"morph",update:(t,e,{processExpression:r})=>{let o=e.getElement(),i=e.getModifiers(),s=l=>{if(i.decode&&typeof l=="string"&&(l=E(l)),i.outer)f(o,l);else{if(o.children.length===0)o.appendChild(document.createElement("div"));else if(o.children.length>1)for(let c=o.children.length-1;c>=1;c--)o.children[c].remove();let n=f(o.children[0],l);o.children[0].isSameNode(n)||(o.children[0].remove(),o.appendChild(n))}},u=r(t,e,e.getValue());e.setData(u),S(u)?Promise.resolve(u).then(l=>{e.getData()===u&&s(l)}):s(u)}};function C(t){let e=!1,r=()=>{t.addContexts(0,h),t.addDirectives(-1,b)},o=()=>{t.removeContexts(h),t.removeDirectives(b)};this.disable=()=>{!t.getEnabled()&&e&&(e=!1,t.removeEventListener("enabling",r),t.removeEventListener("disabling",o))},this.enable=()=>{e||(e=!0,t.addEventListener("enabling",r),t.addEventListener("disabling",o))},this.enable()}window.DoarsMorph=C;})();
//# sourceMappingURL=doars-morph.iife.min.js.map
