var d=(t,e)=>{let r=t.attributes,l=e.attributes,i=null,u=null,f=null,o=null,n=null;for(let c=l.length-1;c>=0;--c)n=l[c],o=n.name,i=n.namespaceURI,u=n.value,i?(o=n.localName||o,f=t.getAttributeNS(i,o),f!==u&&t.setAttributeNS(i,o,u)):t.hasAttribute(o)?(f=t.getAttribute(o),f!==u&&(u==="null"||u==="undefined"?t.removeAttribute(o):t.setAttribute(o,u))):t.setAttribute(o,u);for(let c=r.length-1;c>=0;--c)n=r[c],n.specified!==!1&&(o=n.name,i=n.namespaceURI,i?(o=n.localName||o,e.hasAttributeNS(i,o)||t.removeAttributeNS(i,o)):e.hasAttributeNS(null,o)||t.removeAttribute(o))};var A=t=>{let e=document.createElement("template");return e.innerHTML=t,e.content.childNodes[0]};var p=(t,e)=>t.isSameNode?t.isSameNode(e):t.tagName!==e.tagName?!1:t.type===3?t.nodeValue===e.nodeValue:!1;var S=(t,e)=>{let r=e.nodeType,l=e.nodeName;r===1&&d(t,e),(r===3||r===8)&&t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue),l==="INPUT"?j(t,e):l==="OPTION"?m(t,e,"selected"):l==="TEXTAREA"&&V(t,e)},a=(t,e,r)=>{if(typeof t!="object")throw new Error("Existing tree should be an object.");if(typeof e=="string")e=A(e);else if(typeof e!="object")throw new Error("New tree should be an object.");return r&&r.childrenOnly||e.nodeType===11?(v(t,e),t):s(t,e)},j=(t,e)=>{let r=e.value,l=t.value;m(t,e,"checked"),m(t,e,"disabled"),t.indeterminate!==e.indeterminate&&(t.indeterminate=e.indeterminate),t.type!=="file"&&(l!==r&&(t.setAttribute("value",r),t.value=r),r==="null"&&(t.value="",t.removeAttribute("value")),e.hasAttributeNS(null,"value")?t.type==="range"&&(t.value=r):t.removeAttribute("value"))},V=(t,e)=>{let r=e.value;if(t.value!==r&&(t.value=r),t.firstChild&&t.firstChild.nodeValue!==r){if(t.firstChild.nodeValue===t.placeholder&&r==="")return;t.firstChild.nodeValue=r}},m=(t,e,r)=>{t[r]!==e[r]&&(t[r]=e[r],e[r]?t.setAttribute(r,""):t.removeAttribute(r))},s=(t,e)=>t?e?t.isSameNode&&t.isSameNode(e)?t:t.tagName!==e.tagName?e:(S(t,e),v(t,e),t):null:e,v=(t,e)=>{let r,l,i,u,f=0;for(let o=0;r=t.childNodes[o],l=e.childNodes[o-f],!(!r&&!l);o++)if(!l)t.removeChild(r),o--;else if(!r)t.appendChild(l),f++;else if(p(r,l))i=s(r,l),i!==r&&(t.replaceChild(i,r),f++);else{u=null;for(let n=o;n<t.childNodes.length;n++)if(p(t.childNodes[n],l)){u=t.childNodes[n];break}u?(i=s(u,l),i!==u&&f++,t.insertBefore(i,r)):!l.id&&!r.id?(i=s(r,l),i!==r&&(t.replaceChild(i,r),f++)):(t.insertBefore(l,r),f++)}};var h={name:"$morph",create:()=>({value:a})};var y={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},O=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var E=t=>typeof t!="string"?t:t.replaceAll(O,e=>y[e]);var _=Function.prototype.toString.call(Function).replace("Function","Promise").replace(/\(.*\)/,"()");var C=t=>t&&Object.prototype.toString.call(t)==="[object Promise]";var b={name:"morph",update:(t,e,{processExpression:r})=>{let l=e.getElement(),i=e.getModifiers(),u=o=>{if(i.decode&&typeof o=="string"&&(o=E(o)),l.children.length===0)l.appendChild(document.createElement("div"));else if(l.children.length>1)for(let c=l.children.length-1;c>=1;c--)l.children[c].remove();let n=a(l.children[0],o);l.children[0].isSameNode(n)||(l.children[0].remove(),l.appendChild(n))},f=r(t,e,e.getValue());e.setData(f),C(f)?Promise.resolve(f).then(o=>{e.getData()===f&&u(o)}):u(f)}};function $(t){let e=!1,r=function(){t.addContexts(0,h),t.addDirectives(-1,b)},l=function(){t.removeContexts(h),t.removeDirectives(b)};this.disable=function(){!t.getEnabled()&&e&&(e=!1,t.removeEventListener("enabling",r),t.removeEventListener("disabling",l))},this.enable=function(){e||(e=!0,t.addEventListener("enabling",r),t.addEventListener("disabling",l))},this.enable()}export{$ as default};
//# sourceMappingURL=doars-morph.esm.min.js.map
