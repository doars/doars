(()=>{var N="interact",k="intersect";var a=Symbol("NAVIGATE");var q=e=>{let t=e.substring(0,15).toLowerCase();if(t.startsWith("<!doctype html>")||t.startsWith("<html>")){let o=document.createElement("html");return o.innerHTML=e,o}let i=document.createElement("template");return i.innerHTML=e,i.content.childNodes[0]},W=(e,t)=>{e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},H=(e,t)=>e.isSameNode&&e.isSameNode(t)?!0:e.type===3?e.nodeValue===t.nodeValue:e.tagName===t.tagName;var Q={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},Y=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var G=e=>typeof e!="string"?e:e.replaceAll(Y,t=>Q[t]);var F=(e,t)=>{let n=e.attributes,i=t.attributes,o=null,r=null,h=null,l=null,s=null;for(let f=i.length-1;f>=0;--f)s=i[f],l=s.name,o=s.namespaceURI,r=s.value,o?(l=s.localName||l,h=e.getAttributeNS(o,l),h!==r&&e.setAttributeNS(o,l,r)):e.hasAttribute(l)?(h=e.getAttribute(l),h!==r&&(r==="null"||r==="undefined"?e.removeAttribute(l):e.setAttribute(l,r))):e.setAttribute(l,r);for(let f=n.length-1;f>=0;--f)s=n[f],s.specified!==!1&&(l=s.name,o=s.namespaceURI,o?(l=s.localName||l,t.hasAttributeNS(o,l)||e.removeAttributeNS(o,l)):t.hasAttributeNS(null,l)||e.removeAttribute(l))};var Z=(e,t)=>{let n=t.nodeType,i=t.nodeName;n===1&&F(e,t),(n===3||n===8)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),i==="INPUT"?$(e,t):i==="OPTION"?w(e,t,"selected"):i==="TEXTAREA"&&x(e,t)},_=(e,t,n)=>{if(typeof e!="object")throw new Error("Existing tree should be an object.");if(typeof t=="string")t=q(t);else if(typeof t!="object")throw new Error("New tree should be an object.");return n&&n.childrenOnly||t.nodeType===11?(B(e,t),e):L(e,t)},$=(e,t)=>{let n=t.value,i=e.value;w(e,t,"checked"),w(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(e.indeterminate=t.indeterminate),e.type!=="file"&&(i!==n&&(e.setAttribute("value",n),e.value=n),n==="null"&&(e.value="",e.removeAttribute("value")),t.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=n):e.removeAttribute("value"))},x=(e,t)=>{let n=t.value;e.value!==n&&(e.value=n),e.firstChild&&e.firstChild.nodeValue!==n&&(e.firstChild.nodeValue=n)},w=(e,t,n)=>{e[n]!==t[n]&&(e[n]=t[n],t[n]?e.setAttribute(n,""):e.removeAttribute(n))},L=(e,t)=>e?t?e.isSameNode&&e.isSameNode(t)?e:e.tagName!==t.tagName?t:(Z(e,t),B(e,t),e):null:t,B=(e,t)=>{let n,i,o,r,h=0;for(let l=0;n=e.childNodes[l],i=t.childNodes[l-h],!(!n&&!i);l++)if(!i)e.removeChild(n),l--;else if(!n)e.appendChild(i),h++;else if(H(n,i))o=L(n,i),o!==n&&(e.replaceChild(o,n),h++);else{r=null;for(let s=l;s<e.childNodes.length;s++)if(H(e.childNodes[s],i)){r=e.childNodes[s];break}r?(o=L(r,i),o!==r&&h++,e.insertBefore(o,n)):!i.id&&!n.id?(o=L(n,i),o!==n&&(e.replaceChild(o,n),h++)):(e.insertBefore(i,n),h++)}};var ee="-loader",te="-target",X="Date",T="Cache-Control",re=["no-cache","must-revalidate","no-store"],ne=(e,t,n,i,o)=>{let r=e.getElement(),h=e.getDirective(),l=n.prefix+"-"+h+ee;if(!r.hasAttribute(l))return;let s=i(t,e,r.getAttribute(l));if(!s||(typeof s=="string"&&(s=r.querySelector(s)),s.tagName!=="TEMPLATE")||s.childCount>1)return;if(e[a].loaderTransitionOut)e[a].loaderTransitionOut(),e[a].loaderTransitionOut=null;else if(e[a].loaderElement)return;let f=document.importNode(s.content,!0);W(s,f),e[a].loaderElement=f=s.nextElementSibling,e[a].loaderTransitionIn=o(t,f)},M=(e,t,n)=>{if(e[a].loaderTransitionOut||!e[a].loaderElement)return;let i=e[a].loaderElement;e[a].loaderTransitionIn=n(t,i,()=>{i&&i.remove()})},K=(e,t=null)=>{if(!e.has(X)||!e.has(T))return!1;let n=new Date(e.get(X)),i=new Date;if(n>i)return!1;if(t){let l=new Date(n.getTime()+t);if(i>l)return!1}let o=e.get(T).split(","),r=0;for(let l of o)if(l.trim().startsWith("max-age=")&&(r=parseInt(l.split("=")[1].trim(),10)),l.trim().startsWith("s-maxage=")){r=parseInt(l.split("=")[1].trim(),10);break}return r<=0?!1:new Date(n.getTime()+r*1e3)>=i},y=0,P=null,z=e=>{let t={},n=()=>{if(y>0){y++;return}P=setInterval(()=>{for(let o in t)!Object.hasOwnProperty.call(t,o)||!t.headers||K(t.headers,e.cacheMaxAge)||delete t[o]},e.cacheInterval)},i=(o,r,h)=>new Promise(l=>{if(window.location.hostname!==o.hostname&&l(null),Object.hasOwnProperty.call(t,o.location)){if(t[o.location].headers&&K(t[o.location].headers)){l(t[o.location]);return}t[o.location].listeners?t[o.location].listeners.push(()=>{l(t[o.location])}):t[o.location]={listeners:[]}}else t[o.location]={listeners:[]};r("-started",{url:o}),fetch(o,Object.assign({},e.fetchOptions,{headers:Object.assign({},h,e.fetchOptions.headers)})).then(s=>{if(s.status<200||s.status>=500){r("-failed",{response:s,url:o}),l(null);return}s.headers.get("Content-Type").toLowerCase().startsWith("text/html");let C=!0;if(s.headers.has(T)){let g=s.headers.get(T).split(","),E=0;for(let d of g){let b=d.trim();if(re.indexOf(b)>=0){C=!1;break}if(b.startsWith("s-maxage=")&&(E=parseInt(b.split("=")[1].trim(),10),E<=0)){C=!1;break}if(b.startsWith("max-age=")&&E<=0&&(E=parseInt(b.split("=")[1].trim(),10),E<=0)){C=!1;break}}}s.text().then(g=>{let E={headers:s.headers,html:g},d=t[o.location].listeners;if(C?(t[o.location]=E,n()):delete t[o.location],l(E),d)for(let b of d)b()})})});return{name:"navigate",update:(o,r,{processExpression:h,transitionIn:l,transitionOut:s})=>{let f=r.getElement();if(f[a])return;let g=o.getLibrary().getOptions(),E=r.getDirective(),d=r.getModifiers(),b={};d.capture&&(b.capture=!0);let I={[g.prefix+"-request"]:E},D=(u="",p={})=>{f.dispatchEvent(new CustomEvent(g.prefix+"-"+E+u,{detail:Object.assign({attribute:r,component:o},p)}))},V=u=>{r[a].url=u;let p=new Date().toISOString();r[a].identifier=p,ne(r,o,g,h,l),i(u,D,I).then(v=>{if(!r[a].identifier||r[a].identifier!==p)return;if(!v){M(r,o,s),delete r[a].url,delete r[a].identifier;return}let m=v.html;d.decode&&(m=G(v.html));let c=null;if(d.document)c=document.documentElement;else{let O=g.prefix+"-"+E+te;f.hasAttribute(O)&&(c=h(o,r,f.getAttribute(O)),typeof c=="string"&&(c=f.querySelector(c))),c||(c=f)}if(d.morph)if(d.outer)_(c,m);else{if(c.children.length===0)c.appendChild(document.createElement("div"));else if(c.children.length>1)for(let j=c.children.length-1;j>=1;j--)c.children[j].remove();let O=_(c.children[0],m);c.children[0].isSameNode(O)||(c.children[0].remove(),c.appendChild(O))}else d.outer?c.outerHTML=m:c.innerHTML=m;let A="";e.headerTitle&&v.headers.has(e.headerTitle)&&(A=v.headers.get(e.headerTitle)),d.document&&d.history&&history.pushState({},A,u),A&&document.title!==A&&(document.title=A),M(r,o,s),delete r[a].url,delete r[a].identifier,D("-loaded",{url:u})})},U=u=>{let p=u.target.closest("a");if(!p||!p.hasAttribute("href"))return;let v=p.getAttribute("href"),m=new URL(v,window.location);window.location.hostname===m.hostname&&(r[a].url&&r[a].url.href===m.href||(u.preventDefault(),d.stop&&u.stopPropagation(),V(m)))};f.addEventListener("click",U,b);let S;d.document&&d.history&&(S=u=>{let p=new URL(u.target.location);r[a].url&&r[a].url.href===p.href||V(p)},window.addEventListener("popstate",S,{passive:!0}));let R;if(d.preload===N){let u=p=>{let v=p.target.closest("a");if(!v||!v.hasAttribute("href"))return;let m=v.getAttribute("href");i(new URL(m,window.location),D,I)};f.addEventListener("focusin",u,Object.assign({passive:!0},b)),f.addEventListener("pointerenter",u,Object.assign({passive:!0},b)),R=()=>{f.removeEventListener("focusin",r[a].preloadHandler),f.removeEventListener("pointerenter",r[a].preloadHandler)}}else if(d.preload===k){let u=new IntersectionObserver(m=>{for(let c of m)c.isIntersecting&&i(new URL(c.target.getAttribute("href"),window.location),D,I)},{root:null,rootMargin:e.intersectionMargin,threshold:e.intersectionThreshold}),p=new MutationObserver(m=>{for(let c of m)if(c.type==="attributes")c.attributeName==="href"&&c.target instanceof HTMLElement&&c.target.tagName==="A"&&(c.target.hasAttribute("href")?u.observe(c.target):u.unobserve(c.target));else if(c.type==="childList"){for(let A of c.addedNodes)A instanceof HTMLElement&&A.tagName==="A"&&A.hasAttribute("href")&&u.observe(A);for(let A of c.removedNodes)A instanceof HTMLElement&&A.tagName==="A"&&A.hasAttribute("href")&&u.unobserve(A)}});R=()=>{p.disconnect(),u.disconnect()};let v=f.querySelectorAll("a[href]");for(let m of v)u.observe(m);p.observe(f,{attributes:!0,childList:!0,subtree:!0})}r[a]={cache:t,element:f,historyHandler:S,loadHandler:U,destroyPreloader:R}},destroy:(o,r,{transitionOut:h})=>{r[a]&&(y>0&&(y--,y===0&&P&&(clearInterval(P),t={})),r[a].element.removeEventListener("click",r[a].loadHandler),r[a].historyHandler&&window.removeEventListener("popstate",r[a].historyHandler),r[a].destroyPreloader&&r[a].destroyPreloader(),M(r,o,h),delete r[a])}}};var oe=function(e,t=null){t=Object.assign({cacheInterval:60*1e3,cacheMaxAge:30*60*1e3,fetchOptions:{},headerTitle:null,intersectionMargin:"0px",intersectionThreshold:0},t);let n=!1,i,o=()=>{i=z(t),e.addDirectives(-1,i)},r=()=>{e.removeDirective(i),i=null};this.disable=()=>{!e.getEnabled()&&n&&(n=!1,e.removeEventListener("enabling",o),e.removeEventListener("disabling",r))},this.enable=()=>{n||(n=!0,e.addEventListener("enabling",o),e.addEventListener("disabling",r))},this.enable()},J=oe;window.DoarsNavigate=J;})();
//# sourceMappingURL=doars-navigate.iife.min.js.map
