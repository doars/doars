var Y=(e,r)=>{let t;switch(String.prototype.toLowerCase.call(r)){default:break;case"arraybuffer":t=e.arrayBuffer();break;case"blob":t=e.blob();break;case"formdata":t=e.formData();break;case"json":t=e.json();break;case"element":case"html":case"svg":case"text":case"xml":t=e.text();break}return t?t.then(n=>{switch(r){case"element":let s=document.createElement("template");s.innerHTML=n,n=s.content.childNodes[0];break;case"html":n=new DOMParser().parseFromString(n,"text/html");break;case"svg":n=new DOMParser().parseFromString(n,"image/svg+xml");break;case"xml":n=new DOMParser().parseFromString(n,"application/xml");break}return n}):null},Z=(e,r=null)=>{let t=e.headers.get("Content-Type");if(t){t=String.prototype.toLowerCase.call(t).split(";")[0];let s=$(t.trim());if(s)return s}let n=e.url.split(".");if(n)switch(n=n[n.length-1],n){case"htm":case"html":return"html";case"json":return"json";case"svg":return"svg";case"txt":return"text";case"xml":return"xml"}if(r){let s=r.headers.Accept;if(s){s=String.prototype.toLowerCase.call(s).split(",");for(let i of s){i=i.split(";")[0].trim();let a=$(i);if(a)return a}}}return null},$=e=>{switch(e){case"text/html":return"html";case"text/json":case"application/json":case"application/ld+json":case"application/vnd.api+json":return"json";case"image/svg+xml":return"svg";case"text/plain":return"text";case"application/xml":case"text/xml":return"xml"}},E={},j=(e,r,t)=>new Promise((n,s)=>{fetch(e,r).then(i=>{if(i.status<200||i.status>=500){let a=E[e.location];delete E[e.location],s(i);for(let o of a)o.reject(i);return}t==="auto"&&(t=Z(i,r)),t&&(i=Y(i,t)),i.then(a=>{let o={headers:i.headers,value:a},u=E[e.location];if(delete E[e.location],n(o),u)for(let c of u)c.resolve(o)}).catch(a=>{let o=E[e.location];if(delete E[e.location],s(a),o)for(let u of o)u.reject(a)})}).catch(i=>{let a=E[e.location];if(delete E[e.location],s(i),a)for(let o of a)o.reject(i)})});var L=e=>{let r=e.substring(0,15).toLowerCase();if(r.startsWith("<!doctype html>")||r.startsWith("<html>")){let n=document.createElement("html");return n.innerHTML=e,n}let t=document.createElement("template");return t.innerHTML=e,t.content.childNodes[0]},P=(e,r)=>e.isSameNode&&e.isSameNode(r)?!0:e.type===3?e.nodeValue===r.nodeValue:e.tagName===r.tagName,D=(e,r,t,n)=>{let s=r.getLibrary().getOptions(),i=t.getElement(),a=t.getDirective(),o=s.prefix+"-"+a+"-"+s.selectFromElementDirectiveName;if(!i.hasAttribute(o))return e;let u=null;if(s.selectFromElementDirectiveEvaluate){if(u=n(r,t,i.getAttribute(o)),typeof u!="string")return null}else u=i.getAttribute(o);if(u){let c=typeof e=="string";if(c&&(e=L(e)),e=e.querySelector(u),c&&e)return e.outerHTML}return e},k=(e,r)=>{let t=-1,n=null;return()=>{if(t>=0&&n){let i=n();if(i)return i}let s=null;do{if(t++,t>=e.childElementCount)return null;s=e.children[t]}while(!r(s));return s.childElementCount&&(n=k(s,r)),s}};var ee={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},te=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var q=e=>typeof e!="string"?e:e.replaceAll(te,r=>ee[r]);var x=e=>{if(typeof e=="string"&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return;let r={};for(let t of e)switch(t=t.trim(),t[0]){case"#":r.id=t.substring(1);break;case".":t=t.substring(1),r.class||(r.class=[]),r.class.includes(t)||r.class.push(t);break;case"[":let[n,s,i]=t.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);r[s]=i;break}return r};var H=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.add(n);continue}e.setAttribute(t,r[t])}},z=(e,r)=>{let t=e.attributes,n=r.attributes,s=null,i=null,a=null,o=null,u=null;for(let c=n.length-1;c>=0;--c)u=n[c],o=u.name,s=u.namespaceURI,i=u.value,s?(o=u.localName||o,a=e.getAttributeNS(s,o),a!==i&&e.setAttributeNS(s,o,i)):e.hasAttribute(o)?(a=e.getAttribute(o),a!==i&&(i==="null"||i==="undefined"?e.removeAttribute(o):e.setAttribute(o,i))):e.setAttribute(o,i);for(let c=t.length-1;c>=0;--c)u=t[c],u.specified!==!1&&(o=u.name,s=u.namespaceURI,s?(o=u.localName||o,r.hasAttributeNS(s,o)||e.removeAttributeNS(s,o)):r.hasAttributeNS(null,o)||e.removeAttribute(o))},S=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.remove(n);continue}r[t]&&e.attributes[t]!==r[t]||e.removeAttribute(t)}};var re="-transition:",W=(e,r,t,n=null)=>{if(t.nodeType!==1){n&&n();return}let s=r.prefix+re+e,i=A=>{t.dispatchEvent(new CustomEvent("transition-"+A)),t.dispatchEvent(new CustomEvent("transition-"+e+"-"+A))},a,o,u,c,g=!1,l={};return a=s,o=t.getAttribute(a),o&&(l.during=x(o),H(t,l.during)),a=s+".from",o=t.getAttribute(a),o&&(l.from=x(o),H(t,l.from)),i("start"),c=requestAnimationFrame(()=>{if(c=null,g)return;if(l.from&&(S(t,l.from),l.from=void 0),a=s+".to",o=t.getAttribute(a),o)l.to=x(o),H(t,l.to);else if(!l.during){i("end"),n&&n(),g=!0;return}let A=getComputedStyle(t),y=Number(A.transitionDuration.replace(/,.*/,"").replace("s",""))*1e3;y===0&&(y=Number(A.animationDuration.replace("s",""))*1e3),u=setTimeout(()=>{u=null,!g&&(l.during&&(S(t,l.during),l.during=void 0),l.to&&(S(t,l.to),l.to=void 0),i("end"),n&&n(),g=!0)},y)}),()=>{g&&(g=!0,l.during&&(S(t,l.during),l.during=void 0),l.from?(S(t,l.from),l.from=void 0):l.to&&(S(t,l.to),l.to=void 0),c?(cancelAnimationFrame(c),c=null):u&&(clearTimeout(u),u=null),i("end"),n&&n())}},B=(e,r,t)=>W("in",e,r,t),G=(e,r,t)=>W("out",e,r,t);var C=(e,r)=>{if(!r.indicator||r.indicator.indicatorTransitionOut||!r.indicator.indicatorElement)return;let t=e.getLibrary().getOptions(),n=r.indicator.indicatorElement;r.indicator.indicatorTransitionIn=G(t,n,()=>{n&&n.remove()})},X=(e,r,t)=>{let n=e.getLibrary().getOptions(),s=r.getElement(),i=r.getDirective(),a=n.prefix+"-"+i+"-"+n.indicatorDirectiveName;if(!s.hasAttribute(a))return;let o=null;if(n.indicatorDirectiveEvaluate?o=t(e,r,s.getAttribute(a)):o=s.getAttribute(a),!o||typeof o=="string"&&(o=s.querySelector(o),!o)||o.tagName!=="TEMPLATE"||o.childCount>1)return;if(r.indicator){if(r.indicator.indicatorTransitionOut)r.indicator.indicatorTransitionOut(),r.indicator.indicatorTransitionOut=null;else if(r.indicator.indicatorElement)return}let u=document.importNode(o.content,!0).firstElementChild;o.insertAdjacentElement("afterend",u),r.indicator={indicatorElement:u,indicatorTransitionIn:B(n,u)}};var K=e=>{if(e.tagName!=="SCRIPT"||e.hasAttribute("src"))return!1;let r=document.createElement("script");return r.innerText=e.innerText,e.parentNode.insertBefore(r,e),e.remove(),!0},V=(...e)=>{for(let r of e)if(!K(r)){let t=k(r),n=null;for(;n=t();)K(n)}};var ie=(e,r)=>{let t=r.nodeType,n=r.nodeName;t===1&&z(e,r),(t===3||t===8)&&e.nodeValue!==r.nodeValue&&(e.nodeValue=r.nodeValue),n==="INPUT"?ne(e,r):n==="OPTION"?_(e,r,"selected"):n==="TEXTAREA"&&oe(e,r)},R=(e,r,t)=>{if(typeof e!="object")throw new Error("Existing tree should be an object.");if(typeof r=="string")r=L(r);else if(typeof r!="object")throw new Error("New tree should be an object.");return t&&t.childrenOnly||r.nodeType===11?(J(e,r),e):I(e,r)},ne=(e,r)=>{let t=r.value,n=e.value;_(e,r,"checked"),_(e,r,"disabled"),e.indeterminate!==r.indeterminate&&(e.indeterminate=r.indeterminate),e.type!=="file"&&(n!==t&&(e.setAttribute("value",t),e.value=t),t==="null"&&(e.value="",e.removeAttribute("value")),r.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=t):e.removeAttribute("value"))},oe=(e,r)=>{let t=r.value;e.value!==t&&(e.value=t),e.firstChild&&e.firstChild.nodeValue!==t&&(e.firstChild.nodeValue=t)},_=(e,r,t)=>{e[t]!==r[t]&&(e[t]=r[t],r[t]?e.setAttribute(t,""):e.removeAttribute(t))},I=(e,r)=>e?r?e.isSameNode&&e.isSameNode(r)?e:e.tagName!==r.tagName?r:(ie(e,r),J(e,r),e):null:r,J=(e,r)=>{let t,n,s,i,a=0;for(let o=0;t=e.childNodes[o],n=r.childNodes[o-a],!(!t&&!n);o++)if(!n)e.removeChild(t),o--;else if(!t)e.append(n),a++;else if(P(t,n))s=I(t,n),s!==t&&(e.replaceChild(s,t),a++);else{i=null;for(let u=o;u<e.childNodes.length;u++)if(P(e.childNodes[u],n)){i=e.childNodes[u];break}i?(s=I(i,n),s!==i&&a++,e.insertBefore(s,t)):!n.id&&!t.id?(s=I(t,n),s!==t&&(e.replaceChild(s,t),a++)):(e.insertBefore(n,t),a++)}};var m=Symbol("NAVIGATE"),Q=({fetchOptions:e,intersectionMargin:r,intersectionThreshold:t,navigateDirectiveName:n})=>({name:n,update:(s,i,a)=>{let o=i.getElement();if(o[m])return;let c=s.getLibrary().getOptions(),g=i.getDirective(),l=i.getModifiers(),A={};l.capture&&(A.capture=!0);let y={[c.prefix+"-"+c.requestHeaderName]:g,Vary:c.prefix+"-"+c.requestHeaderName},w=(d="",v={})=>{o.dispatchEvent(new CustomEvent(c.prefix+"-"+g+d,{detail:Object.assign({attribute:i,component:s},v)}))},U=d=>{i[m].url=d;let v=new Date().toISOString();i[m].identifier=v,X(s,i,a),w("-started",{url:d}),j(d,Object.assign({},e,{headers:Object.assign({},e.headers,y)})).then(b=>{if(!i[m].identifier||i[m].identifier!==v)return;if(!b){C(s,i),delete i[m].url,delete i[m].identifier;return}let p=b.value;l.decode&&(p=q(b.value));let f=null;if(l.document)f=document.documentElement;else{let O=c.prefix+"-"+g+"-"+c.targetDirectiveName;o.getAttribute(O)&&(c.targetDirectiveEvaluate?f=a(s,i,o.getAttribute(O)):f=o.getAttribute(O),f&&typeof f=="string"&&(f=o.querySelector(f))),f||(f=o)}if(l.morph)if(l.outer)R(f,D(L(p),s,i,a));else{if(f.children.length===0)f.append(document.createElement("div"));else if(f.children.length>1)for(let N=f.children.length-1;N>=1;N--)f.children[N].remove();let O=R(f.children[0],D(L(p),s,i,a));f.children[0].isSameNode(O)||(f.children[0].remove(),f.append(O))}else l.outer?f.outerHTML!==p&&(f.outerHTML=D(p,s,i,a),(c.allowInlineScript||l.script)&&V(f)):f.innerHTML!==p&&(f.innerHTML=D(p,s,i,a),(c.allowInlineScript||l.script)&&V(...f.children));if(c.redirectHeaderName&&b.headers.has(c.prefix+"-"+c.titleHeaderName)){window.location.href=b.headers.get(c.prefix+"-"+c.titleHeaderName);return}let h="";c.titleHeaderName&&b.headers.has(c.prefix+"-"+c.titleHeaderName)&&(h=b.headers.get(c.prefix+"-"+c.titleHeaderName)),l.document&&l.history&&history.pushState({},h,d),h&&document.title!==h&&(document.title=h),C(s,i),delete i[m].url,delete i[m].identifier,w("-succeeded",{url:d})}).catch(()=>w("-failed",{url:d}))},F=d=>{let v=d.target.closest("a");if(!v||!v.hasAttribute("href"))return;let b=v.getAttribute("href"),p=new URL(b,window.location);window.location.hostname===p.hostname&&(i[m].url&&i[m].url.href===p.href||(d.preventDefault(),l.stop&&d.stopPropagation(),U(p)))};o.addEventListener("click",F,A);let T;l.document&&l.history&&(T=d=>{let v=new URL(d.target.location);i[m].url&&i[m].url.href===v.href||U(v)},window.addEventListener("popstate",T,{passive:!0}));let M;if(l.preload==="interact"){let d=v=>{let b=v.target.closest("a");if(!b||!b.hasAttribute("href"))return;let p=new URL(b.getAttribute("href"),window.location);w("-started",{url:p}),j(p,Object.assign({},e,{headers:Object.assign({},e.headers,y)}))};o.addEventListener("focusin",d,Object.assign({passive:!0},A)),o.addEventListener("pointerenter",d,Object.assign({passive:!0},A)),M=()=>{o.removeEventListener("focusin",i[m].preloadHandler),o.removeEventListener("pointerenter",i[m].preloadHandler)}}else if(l.preload==="intersect"){let d=new IntersectionObserver(p=>{for(let f of p)if(f.isIntersecting){let h=new URL(f.target.getAttribute("href"),window.location);w("-started",{url:h}),j(h,Object.assign({},e,{headers:Object.assign({},e.headers,y)}))}},{root:null,rootMargin:r,threshold:t}),v=new MutationObserver(p=>{for(let f of p)if(f.type==="attributes")f.attributeName==="href"&&f.target instanceof HTMLElement&&f.target.tagName==="A"&&(f.target.hasAttribute("href")?d.observe(f.target):d.unobserve(f.target));else if(f.type==="childList"){for(let h of f.addedNodes)h instanceof HTMLElement&&h.tagName==="A"&&h.hasAttribute("href")&&d.observe(h);for(let h of f.removedNodes)h instanceof HTMLElement&&h.tagName==="A"&&h.hasAttribute("href")&&d.unobserve(h)}});M=()=>{v.disconnect(),d.disconnect()};let b=o.querySelectorAll("a[href]");for(let p of b)d.observe(p);v.observe(o,{attributes:!0,childList:!0,subtree:!0})}i[m]={element:o,historyHandler:T,loadHandler:F,destroyPreloader:M}},destroy:(s,i)=>{i[m]&&(i[m].element.removeEventListener("click",i[m].loadHandler),i[m].historyHandler&&window.removeEventListener("popstate",i[m].historyHandler),i[m].destroyPreloader&&i[m].destroyPreloader(),C(s,i),delete i[m])}});var se=function(e,r=null){r=Object.assign({fetchOptions:{},intersectionMargin:"0px",intersectionThreshold:0,navigateDirectiveName:"navigate"},r);let t=!1,n=Q(r),s=()=>{e.addDirectives(-1,n)},i=()=>{e.removeDirective(n)};this.disable=()=>{!e.getEnabled()&&t&&(t=!1,e.removeEventListener("enabling",s),e.removeEventListener("disabling",i))},this.enable=()=>{t||(t=!0,e.addEventListener("enabling",s),e.addEventListener("disabling",i))},this.enable()},Ce=se;export{Ce as default};
//# sourceMappingURL=doars-navigate.esm.min.js.map
