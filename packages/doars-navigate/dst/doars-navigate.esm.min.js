var Y=(e,r)=>{let t;switch(String.prototype.toLowerCase.call(r)){default:break;case"arraybuffer":t=e.arrayBuffer();break;case"blob":t=e.blob();break;case"formdata":t=e.formData();break;case"json":t=e.json();break;case"element":case"html":case"svg":case"text":case"xml":t=e.text();break}return t?t.then(n=>{switch(r){case"element":let s=document.createElement("template");s.innerHTML=n,n=s.content.childNodes[0];break;case"html":n=new DOMParser().parseFromString(n,"text/html");break;case"svg":n=new DOMParser().parseFromString(n,"image/svg+xml");break;case"xml":n=new DOMParser().parseFromString(n,"application/xml");break}return n}):null},Z=(e,r=null)=>{let t=e.headers.get("Content-Type");if(t){t=String.prototype.toLowerCase.call(t).split(";")[0];let s=U(t.trim());if(s)return s}let n=e.url.split(".");if(n)switch(n=n[n.length-1],n){case"htm":case"html":return"html";case"json":return"json";case"svg":return"svg";case"txt":return"text";case"xml":return"xml"}if(r){let s=r.headers.Accept;if(s){s=String.prototype.toLowerCase.call(s).split(",");for(let i of s){i=i.split(";")[0].trim();let c=U(i);if(c)return c}}}return null},U=e=>{switch(e){case"text/html":return"html";case"text/json":case"application/json":case"application/ld+json":case"application/vnd.api+json":return"json";case"image/svg+xml":return"svg";case"text/plain":return"text";case"application/xml":case"text/xml":return"xml"}},E={},x=(e,r,t)=>new Promise((n,s)=>{fetch(e,r).then(i=>{if(i.status<200||i.status>=500){let c=E[e.location];delete E[e.location],s(i);for(let o of c)o.reject(i);return}t==="auto"&&(t=Z(i,r)),t&&(i=Y(i,t)),i.then(c=>{let o={headers:i.headers,value:c},u=E[e.location];if(delete E[e.location],n(o),u)for(let f of u)f.resolve(o)}).catch(c=>{let o=E[e.location];if(delete E[e.location],s(c),o)for(let u of o)u.reject(c)})}).catch(i=>{let c=E[e.location];if(delete E[e.location],s(i),c)for(let o of c)o.reject(i)})});var ee={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},te=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var $=e=>typeof e!="string"?e:e.replaceAll(te,r=>ee[r]);var q=e=>{let r=e.substring(0,15).toLowerCase();if(r.startsWith("<!doctype html>")||r.startsWith("<html>")){let s=document.createElement("html");return s.innerHTML=e,s}let n=document.createElement("template");return n.innerHTML=e,n.content.childNodes[0]},z=(e,r)=>{e.nextSibling?e.parentNode.insertBefore(r,e.nextSibling):e.parentNode.appendChild(r)};var N=(e,r)=>e.isSameNode&&e.isSameNode(r)?!0:e.type===3?e.nodeValue===r.nodeValue:e.tagName===r.tagName,M=(e,r)=>{let t=-1,n=null;return()=>{if(t>=0&&n){let i=n();if(i)return i}let s=null;do{if(t++,t>=e.childElementCount)return null;s=e.children[t]}while(!r(s));return s.childElementCount&&(n=M(s,r)),s}};var w=e=>{if(typeof e=="string"&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return;let r={};for(let t of e)switch(t=t.trim(),t[0]){case"#":r.id=t.substring(1);break;case".":t=t.substring(1),r.class||(r.class=[]),r.class.includes(t)||r.class.push(t);break;case"[":let[n,s,i]=t.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);r[s]=i;break}return r};var j=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.add(n);continue}e.setAttribute(t,r[t])}},F=(e,r)=>{let t=e.attributes,n=r.attributes,s=null,i=null,c=null,o=null,u=null;for(let f=n.length-1;f>=0;--f)u=n[f],o=u.name,s=u.namespaceURI,i=u.value,s?(o=u.localName||o,c=e.getAttributeNS(s,o),c!==i&&e.setAttributeNS(s,o,i)):e.hasAttribute(o)?(c=e.getAttribute(o),c!==i&&(i==="null"||i==="undefined"?e.removeAttribute(o):e.setAttribute(o,i))):e.setAttribute(o,i);for(let f=t.length-1;f>=0;--f)u=t[f],u.specified!==!1&&(o=u.name,s=u.namespaceURI,s?(o=u.localName||o,r.hasAttributeNS(s,o)||e.removeAttributeNS(s,o)):r.hasAttributeNS(null,o)||e.removeAttribute(o))},S=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.remove(n);continue}r[t]&&e.attributes[t]!==r[t]||e.removeAttribute(t)}};var re="-transition:",B=(e,r,t,n=null)=>{if(t.nodeType!==1){n&&n();return}let s=r.prefix+re+e,i=A=>{t.dispatchEvent(new CustomEvent("transition-"+A)),t.dispatchEvent(new CustomEvent("transition-"+e+"-"+A))},c,o,u,f,g=!1,a={};return c=s,o=t.getAttribute(c),o&&(a.during=w(o),j(t,a.during)),c=s+".from",o=t.getAttribute(c),o&&(a.from=w(o),j(t,a.from)),i("start"),f=requestAnimationFrame(()=>{if(f=null,g)return;if(a.from&&(S(t,a.from),a.from=void 0),c=s+".to",o=t.getAttribute(c),o)a.to=w(o),j(t,a.to);else if(!a.during){i("end"),n&&n(),g=!0;return}let A=getComputedStyle(t),y=Number(A.transitionDuration.replace(/,.*/,"").replace("s",""))*1e3;y===0&&(y=Number(A.animationDuration.replace("s",""))*1e3),u=setTimeout(()=>{u=null,!g&&(a.during&&(S(t,a.during),a.during=void 0),a.to&&(S(t,a.to),a.to=void 0),i("end"),n&&n(),g=!0)},y)}),()=>{g&&(g=!0,a.during&&(S(t,a.during),a.during=void 0),a.from?(S(t,a.from),a.from=void 0):a.to&&(S(t,a.to),a.to=void 0),f?(cancelAnimationFrame(f),f=null):u&&(clearTimeout(u),u=null),i("end"),n&&n())}},W=(e,r,t)=>B("in",e,r,t),G=(e,r,t)=>B("out",e,r,t);var D=(e,r)=>{if(!r.indicator||r.indicator.indicatorTransitionOut||!r.indicator.indicatorElement)return;let t=e.getLibrary().getOptions(),n=r.indicator.indicatorElement;r.indicator.indicatorTransitionIn=G(t,n,()=>{n&&n.remove()})},X=(e,r,t)=>{let n=e.getLibrary().getOptions(),s=r.getElement(),i=r.getDirective(),c=n.prefix+"-"+i+"-"+n.indicatorDirectiveName;if(!s.hasAttribute(c))return;let o=null;if(n.indicatorDirectiveEvaluate?o=t(e,r,s.getAttribute(c)):o=s.getAttribute(c),!o||typeof o=="string"&&(o=s.querySelector(o),!o)||o.tagName!=="TEMPLATE"||o.childCount>1)return;if(r.indicator){if(r.indicator.indicatorTransitionOut)r.indicator.indicatorTransitionOut(),r.indicator.indicatorTransitionOut=null;else if(r.indicator.indicatorElement)return}let u=document.importNode(o.content,!0);z(o,u),u=o.nextElementSibling,r.indicator={indicatorElement:u,indicatorTransitionIn:W(n,u)}};var K=e=>{if(e.tagName!=="SCRIPT"||e.hasAttribute("src"))return!1;let r=document.createElement("script");return r.innerText=e.innerText,e.parentNode.insertBefore(r,e),e.remove(),!0},P=(...e)=>{for(let r of e)if(!K(r)){let t=M(r),n=null;for(;n=t();)K(n)}};var ie=(e,r)=>{let t=r.nodeType,n=r.nodeName;t===1&&F(e,r),(t===3||t===8)&&e.nodeValue!==r.nodeValue&&(e.nodeValue=r.nodeValue),n==="INPUT"?ne(e,r):n==="OPTION"?k(e,r,"selected"):n==="TEXTAREA"&&oe(e,r)},V=(e,r,t)=>{if(typeof e!="object")throw new Error("Existing tree should be an object.");if(typeof r=="string")r=q(r);else if(typeof r!="object")throw new Error("New tree should be an object.");return t&&t.childrenOnly||r.nodeType===11?(J(e,r),e):C(e,r)},ne=(e,r)=>{let t=r.value,n=e.value;k(e,r,"checked"),k(e,r,"disabled"),e.indeterminate!==r.indeterminate&&(e.indeterminate=r.indeterminate),e.type!=="file"&&(n!==t&&(e.setAttribute("value",t),e.value=t),t==="null"&&(e.value="",e.removeAttribute("value")),r.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=t):e.removeAttribute("value"))},oe=(e,r)=>{let t=r.value;e.value!==t&&(e.value=t),e.firstChild&&e.firstChild.nodeValue!==t&&(e.firstChild.nodeValue=t)},k=(e,r,t)=>{e[t]!==r[t]&&(e[t]=r[t],r[t]?e.setAttribute(t,""):e.removeAttribute(t))},C=(e,r)=>e?r?e.isSameNode&&e.isSameNode(r)?e:e.tagName!==r.tagName?r:(ie(e,r),J(e,r),e):null:r,J=(e,r)=>{let t,n,s,i,c=0;for(let o=0;t=e.childNodes[o],n=r.childNodes[o-c],!(!t&&!n);o++)if(!n)e.removeChild(t),o--;else if(!t)e.appendChild(n),c++;else if(N(t,n))s=C(t,n),s!==t&&(e.replaceChild(s,t),c++);else{i=null;for(let u=o;u<e.childNodes.length;u++)if(N(e.childNodes[u],n)){i=e.childNodes[u];break}i?(s=C(i,n),s!==i&&c++,e.insertBefore(s,t)):!n.id&&!t.id?(s=C(t,n),s!==t&&(e.replaceChild(s,t),c++)):(e.insertBefore(n,t),c++)}};var m=Symbol("NAVIGATE"),Q=({fetchOptions:e,intersectionMargin:r,intersectionThreshold:t,navigateDirectiveName:n})=>({name:n,update:(s,i,c)=>{let o=i.getElement();if(o[m])return;let f=s.getLibrary().getOptions(),g=i.getDirective(),a=i.getModifiers(),A={};a.capture&&(A.capture=!0);let y={[f.prefix+"-"+f.requestHeaderName]:g,Vary:f.prefix+"-"+f.requestHeaderName},L=(d="",v={})=>{o.dispatchEvent(new CustomEvent(f.prefix+"-"+g+d,{detail:Object.assign({attribute:i,component:s},v)}))},_=d=>{i[m].url=d;let v=new Date().toISOString();i[m].identifier=v,X(s,i,c),L("-started",{url:d}),x(d,Object.assign({},e,{headers:Object.assign({},e.headers,y)})).then(b=>{if(!i[m].identifier||i[m].identifier!==v)return;if(!b){D(s,i),delete i[m].url,delete i[m].identifier;return}let p=b.value;a.decode&&(p=$(b.value));let l=null;if(a.document)l=document.documentElement;else{let O=f.prefix+"-"+g+"-"+f.targetDirectiveName;o.getAttribute(O)&&(f.targetDirectiveEvaluate?l=c(s,i,o.getAttribute(O)):l=o.getAttribute(O),l&&typeof l=="string"&&(l=o.querySelector(l))),l||(l=o)}if(a.morph)if(a.outer)V(l,p);else{if(l.children.length===0)l.appendChild(document.createElement("div"));else if(l.children.length>1)for(let T=l.children.length-1;T>=1;T--)l.children[T].remove();let O=V(l.children[0],p);l.children[0].isSameNode(O)||(l.children[0].remove(),l.appendChild(O))}else a.outer?l.outerHTML!==p&&(l.outerHTML=p,(f.allowInlineScript||a.script)&&P(l)):l.innerHTML!==p&&(l.innerHTML=p,(f.allowInlineScript||a.script)&&P(...l.children));if(f.redirectHeaderName&&b.headers.has(f.prefix+"-"+f.titleHeaderName)){window.location.href=b.headers.get(f.prefix+"-"+f.titleHeaderName);return}let h="";f.titleHeaderName&&b.headers.has(f.prefix+"-"+f.titleHeaderName)&&(h=b.headers.get(f.prefix+"-"+f.titleHeaderName)),a.document&&a.history&&history.pushState({},h,d),h&&document.title!==h&&(document.title=h),D(s,i),delete i[m].url,delete i[m].identifier,L("-succeeded",{url:d})}).catch(()=>L("-failed",{url:d}))},R=d=>{let v=d.target.closest("a");if(!v||!v.hasAttribute("href"))return;let b=v.getAttribute("href"),p=new URL(b,window.location);window.location.hostname===p.hostname&&(i[m].url&&i[m].url.href===p.href||(d.preventDefault(),a.stop&&d.stopPropagation(),_(p)))};o.addEventListener("click",R,A);let H;a.document&&a.history&&(H=d=>{let v=new URL(d.target.location);i[m].url&&i[m].url.href===v.href||_(v)},window.addEventListener("popstate",H,{passive:!0}));let I;if(a.preload==="interact"){let d=v=>{let b=v.target.closest("a");if(!b||!b.hasAttribute("href"))return;let p=new URL(b.getAttribute("href"),window.location);L("-started",{url:p}),x(p,Object.assign({},e,{headers:Object.assign({},e.headers,y)}))};o.addEventListener("focusin",d,Object.assign({passive:!0},A)),o.addEventListener("pointerenter",d,Object.assign({passive:!0},A)),I=()=>{o.removeEventListener("focusin",i[m].preloadHandler),o.removeEventListener("pointerenter",i[m].preloadHandler)}}else if(a.preload==="intersect"){let d=new IntersectionObserver(p=>{for(let l of p)if(l.isIntersecting){let h=new URL(l.target.getAttribute("href"),window.location);L("-started",{url:h}),x(h,Object.assign({},e,{headers:Object.assign({},e.headers,y)}))}},{root:null,rootMargin:r,threshold:t}),v=new MutationObserver(p=>{for(let l of p)if(l.type==="attributes")l.attributeName==="href"&&l.target instanceof HTMLElement&&l.target.tagName==="A"&&(l.target.hasAttribute("href")?d.observe(l.target):d.unobserve(l.target));else if(l.type==="childList"){for(let h of l.addedNodes)h instanceof HTMLElement&&h.tagName==="A"&&h.hasAttribute("href")&&d.observe(h);for(let h of l.removedNodes)h instanceof HTMLElement&&h.tagName==="A"&&h.hasAttribute("href")&&d.unobserve(h)}});I=()=>{v.disconnect(),d.disconnect()};let b=o.querySelectorAll("a[href]");for(let p of b)d.observe(p);v.observe(o,{attributes:!0,childList:!0,subtree:!0})}i[m]={element:o,historyHandler:H,loadHandler:R,destroyPreloader:I}},destroy:(s,i)=>{i[m]&&(i[m].element.removeEventListener("click",i[m].loadHandler),i[m].historyHandler&&window.removeEventListener("popstate",i[m].historyHandler),i[m].destroyPreloader&&i[m].destroyPreloader(),D(s,i),delete i[m])}});var se=function(e,r=null){r=Object.assign({fetchOptions:{},intersectionMargin:"0px",intersectionThreshold:0,navigateDirectiveName:"navigate"},r);let t=!1,n=Q(r),s=()=>{e.addDirectives(-1,n)},i=()=>{e.removeDirective(n)};this.disable=()=>{!e.getEnabled()&&t&&(t=!1,e.removeEventListener("enabling",s),e.removeEventListener("disabling",i))},this.enable=()=>{t||(t=!0,e.addEventListener("enabling",s),e.addEventListener("disabling",i))},this.enable()},He=se;export{He as default};
//# sourceMappingURL=doars-navigate.esm.min.js.map
