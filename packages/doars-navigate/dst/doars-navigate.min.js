var V="interact",U="intersect";var s=Symbol("NAVIGATE");var L=e=>{let t=e.substring(0,15).toLowerCase();if(t.startsWith("<!doctype html>")||t.startsWith("<html>")){let o=document.createElement("html");return o.innerHTML=e,o}let l=document.createElement("template");return l.innerHTML=e,l.content.childNodes[0]},k=(e,t)=>{e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},R=(e,t)=>e.isSameNode&&e.isSameNode(t)?!0:e.type===3?e.nodeValue===t.nodeValue:e.tagName===t.tagName;var K={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},z=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var N=e=>typeof e!="string"?e:e.replaceAll(z,t=>K[t]);var W=(e,t)=>{let n=e.attributes,l=t.attributes,o=null,r=null,f=null,i=null,c=null;for(let a=l.length-1;a>=0;--a)c=l[a],i=c.name,o=c.namespaceURI,r=c.value,o?(i=c.localName||i,f=e.getAttributeNS(o,i),f!==r&&e.setAttributeNS(o,i,r)):e.hasAttribute(i)?(f=e.getAttribute(i),f!==r&&(r==="null"||r==="undefined"?e.removeAttribute(i):e.setAttribute(i,r))):e.setAttribute(i,r);for(let a=n.length-1;a>=0;--a)c=n[a],c.specified!==!1&&(i=c.name,o=c.namespaceURI,o?(i=c.localName||i,t.hasAttributeNS(o,i)||e.removeAttributeNS(o,i)):t.hasAttributeNS(null,i)||e.removeAttribute(i))};var J=(e,t)=>{let n=t.nodeType,l=t.nodeName;n===1&&W(e,t),(n===3||n===8)&&e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),l==="INPUT"?Q(e,t):l==="OPTION"?j(e,t,"selected"):l==="TEXTAREA"&&Y(e,t)},q=(e,t,n)=>{if(typeof e!="object")throw new Error("Existing tree should be an object.");if(typeof t=="string")t=L(t);else if(typeof t!="object")throw new Error("New tree should be an object.");return n&&n.childrenOnly||t.nodeType===11?(G(e,t),e):D(e,t)},Q=(e,t)=>{let n=t.value,l=e.value;j(e,t,"checked"),j(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(e.indeterminate=t.indeterminate),e.type!=="file"&&(l!==n&&(e.setAttribute("value",n),e.value=n),n==="null"&&(e.value="",e.removeAttribute("value")),t.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=n):e.removeAttribute("value"))},Y=(e,t)=>{let n=t.value;e.value!==n&&(e.value=n),e.firstChild&&e.firstChild.nodeValue!==n&&(e.firstChild.nodeValue=n)},j=(e,t,n)=>{e[n]!==t[n]&&(e[n]=t[n],t[n]?e.setAttribute(n,""):e.removeAttribute(n))},D=(e,t)=>e?t?e.isSameNode&&e.isSameNode(t)?e:e.tagName!==t.tagName?t:(J(e,t),G(e,t),e):null:t,G=(e,t)=>{let n,l,o,r,f=0;for(let i=0;n=e.childNodes[i],l=t.childNodes[i-f],!(!n&&!l);i++)if(!l)e.removeChild(n),i--;else if(!n)e.appendChild(l),f++;else if(R(n,l))o=D(n,l),o!==n&&(e.replaceChild(o,n),f++);else{r=null;for(let c=i;c<e.childNodes.length;c++)if(R(e.childNodes[c],l)){r=e.childNodes[c];break}r?(o=D(r,l),o!==r&&f++,e.insertBefore(o,n)):!l.id&&!n.id?(o=D(n,l),o!==n&&(e.replaceChild(o,n),f++)):(e.insertBefore(l,n),f++)}};var Z="navigate",$="-loader",x="-target",F="Date",I="Cache-Control",ee=["no-cache","must-revalidate","no-store"],te=(e,t,n,l,o)=>{let r=e.getElement(),f=e.getDirective(),i=n.prefix+"-"+f+$;if(!r.hasAttribute(i))return;let c=l(t,e,r.getAttribute(i));if(!c||(typeof c=="string"&&(c=r.querySelector(c)),c.tagName!=="TEMPLATE")||c.childCount>1)return;if(e[s].loaderTransitionOut)e[s].loaderTransitionOut(),e[s].loaderTransitionOut=null;else if(e[s].loaderElement)return;let a=document.importNode(c.content,!0);k(c,a),e[s].loaderElement=a=c.nextElementSibling,e[s].loaderTransitionIn=o(t,a)},H=(e,t,n)=>{if(e[s].loaderTransitionOut||!e[s].loaderElement)return;let l=e[s].loaderElement;e[s].loaderTransitionIn=n(t,l,()=>{l&&l.remove()})},B=(e,t=null)=>{if(!e.has(F)||!e.has(I))return!1;let n=new Date(e.get(F)),l=new Date;if(n>l)return!1;if(t){let i=new Date(n.getTime()+t);if(l>i)return!1}let o=e.get(I).split(","),r=0;for(let i of o)if(i.trim().startsWith("max-age=")&&(r=parseInt(i.split("=")[1].trim(),10)),i.trim().startsWith("s-maxage=")){r=parseInt(i.split("=")[1].trim(),10);break}return r<=0?!1:new Date(n.getTime()+r*1e3)>=l},C=0,M=null,X=e=>{let t={},n=()=>{if(C>0){C++;return}M=setInterval(()=>{for(let o in t)!Object.hasOwnProperty.call(t,o)||!t.headers||B(t.headers,e.cacheMaxAge)||delete t[o]},e.cacheInterval)},l=(o,r)=>new Promise(f=>{if(window.location.hostname!==o.hostname&&f(null),Object.hasOwnProperty.call(t,o.location)){if(t[o.location].headers&&B(t[o.location].headers)){f(t[o.location]);return}t[o.location].listeners?t[o.location].listeners.push(()=>{f(t[o.location])}):t[o.location]={listeners:[]}}else t[o.location]={listeners:[]};r("-started",{url:o}),fetch(o,e.defaultInit).then(i=>{if(i.status<200||i.status>=300){r("-failed",{response:i,url:o}),f(null);return}i.headers.get("Content-Type").toLowerCase().startsWith("text/html");let a=!0;if(i.headers.has(I)){let g=i.headers.get(I).split(","),E=0;for(let b of g){let d=b.trim();if(ee.indexOf(d)>=0){a=!1;break}if(d.startsWith("s-maxage=")&&(E=parseInt(d.split("=")[1].trim(),10),E<=0)){a=!1;break}if(d.startsWith("max-age=")&&E<=0&&(E=parseInt(d.split("=")[1].trim(),10),E<=0)){a=!1;break}}}i.text().then(g=>{let E={headers:i.headers,html:g},b=t[o.location].listeners;if(a?(t[o.location]=E,n()):delete t[o.location],f(E),b)for(let d of b)d()})})});return{name:Z,update:(o,r,{processExpression:f,transitionIn:i,transitionOut:c})=>{let a=r.getElement();if(a[s])return;let E=o.getLibrary().getOptions(),b=r.getDirective(),d=r.getModifiers(),y={};d.capture&&(y.capture=!0);let O=(h="",p={})=>{a.dispatchEvent(new CustomEvent(E.prefix+"-"+b+h,{detail:Object.assign({attribute:r,component:o},p)}))},_=h=>{r[s].url=h;let p=new Date().toISOString();r[s].identifier=p,te(r,o,E,f,i),l(h,O).then(v=>{if(!r[s].identifier||r[s].identifier!==p)return;if(!v){H(r,o,c),delete r[s].url,delete r[s].identifier;return}let m=v.html;d.decode&&(m=N(v.html));let u=null;if(d.document)u=document.documentElement;else{let w=E.prefix+"-"+b+x;a.hasAttribute(w)&&(u=f(o,r,a.getAttribute(w)),typeof u=="string"&&(u=a.querySelector(u))),u||(u=a)}d.morph?(m=L(m),q(u,m,{childrenOnly:!d.outer})):d.outer?u.outerHTML=m:u.innerHTML=m;let A="";e.headerTitle&&v.headers.has(e.headerTitle)&&(A=v.headers.get(e.headerTitle)),d.document&&d.history&&history.pushState({},A,h),A&&document.title!==A&&(document.title=A),H(r,o,c),delete r[s].url,delete r[s].identifier,O("-loaded",{url:h})})},P=h=>{let p=h.target.closest("a");if(!p||!p.hasAttribute("href"))return;let v=p.getAttribute("href"),m=new URL(v,window.location);window.location.hostname===m.hostname&&(r[s].url&&r[s].url.href===m.href||(h.preventDefault(),d.stop&&h.stopPropagation(),_(m)))};a.addEventListener("click",P,y);let T;d.document&&d.history&&(T=h=>{let p=new URL(h.target.location);r[s].url&&r[s].url.href===p.href||_(p)},window.addEventListener("popstate",T,{passive:!0}));let S;if(d.preload===V){let h=p=>{let v=p.target.closest("a");if(!v||!v.hasAttribute("href"))return;let m=v.getAttribute("href");l(new URL(m,window.location),O)};a.addEventListener("focusin",h,Object.assign({passive:!0},y)),a.addEventListener("pointerenter",h,Object.assign({passive:!0},y)),S=()=>{a.removeEventListener("focusin",r[s].preloadHandler),a.removeEventListener("pointerenter",r[s].preloadHandler)}}else if(d.preload===U){let h=new IntersectionObserver(m=>{for(let u of m)u.isIntersecting&&l(new URL(u.target.getAttribute("href"),window.location),O)},{root:null,rootMargin:e.intersectionMargin,threshold:e.intersectionThreshold}),p=new MutationObserver(m=>{for(let u of m)if(u.type==="attributes")u.attributeName==="href"&&u.target instanceof HTMLElement&&u.target.tagName==="A"&&(u.target.hasAttribute("href")?h.observe(u.target):h.unobserve(u.target));else if(u.type==="childList"){for(let A of u.addedNodes)A instanceof HTMLElement&&A.tagName==="A"&&A.hasAttribute("href")&&h.observe(A);for(let A of u.removedNodes)A instanceof HTMLElement&&A.tagName==="A"&&A.hasAttribute("href")&&h.unobserve(A)}});S=()=>{p.disconnect(),h.disconnect()};let v=a.querySelectorAll("a[href]");for(let m of v)h.observe(m);p.observe(a,{attributes:!0,childList:!0,subtree:!0})}r[s]={cache:t,historyHandler:T,loadHandler:P,destroyPreloader:S}},destroy:(o,r,{transitionOut:f})=>{r[s]&&(C>0&&(C--,C===0&&M&&(clearInterval(M),t={})),r[s].target.removeEventListener("click",r[s].loadHandler),r[s].historyHandler&&window.removeEventListener("popstate",r[s].historyHandler),r[s].destroyPreloader&&r[s].destroyPreloader(),H(r,o,f),delete r[s])}}};var re=function(e,t=null){t=Object.assign({cacheInterval:60*1e3,cacheMaxAge:30*60*1e3,fetchOptions:{},headerTitle:null,intersectionMargin:"0px",intersectionThreshold:0},t);let n=!1,l,o=()=>{l=X(t),e.addDirectives(-1,l)},r=()=>{e.removeDirective(l),l=null};this.disable=()=>{!e.getEnabled()&&n&&(n=!1,e.removeEventListener("enabling",o),e.removeEventListener("disabling",r))},this.enable=()=>{n||(n=!0,e.addEventListener("enabling",o),e.addEventListener("disabling",r))},this.enable()},Ee=re;export{Ee as default};
//# sourceMappingURL=doars-navigate.min.js.map
