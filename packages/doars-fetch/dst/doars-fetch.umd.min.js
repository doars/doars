var global,factory;global=this,factory=function(){const e=(a,...r)=>{if(!r.length)return a;const n=r.shift();if(t(a)&&t(n))for(const r in n)t(n[r])?(a[r]||Object.assign(a,{[r]:{}}),e(a[r],n[r])):Array.isArray(n[r])?a[r]=n[r].map((a=>t(a)?e({},a):a)):Object.assign(a,{[r]:n[r]});return e(a,...r)},t=e=>e&&"object"==typeof e&&!Array.isArray(e);return class{constructor(t,a=null){const r=(t=>({name:"$fetch",create:()=>({value:(a,r=null)=>{t.defaultInit&&(r=e(t.defaultInit,r));let n=r.returnType??null;return delete r.returnType,fetch(a,r).then((e=>("auto"===n&&e.headers.get("content-type")&&(n=(e=>{switch(String.prototype.toLowerCase(e.headers.get("content-type"))){case"text/html":return"html";case"application/json":case"application/ld+json":case"application/vnd.api+json":return"json";case"image/svg+xml":return"svg";case"text/plain":return"text";case"application/xml":case"text/xml":return"xml"}return null})(e)),n&&(e=((e,t)=>{let a;switch(String.prototype.toLowerCase.call(t)){default:break;case"arraybuffer":a=e.arrayBuffer();break;case"blob":a=e.blob();break;case"formdata":a=e.formData();break;case"json":a=e.json();break;case"element":case"html":case"svg":case"text":case"xml":a=e.text()}return a?a.then((e=>{switch(t){case"element":const t=document.createElement("template");t.innerHTML=e,e=t.content.childNodes[0];break;case"html":e=(new DOMParser).parseFromString(e,"text/html");break;case"svg":e=(new DOMParser).parseFromString(e,"image/svg+xml");break;case"xml":e=(new DOMParser).parseFromString(e,"application/xml")}return e})):null})(e,n)),e)))}})}))(a=Object.assign({defaultInit:{}},a));t.addEventListener("enabling",(()=>{t.addContexts(0,r)})),t.addEventListener("disabling",(()=>{t.removeContexts(r)}))}}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global="undefined"!=typeof globalThis?globalThis:global||self).DoarsFetch=factory();
