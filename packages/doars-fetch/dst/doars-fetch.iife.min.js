(()=>{var ge=(e,r)=>{let t;switch(String.prototype.toLowerCase.call(r)){default:break;case"arraybuffer":t=e.arrayBuffer();break;case"blob":t=e.blob();break;case"formdata":t=e.formData();break;case"json":t=e.json();break;case"element":case"html":case"svg":case"text":case"xml":t=e.text();break}return t?t.then(n=>{switch(r){case"element":let s=document.createElement("template");s.innerHTML=n,n=s.content.childNodes[0];break;case"html":n=new DOMParser().parseFromString(n,"text/html");break;case"svg":n=new DOMParser().parseFromString(n,"image/svg+xml");break;case"xml":n=new DOMParser().parseFromString(n,"application/xml");break}return n}):null},be=(e,r=null)=>{let t=e.headers.get("Content-Type");if(t){t=String.prototype.toLowerCase.call(t).split(";")[0];let s=Q(t.trim());if(s)return s}let n=e.url.split(".");if(n)switch(n=n[n.length-1],n){case"htm":case"html":return"html";case"json":return"json";case"svg":return"svg";case"txt":return"text";case"xml":return"xml"}if(r){let s=r.headers.Accept;if(s){s=String.prototype.toLowerCase.call(s).split(",");for(let o of s){o=o.split(";")[0].trim();let a=Q(o);if(a)return a}}}return null},Q=e=>{switch(e){case"text/html":return"html";case"text/json":case"application/json":case"application/ld+json":case"application/vnd.api+json":return"json";case"image/svg+xml":return"svg";case"text/plain":return"text";case"application/xml":case"text/xml":return"xml"}},w={},R=(e,r,t="auto")=>new Promise((n,s)=>{fetch(e,r).then(o=>{if(o.status<200||o.status>=500){let i=w[e.location];delete w[e.location],s(o);for(let l of i)l.reject(o);return}let a=o.headers;t==="auto"&&(t=be(o,r)),t&&(o=ge(o,t)),o.then(i=>{let l=w[e.location];delete w[e.location];let b={headers:a,value:i};if(n(b),l)for(let m of l)m.resolve(b)}).catch(i=>{let l=w[e.location];if(delete w[e.location],s(i),l)for(let b of l)b.reject(i)})}).catch(o=>{let a=w[e.location];if(delete w[e.location],s(o),a)for(let i of a)i.reject(o)})});var P=(e,...r)=>{if(!r.length)return e;let t=r.shift();if(M(e)&&M(t))for(let n in t)M(t[n])?(e[n]||Object.assign(e,{[n]:{}}),P(e[n],t[n])):Array.isArray(t[n])?e[n]=t[n].map(s=>M(s)?P({},s):s):Object.assign(e,{[n]:t[n]});return P(e,...r)};var M=e=>e&&typeof e=="object"&&!Array.isArray(e);var Z=({fetchContextName:e,fetchOptions:r})=>({name:e,create:()=>({value:(t,n=null)=>{r&&(n=P({},r,n));let s=n.returnType?n.returnType:null;return delete n.returnType,R(t,n,s).then(o=>{if(o&&o.value)return o.value})}})});var A=e=>{let r=e.substring(0,15).toLowerCase();if(r.startsWith("<!doctype html>")||r.startsWith("<html>")){let n=document.createElement("html");return n.innerHTML=e,n}let t=document.createElement("template");return t.innerHTML=e,t.content.childNodes[0]},W=(e,r)=>e.isSameNode&&e.isSameNode(r)?!0:e.type===3?e.nodeValue===r.nodeValue:e.tagName===r.tagName,T=(e,r,t,n)=>{let s=r.getLibrary().getOptions(),o=t.getElement(),a=t.getDirective(),i=s.prefix+"-"+a+"-"+s.selectFromElementDirectiveName;if(!o.hasAttribute(i))return e;let l=null;if(s.selectFromElementDirectiveEvaluate){if(l=n(r,t,o.getAttribute(i)),typeof l!="string")return null}else l=o.getAttribute(i);if(l){let b=typeof e=="string";if(b&&(e=A(e)),e=e.querySelector(l),b&&e)return e.outerHTML}return e},X=(e,r)=>{let t=-1,n=null;return()=>{if(t>=0&&n){let o=n();if(o)return o}let s=null;do{if(t++,t>=e.childElementCount)return null;s=e.children[t]}while(!r(s));return s.childElementCount&&(n=X(s,r)),s}};var ve={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},ye=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var ee=e=>typeof e!="string"?e:e.replaceAll(ye,r=>ve[r]);var _=e=>{if(typeof e=="string"&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return;let r={};for(let t of e)switch(t=t.trim(),t[0]){case"#":r.id=t.substring(1);break;case".":t=t.substring(1),r.class||(r.class=[]),r.class.includes(t)||r.class.push(t);break;case"[":let[n,s,o]=t.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);r[s]=o;break}return r};var V=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.add(n);continue}e.setAttribute(t,r[t])}},te=(e,r)=>{let t=e.attributes,n=r.attributes,s=null,o=null,a=null,i=null,l=null;for(let b=n.length-1;b>=0;--b)l=n[b],i=l.name,s=l.namespaceURI,o=l.value,s?(i=l.localName||i,a=e.getAttributeNS(s,i),a!==o&&e.setAttributeNS(s,i,o)):e.hasAttribute(i)?(a=e.getAttribute(i),a!==o&&(o==="null"||o==="undefined"?e.removeAttribute(i):e.setAttribute(i,o))):e.setAttribute(i,o);for(let b=t.length-1;b>=0;--b)l=t[b],l.specified!==!1&&(i=l.name,s=l.namespaceURI,s?(i=l.localName||i,r.hasAttributeNS(s,i)||e.removeAttributeNS(s,i)):r.hasAttributeNS(null,i)||e.removeAttribute(i))},D=(e,r)=>{for(let t in r){if(t==="class"){for(let n of r.class)e.classList.remove(n);continue}r[t]&&e.attributes[t]!==r[t]||e.removeAttribute(t)}};var Ee="-transition:",re=(e,r,t,n=null)=>{if(t.nodeType!==1){n&&n();return}let s=r.prefix+Ee+e,o=S=>{t.dispatchEvent(new CustomEvent("transition-"+S)),t.dispatchEvent(new CustomEvent("transition-"+e+"-"+S))},a,i,l,b,m=!1,f={};return a=s,i=t.getAttribute(a),i&&(f.during=_(i),V(t,f.during)),a=s+".from",i=t.getAttribute(a),i&&(f.from=_(i),V(t,f.from)),o("start"),b=requestAnimationFrame(()=>{if(b=null,m)return;if(f.from&&(D(t,f.from),f.from=void 0),a=s+".to",i=t.getAttribute(a),i)f.to=_(i),V(t,f.to);else if(!f.during){o("end"),n&&n(),m=!0;return}let S=getComputedStyle(t),c=Number(S.transitionDuration.replace(/,.*/,"").replace("s",""))*1e3;c===0&&(c=Number(S.animationDuration.replace("s",""))*1e3),l=setTimeout(()=>{l=null,!m&&(f.during&&(D(t,f.during),f.during=void 0),f.to&&(D(t,f.to),f.to=void 0),o("end"),n&&n(),m=!0)},c)}),()=>{m&&(m=!0,f.during&&(D(t,f.during),f.during=void 0),f.from?(D(t,f.from),f.from=void 0):f.to&&(D(t,f.to),f.to=void 0),b?(cancelAnimationFrame(b),b=null):l&&(clearTimeout(l),l=null),o("end"),n&&n())}},ie=(e,r,t)=>re("in",e,r,t),ne=(e,r,t)=>re("out",e,r,t);var z=(e,r)=>{if(!r.indicator||r.indicator.indicatorTransitionOut||!r.indicator.indicatorElement)return;let t=e.getLibrary().getOptions(),n=r.indicator.indicatorElement;r.indicator.indicatorTransitionIn=ne(t,n,()=>{n&&n.remove()})},oe=(e,r,t)=>{let n=e.getLibrary().getOptions(),s=r.getElement(),o=r.getDirective(),a=n.prefix+"-"+o+"-"+n.indicatorDirectiveName;if(!s.hasAttribute(a))return;let i=null;if(n.indicatorDirectiveEvaluate?i=t(e,r,s.getAttribute(a)):i=s.getAttribute(a),!i||typeof i=="string"&&(i=s.querySelector(i),!i)||i.tagName!=="TEMPLATE"||i.childCount>1)return;if(r.indicator){if(r.indicator.indicatorTransitionOut)r.indicator.indicatorTransitionOut(),r.indicator.indicatorTransitionOut=null;else if(r.indicator.indicatorElement)return}let l=document.importNode(i.content,!0).firstElementChild;i.insertAdjacentElement("afterend",l),r.indicator={indicatorElement:l,indicatorTransitionIn:ie(n,l)}};var Ae=(e,r)=>{let t=r.nodeType,n=r.nodeName;t===1&&te(e,r),(t===3||t===8)&&e.nodeValue!==r.nodeValue&&(e.nodeValue=r.nodeValue),n==="INPUT"?Se(e,r):n==="OPTION"?G(e,r,"selected"):n==="TEXTAREA"&&Oe(e,r)},Y=(e,r,t)=>{if(typeof e!="object")throw new Error("Existing tree should be an object.");if(typeof r=="string")r=A(r);else if(typeof r!="object")throw new Error("New tree should be an object.");return t&&t.childrenOnly||r.nodeType===11?(se(e,r),e):$(e,r)},Se=(e,r)=>{let t=r.value,n=e.value;G(e,r,"checked"),G(e,r,"disabled"),e.indeterminate!==r.indeterminate&&(e.indeterminate=r.indeterminate),e.type!=="file"&&(n!==t&&(e.setAttribute("value",t),e.value=t),t==="null"&&(e.value="",e.removeAttribute("value")),r.hasAttributeNS(null,"value")?e.type==="range"&&(e.value=t):e.removeAttribute("value"))},Oe=(e,r)=>{let t=r.value;e.value!==t&&(e.value=t),e.firstChild&&e.firstChild.nodeValue!==t&&(e.firstChild.nodeValue=t)},G=(e,r,t)=>{e[t]!==r[t]&&(e[t]=r[t],r[t]?e.setAttribute(t,""):e.removeAttribute(t))},$=(e,r)=>e?r?e.isSameNode&&e.isSameNode(r)?e:e.tagName!==r.tagName?r:(Ae(e,r),se(e,r),e):null:r,se=(e,r)=>{let t,n,s,o,a=0;for(let i=0;t=e.childNodes[i],n=r.childNodes[i-a],!(!t&&!n);i++)if(!n)e.removeChild(t),i--;else if(!t)e.append(n),a++;else if(W(t,n))s=$(t,n),s!==t&&(e.replaceChild(s,t),a++);else{o=null;for(let l=i;l<e.childNodes.length;l++)if(W(e.childNodes[l],n)){o=e.childNodes[l];break}o?(s=$(o,n),s!==o&&a++,e.insertBefore(s,t)):!n.id&&!t.id?(s=$(t,n),s!==t&&(e.replaceChild(s,t),a++)):(e.insertBefore(n,t),a++)}};var Ve=Function.prototype.toString.call(Function).replace("Function","Promise").replace(/\(.*\)/,"()");var ae=e=>e&&Object.prototype.toString.call(e)==="[object Promise]";var le=e=>{if(e.tagName!=="SCRIPT"||e.hasAttribute("src"))return!1;let r=document.createElement("script");return r.innerText=e.innerText,e.parentNode.insertBefore(r,e),e.remove(),!0},L=(...e)=>{for(let r of e)if(!le(r)){let t=X(r),n=null;for(;n=t();)le(n)}};var ce=e=>{let r=document.createElement("xml");return r.append(...e.map((n,s)=>{let o=document.createElement(s);return o.textContent=n,o})),new XMLSerializer().serializeToString(r)};var u=Symbol("FETCH"),x={NONE:0,BUFFER:1,DEBOUNCE:2,THROTTLE:5,DELAY:6},fe=({fetchOptions:e,fetchDirectiveEvaluate:r,fetchDirectiveName:t,intersectionEvent:n,loadedEvent:s},o)=>({name:t,update:(a,i,l)=>{let m=a.getLibrary().getOptions(),f=i.getElement(),S=i.getDirective(),c=i.getModifiers(),U=i.getValue(),j=f.tagName==="FORM",me=f.tagName==="BUTTON",de=f.tagName==="INPUT"||f.tagName==="SELECT";if(i[u]){if(i[u].value===U)return;i[u].target.removeEventListener(i[u].eventName,i[u].handler),i[u].timeout&&clearTimeout(i[u].timeout),delete i[u]}let pe=c.encoding?c.encoding.toLowerCase():null,K=c.method?c.method.toUpperCase():null,F=c.position?c.position.toLowerCase():null,I={};c.capture&&(I.capture=!0),c.once&&(I.once=!0),c.passive&&!c.prevent&&(I.passive=!0);let N=x.NONE;c.buffer?(N=x.BUFFER,c.buffer===!0&&(c.buffer=5)):c.debounce?(N=x.DEBOUNCE,c.debounce===!0&&(c.debounce=500)):c.throttle?(N=x.THROTTLE,c.throttle===!0&&(c.throttle=500)):c.delay&&(N=x.DELAY,c.delay===!0&&(c.delay=500)),c.poll===!0&&(c.poll=6e4);let E="click";c.on?E=c.on:j?E="submit":de?E="change":c.poll&&(E=s);let he={[m.prefix+"-"+m.requestHeaderName]:S,Vary:m.prefix+"-"+m.requestHeaderName},H=(h="",g={})=>{f.dispatchEvent(new CustomEvent(m.prefix+"-"+S+h,{detail:Object.assign({attribute:i,component:a},g)}))},J=h=>{let g={headers:{}};if(K?g.method=K:j&&f.hasAttribute("method")?g.method=f.getAttribute("method").toUpperCase():g.method="GET",j){let y=new FormData(f),p=pe;switch(!p&&f.hasAttribute("enctype")?p=f.getAttribute("enctype").toLowerCase():p="urlencoded",(g.method==="HEAD"||g.method==="GET")&&(p="parameters"),p){case"json":g.headers["Content-Type"]="application/json; charset=UTF-8",g.body=JSON.stringify(Object.fromEntries(y));break;case"multipart":case"multipart/form-data":g.headers["Content-Type"]="multipart/form-data",g.body=y;break;case"parameters":h=new URL(h,window.location.href);let d=new URLSearchParams(y);for(let[C,v]of d)h.searchParams.set(C,v);h=h.toString();break;case"urlencoded":case"application/x-www-form-urlencoded":g.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",g.body=new URLSearchParams(y).toString();break;case"xml":g.headers["Content-Type"]="application/xml; charset=UTF-8",g.body=ce(y);break;default:break}}return H("-started",{url:h}),R(h,Object.assign({},e,g,{headers:Object.assign({},g.headers,he)})).then(y=>{B=!1;let p=y.value;c.decode&&(p=ee(y.value));let d=null;if(c.document)d=document.documentElement;else{let v=m.prefix+"-"+S+"-"+m.targetDirectiveName;f.getAttribute(v)&&(m.targetDirectiveEvaluate?d=l(a,i,f.getAttribute(v)):d=f.getAttribute(v),d&&typeof d=="string"&&(d=f.querySelector(d))),d||(d=f)}if(F==="append"){let v=T(A(p),a,i,l);d.append(v),(m.allowInlineScript||c.script)&&L(v)}else if(F==="prepend"){let v=T(A(p),a,i,l);d.prepend(v),(m.allowInlineScript||c.script)&&L(v)}else if(F==="after"){let v=T(A(p),a,i,l);d.insertAdjacentElement("afterend",v),(m.allowInlineScript||c.script)&&L(v)}else if(F==="before"){let v=T(A(p),a,i,l);d.insertAdjacentElement("beforebegin",v),(m.allowInlineScript||c.script)&&L(v)}else if(F==="outer")c.morph?Y(d,T(A(p),a,i,l)):d.outerHTML!==p&&(d.outerHTML=T(p,a,i,l),(m.allowInlineScript||c.script)&&L(d));else if(c.morph){if(d.children.length===0)d.append(document.createElement("div"));else if(d.children.length>1)for(let q=d.children.length-1;q>=1;q--)d.children[q].remove();let v=Y(d.children[0],T(A(p),a,i,l));d.children[0].isSameNode(v)||(d.children[0].remove(),d.append(v))}else d.innerHTML!==p&&(d.innerHTML=T(p,a,i,l),(m.allowInlineScript||c.script)&&L(...d.children));if(m.redirectHeaderName&&y.headers.has(m.prefix+"-"+m.titleHeaderName)){window.location.href=y.headers.get(m.prefix+"-"+m.titleHeaderName);return}let C="";m.titleHeaderName&&y.headers.has(m.prefix+"-"+m.titleHeaderName)&&(C=y.headers.get(m.prefix+"-"+m.titleHeaderName)),c.document&&c.history&&history.pushState({},C,h),C&&document.title!==C&&(document.title=C),z(a,i),H("-succeeded",{url:h})}).catch(()=>{z(a,i),H("-failed",{url:h})})},B=!1,O=h=>new Promise(g=>{if(c.self&&h&&h.target!==f){g();return}if(j&&!f.reportValidity()){H("-invalid"),g();return}(j&&E==="submit"||me&&f.getAttribute("type","button")&&E==="click"||c.prevent)&&h&&h.preventDefault(),c.stop&&h&&h.stopPropagation();let y=()=>{let p=null;if(U&&r?p=l(a,i,U,{$event:h,$events:i[u].buffer}):j&&f.hasAttribute("action")&&(p=f.getAttribute("action")),i[u].buffer=[],!p){g();return}B=!0,oe(a,i,l),(ae(p)?p.then(d=>J(d)):J(p)).finally(()=>g())};if(B){g();return}switch(i[u].buffer.push(h),N){case x.BUFFER:if(i[u].buffer.length<c.buffer){g();return}y();return;case x.DEBOUNCE:i[u].timeout&&(clearTimeout(i[u].timeout),i[u].timeout=null),i[u].timeout=setTimeout(y,c.debounce);return;case x.THROTTLE:let p=window.performance.now();if(i[u].lastExecution&&p-i[u].lastExecution<c.throttle){g();return}y(),i[u].lastExecution=p;return;case x.DELAY:i[u].timeout=setTimeout(y,c.delay);return}y()});if(c.poll){let h=O;O=()=>{i[u].timeout=setTimeout(()=>{h(null).finally(()=>{i[u]&&O()})},c.poll)}}if(n&&E===n){let h=O;O=()=>{I.once&&o.remove(f,O),h()},o.add(f,o)}else E===s?O():f.addEventListener(E,O,I);i[u]={buffer:[],eventName:E,handler:O,target:f,timeout:i[u]?i[u].timeout:void 0,value:U}},destroy:(a,i)=>{i[u]&&(i[u].target.removeEventListener(i[u].eventName,i[u].handler),n&&o&&o.remove(i[u].target,i[u].handler),i[u].timeout&&clearTimeout(i[u].timeout),z(a,i),delete i[u])}});var k=class{constructor(r=null){let t=new WeakMap,n=o=>{for(let a of o)for(let i of t.get(a.target))i(a)},s=new window.IntersectionObserver(n,r);this.add=(o,a)=>{t.has(o)||t.set(o,[]),t.get(o).push(a),s.observe(o)},this.remove=(o,a)=>{if(!t.has(o))return;let i=t.get(o),l=i.indexOf(a);l>=0&&i.splice(l,1),i.length===0&&(t.delete(o),s.unobserve(o))}}};function ue(e,r=null){r=Object.assign({fetchContextName:"$fetch",fetchDirectiveEvaluate:!0,fetchDirectiveName:"fetch",fetchOptions:{},intersectionEvent:"intersect",intersectionRoot:null,intersectionMargin:"0px",intersectionThreshold:0,loadedEvent:"load"},r),r.defaultInit&&Object.assign(r.fetchOptions,r.defaultInit);let t=!1,n=r.intersectionEvent?new k({root:r.intersectionRoot?r.intersectionRoot:e.getOptions().root,rootMargin:r.intersectionMargin,threshold:r.intersectionThreshold}):null,s=Z(r),o=fe(r,n),a=()=>{e.addContexts(0,s),e.addDirectives(-1,o)},i=()=>{e.removeContexts(s),e.removeDirective(o)};this.disable=()=>{!e.getEnabled()&&t&&(t=!1,e.removeEventListener("enabling",a),e.removeEventListener("disabling",i))},this.enable=()=>{t||(t=!0,e.addEventListener("enabling",a),e.addEventListener("disabling",i))},this.enable()}window.DoarsFetch=ue;})();
//# sourceMappingURL=doars-fetch.iife.min.js.map
