{
  "version": 3,
  "sources": ["../../common/src/utils/Object.js", "../src/utils/FetchUtils.js", "../src/factories/contexts/fetch.js", "../src/DoarsFetch.js"],
  "sourcesContent": ["/**\n * Deeply assign a series of objects properties together.\n * @param {Object} target Target object to merge to.\n * @param  {...Object} sources Objects to merge into the target.\n */\nexport const deepAssign = (target, ...sources) => {\n  if (!sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, {\n            [key]: {}\n          });\n        }\n\n        deepAssign(target[key], source[key]);\n      } else if (Array.isArray(source[key])) {\n        target[key] = source[key].map(value => {\n          if (isObject(value)) {\n            return deepAssign({}, value);\n          }\n\n          return value;\n        });\n      } else {\n        Object.assign(target, {\n          [key]: source[key]\n        });\n      }\n    }\n  }\n\n  return deepAssign(target, ...sources);\n};\n/**\n * Get value at path on object.\n * @param {Object} object Object to get from.\n * @param  {Array<String>} path Path to value.\n * @returns {Any} value at path.\n */\n\nexport const getDeeply = (object, path) => {\n  let objectTemp = object;\n  let i = 0;\n\n  for (; i < path.length - 1; i++) {\n    objectTemp = objectTemp[path[i]];\n  }\n\n  return objectTemp[path[i]];\n};\n/**\n * Check whether the value is an object.\n * @param {Any} value Value of unknown type.\n * @returns Whether the value is an object.\n */\n\nexport const isObject = value => {\n  return value && typeof value === 'object' && !Array.isArray(value);\n};\n/**\n * Set value on path at object.\n * @param {Object} object Object to set on.\n * @param {Array<String>} path Path to value.\n * @param {Any} value Value to set.\n */\n\nexport const setDeeply = (object, path, value) => {\n  // Exit early if not an object.\n  if (typeof object !== 'object') {\n    return;\n  }\n\n  let i = 0;\n\n  for (; i < path.length - 1; i++) {\n    object = object[path[i]]; // Exit early if not an object.\n\n    if (typeof object !== 'object') {\n      return;\n    }\n  }\n\n  object[path[i]] = value;\n};\nexport default {\n  deepAssign: deepAssign,\n  getDeeply: getDeeply,\n  isObject: isObject,\n  setDeeply: setDeeply\n};", "export const parseResponse = (response, type) => {\n  let promise;\n\n  switch (String.prototype.toLowerCase.call(type)) {\n    default:\n      console.warn('Unknown response type \"' + type + '\" used when using the $fetch context.');\n      break;\n\n    case 'arraybuffer':\n      promise = response.arrayBuffer();\n      break;\n\n    case 'blob':\n      promise = response.blob();\n      break;\n\n    case 'formdata':\n      promise = response.formData();\n      break;\n\n    case 'json':\n      promise = response.json();\n      break;\n    // HTML and xml need to be converted to text before being able to be parsed.\n\n    case 'element':\n    case 'html':\n    case 'svg':\n    case 'text':\n    case 'xml':\n      promise = response.text();\n      break;\n  }\n\n  if (!promise) {\n    return null;\n  }\n\n  return promise.then(response => {\n    switch (type) {\n      // Convert from html to HTMLElement inside a document fragment.\n      case 'element':\n        const template = document.createElement('template');\n        template.innerHTML = response;\n        response = template.content.childNodes[0];\n        break;\n      // Parse some values via the DOM parser.\n\n      case 'html':\n        response = new DOMParser().parseFromString(response, 'text/html');\n        break;\n\n      case 'svg':\n        response = new DOMParser().parseFromString(response, 'image/svg+xml');\n        break;\n\n      case 'xml':\n        response = new DOMParser().parseFromString(response, 'application/xml');\n        break;\n    }\n\n    return response;\n  });\n};\nexport const responseType = response => {\n  switch (String.prototype.toLowerCase(response.headers.get('content-type'))) {\n    case 'text/html':\n      return 'html';\n\n    case 'application/json':\n    case 'application/ld+json':\n    case 'application/vnd.api+json':\n      return 'json';\n\n    case 'image/svg+xml':\n      return 'svg';\n\n    case 'text/plain':\n      return 'text';\n\n    case 'application/xml':\n    case 'text/xml':\n      return 'xml';\n  }\n\n  return null;\n};", "// Import utils.\nimport { deepAssign } from '@doars/common/src/utils/Object.js';\nimport { parseResponse, responseType } from '../../utils/FetchUtils.js';\nexport default (({\n  defaultInit\n}) => {\n  return {\n    name: '$fetch',\n    create: () => {\n      return {\n        value: (url, init = null) => {\n          // Apply default options to init.\n          if (defaultInit) {\n            init = deepAssign({}, defaultInit, init);\n          } // Extract optional return type.\n\n\n          let returnType = init.returnType ? init.returnType : null;\n          delete init.returnType; // Perform and process fetch request.\n\n          return fetch(url, init).then(response => {\n            // Automatically base return type on header.\n            if (returnType === 'auto' && response.headers.get('content-type')) {\n              returnType = responseType(response);\n            } // Parse response based on return type.\n\n\n            if (returnType) {\n              response = parseResponse(response, returnType);\n            }\n\n            return response;\n          });\n        }\n      };\n    }\n  };\n});", "// Import contexts.\nimport createFetchContext from './factories/contexts/fetch.js';\nexport default class DoarsFetch {\n  /**\n   * Create plugin instance.\n   * @param {Doars} library Doars instance to add onto.\n   * @param {Object} options The plugin options.\n   */\n  constructor(library, options = null) {\n    // Clone options.\n    options = Object.assign({\n      defaultInit: {}\n    }, options); // Create contexts.\n\n    const fetchContext = createFetchContext(options); // Enable plugin when library is enabling.\n\n    library.addEventListener('enabling', () => {\n      library.addContexts(0, fetchContext);\n    }); // Disable plugin when library is disabling.\n\n    library.addEventListener('disabling', () => {\n      library.removeContexts(fetchContext);\n    });\n  }\n\n}"],
  "mappings": "MAKO,GAAM,GAAa,CAAC,KAAW,IAAY,CAChD,GAAI,CAAC,EAAQ,OACX,MAAO,GAGT,GAAM,GAAS,EAAQ,MAAM,EAE7B,GAAI,EAAS,CAAM,GAAK,EAAS,CAAM,EACrC,OAAW,KAAO,GAChB,AAAI,EAAS,EAAO,EAAI,EACjB,GAAO,IACV,OAAO,OAAO,EAAQ,CACpB,CAAC,GAAM,CAAC,CACV,CAAC,EAGH,EAAW,EAAO,GAAM,EAAO,EAAI,GAC9B,AAAI,MAAM,QAAQ,EAAO,EAAI,EAClC,EAAO,GAAO,EAAO,GAAK,IAAI,GACxB,EAAS,CAAK,EACT,EAAW,CAAC,EAAG,CAAK,EAGtB,CACR,EAED,OAAO,OAAO,EAAQ,CACpB,CAAC,GAAM,EAAO,EAChB,CAAC,EAKP,MAAO,GAAW,EAAQ,GAAG,CAAO,CACtC,EAwBO,GAAM,GAAW,GACf,GAAS,MAAO,IAAU,UAAY,CAAC,MAAM,QAAQ,CAAK,EChE5D,GAAM,GAAgB,CAAC,EAAU,IAAS,CAC/C,GAAI,GAEJ,OAAQ,OAAO,UAAU,YAAY,KAAK,CAAI,WAE1C,QAAQ,KAAK,0BAA4B,EAAO,uCAAuC,EACvF,UAEG,cACH,EAAU,EAAS,YAAY,EAC/B,UAEG,OACH,EAAU,EAAS,KAAK,EACxB,UAEG,WACH,EAAU,EAAS,SAAS,EAC5B,UAEG,OACH,EAAU,EAAS,KAAK,EACxB,UAGG,cACA,WACA,UACA,WACA,MACH,EAAU,EAAS,KAAK,EACxB,MAGJ,MAAK,GAIE,EAAQ,KAAK,GAAY,CAC9B,OAAQ,OAED,UACH,GAAM,GAAW,SAAS,cAAc,UAAU,EAClD,EAAS,UAAY,EACrB,EAAW,EAAS,QAAQ,WAAW,GACvC,UAGG,OACH,EAAW,GAAI,WAAU,EAAE,gBAAgB,EAAU,WAAW,EAChE,UAEG,MACH,EAAW,GAAI,WAAU,EAAE,gBAAgB,EAAU,eAAe,EACpE,UAEG,MACH,EAAW,GAAI,WAAU,EAAE,gBAAgB,EAAU,iBAAiB,EACtE,MAGJ,MAAO,EACT,CAAC,EA3BQ,IA4BX,EACa,EAAe,GAAY,CACtC,OAAQ,OAAO,UAAU,YAAY,EAAS,QAAQ,IAAI,cAAc,CAAC,OAClE,YACH,MAAO,WAEJ,uBACA,0BACA,2BACH,MAAO,WAEJ,gBACH,MAAO,UAEJ,aACH,MAAO,WAEJ,sBACA,WACH,MAAO,MAGX,MAAO,KACT,ECnFA,GAAO,GAAS,CAAC,CACf,iBAEO,EACL,KAAM,SACN,OAAQ,IACC,EACL,MAAO,CAAC,EAAK,EAAO,OAAS,CAE3B,AAAI,GACF,GAAO,EAAW,CAAC,EAAG,EAAa,CAAI,GAIzC,GAAI,GAAa,EAAK,WAAa,EAAK,WAAa,KACrD,aAAO,GAAK,WAEL,MAAM,EAAK,CAAI,EAAE,KAAK,GAEvB,KAAe,QAAU,EAAS,QAAQ,IAAI,cAAc,GAC9D,GAAa,EAAa,CAAQ,GAIhC,GACF,GAAW,EAAc,EAAU,CAAU,GAGxC,EACR,CACH,CACF,EAEJ,GClCF,GAAqB,GAArB,KAAgC,CAM9B,YAAY,EAAS,EAAU,KAAM,CAEnC,EAAU,OAAO,OAAO,CACtB,YAAa,CAAC,CAChB,EAAG,CAAO,EAEV,GAAM,GAAe,EAAmB,CAAO,EAE/C,EAAQ,iBAAiB,WAAY,IAAM,CACzC,EAAQ,YAAY,EAAG,CAAY,CACrC,CAAC,EAED,EAAQ,iBAAiB,YAAa,IAAM,CAC1C,EAAQ,eAAe,CAAY,CACrC,CAAC,CACH,CAEF",
  "names": []
}
