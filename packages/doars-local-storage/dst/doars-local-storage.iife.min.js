(()=>{var g=(l,n,e,t,o)=>({deconstruct:o,name:l,create:(r,i,s,{RevocableProxy:d})=>{let c=(u,p)=>s(n,l+"."+p.join(".")),v=(u,p)=>i.accessed(n,l+"."+p.join(".")),f=(u,p)=>s(n,l+"."+p.join("."));t.addEventListener("delete",c),t.addEventListener("get",v),t.addEventListener("set",f);let a=d(e,{});return{value:a.proxy,destroy:()=>{t.removeEventListener("delete",c),t.removeEventListener("get",v),t.removeEventListener("set",f),a.revoke()}}}});var b=(l,n,e,t)=>g("$localStorage",l,n,e,t);var y=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"],x=(l,n)=>{let e=!1,t={};for(let o of y)t[o]=(...r)=>{if(!e)return o in n?n[o](...r):Reflect[o](...r)};return{proxy:new Proxy(l,t),revoke:()=>{e=!0}}};var E=class{constructor(){let n={};this.addEventListener=(e,t,o=null)=>{e in n||(n[e]=[]),n[e].push({callback:t,options:o})},this.removeEventListener=(e,t)=>{if(!Object.keys(n).includes(e))return;let o=n[e],r=-1;for(let i=0;i<o.length;i++)if(o[i].callback===t){r=i;break}r<0||(o.splice(r,1),Object.keys(o).length===0&&delete n[e])},this.removeEventListeners=e=>{e&&delete n[e]},this.removeAllEventListeners=()=>{n={}},this.dispatchEvent=(e,t,o=null)=>{if(!n[e])return;let r=n[e];for(let i=0;i<r.length;i++){let s=o&&o.reverse?r[r.length-(i+1)]:r[i];s.options&&s.options.once&&r.splice(i,1),s.callback(...t)}}}};var m=class extends E{constructor(n={}){super(),n=Object.assign({delete:!0,get:!0,set:!0},n);let e=new WeakMap;this.add=(t,o=[])=>{if(e.has(t))return e.get(t);for(let s in t)t[s]&&typeof t[s]=="object"&&(t[s]=this.add(t[s],[...o,s]));let r={};n.delete&&(r.deleteProperty=(s,d)=>{if(!Reflect.has(s,d))return!0;this.remove(s,d);let c=Reflect.deleteProperty(s,d);return c&&this.dispatchEvent("delete",[s,Array.isArray(s)?[...o]:[...o,d]]),c}),n.get&&(r.get=(s,d,c)=>(d!==Symbol.unscopables&&this.dispatchEvent("get",[s,[...o,d],c]),Reflect.get(s,d,c))),n.set&&(r.set=(s,d,c,v)=>(s[d]===c||(c&&typeof c=="object"&&(c=this.add(c,[...o,d])),s[d]=c,this.dispatchEvent("set",[s,Array.isArray(s)?[...o]:[...o,d],c,v])),!0));let i=x(t,r);return e.set(i,t),i.proxy},this.remove=t=>{if(!e.has(t))return;let o=e.get(t);e.delete(o);for(let r in o.proxy)typeof o.proxy[r]=="object"&&this.remove(o.proxy[r]);o.revoke()}}};var h=()=>{let l={},n=Object.keys(localStorage);for(let e=n.length-1;e>=0;e--)l[n[e]]=localStorage.getItem(n[e]);return l};var S=Symbol("ID_LOCAL_STORAGE");function L(l,n=null){n=Object.assign({deconstruct:!1},n);let e=!1,t,o,r,i,s=(f,a)=>{a.length>1,localStorage.removeItem(a[0])},d=(f,a)=>{a.length>1,localStorage.setItem(a[0],f[a[0]])},c=()=>{o=h(),r=new m,i=r.add(o),r.addEventListener("delete",s),r.addEventListener("set",d),t=b(S,i,r,!!n.deconstruct);let f=l.getContexts(),a=0;for(let u=f.length-1;u>=0;u--)if(f[u].name==="$state"){a=u;break}l.addContexts(a,t)},v=()=>{l.removeContexts(t),r.removeEventListener("delete",s),r.removeEventListener("set",d),i=null,r.remove(o),r=null,o=null,t=null};this.disable=()=>{!l.getEnabled()&&e&&(e=!1,l.removeEventListener("enabling",c),l.removeEventListener("disabling",v))},this.enable=()=>{e||(e=!0,l.addEventListener("enabling",c),l.addEventListener("disabling",v))},this.enable()}window.DoarsLocalStorage=L;})();
//# sourceMappingURL=doars-local-storage.iife.min.js.map
