!function(){"use strict";const e=Symbol(),t=Symbol(),n=Symbol(),r=Symbol(),s=Symbol(),o=Symbol(),i=Symbol(),a=Symbol(),c=Symbol();class l{constructor(){let e={};this.addEventListener=(t,n,r=null)=>{t in e||(e[t]=[]),e[t].push({callback:n,options:r})},this.removeEventListener=(t,n)=>{if(!Object.keys(e).includes(t))return;const r=e[t];let s=-1;for(let e=0;e<r.length;e++)if(r[e].callback===n){s=e;break}s<0||(r.splice(s,1),0===Object.keys(r).length&&delete e[t])},this.removeEventListeners=t=>{t&&delete e[t]},this.removeAllEventListeners=()=>{e={}},this.dispatchEvent=(t,n,r=null)=>{if(!e[t])return;const s=e[t];for(let e=0;e<s.length;e++){const t=r&&r.reverse?s[s.length-(e+1)]:s[e];t.options&&t.options.once&&s.splice(e,1),t.callback(...n)}}}}const u=e=>{if("string"==typeof e&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return void console.error("Doars: parseSelector expects Array of string or a single string.");const t={};for(let n of e)switch(n=n.trim(),n[0]){case"#":t.id=n.substring(1);break;case".":n=n.substring(1),t.class||(t.class=[]),t.class.includes(n)||t.class.push(n);break;case"[":const[e,r,s]=n.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);t[r]=s}return t};class d extends l{constructor(t,n,r,s,o=!1){super();const i=Symbol();o||(n[e]||(n[e]=[]),n[e].push(this));let a,c,l,u,f,h={};if(r){const[e,n,s,o]=((e,t)=>{if(!(t=t.match(new RegExp("^"+e+"-([a-z][0-9a-z-]{1,}):?([a-z][0-9a-z-]*)?(\\..*]*)?$","i"))))return;let[n,r,s,o]=t;s=""!==s?s:null;const i=s?s.replace(/-(\w)/g,((e,t)=>t.toUpperCase())):null;return o=o?o.substring(1).split("."):[],[r,s,i,o]})(t.getLibrary().getOptions().prefix,r);a=e,c=s,l=n,u=o,o&&(f=(e=>{const t={};for(const n of e){const e=n.indexOf("-");if(e<0){t[n]=!0;continue}if(0===e){t[n.substring(1)]=!1;continue}const r=n.substring(0,e);let s=n.substring(e+1);const o=Number.parseInt(s);isNaN(o)||(s=o),t[r]=s}return t})(o))}this.getComponent=()=>t,this.getElement=()=>n,this.getId=()=>i,this.getDirective=()=>a,this.getKey=()=>c,this.getKeyRaw=()=>l,this.getModifiers=()=>Object.assign({},f),this.getModifiersRaw=()=>u,this.getName=()=>r,this.getValue=()=>s,this.setValue=e=>{s=e,this.dispatchEvent("changed",[this])},this.destroy=()=>{this.clearAccessed();const t=n[e].indexOf(this);t>=0&&n[e].splice(t,1),this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.accessed=(e,t)=>{if(h[e]){if(h[e].includes(t))return}else h[e]=[];h[e].push(t),this.dispatchEvent("accessed",[this,e,t])},this.clearAccessed=()=>{h={}},this.hasAccessed=(e,t)=>{if(!(e in h))return!1;const n=h[e];for(const e of t)if(n.includes(e))return!0;return!1},this.clone=()=>new d(t,n,r,s,!0)}}const f=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"];function h(e,t){let n=!1;const r={};for(const e of f)r[e]=(...r)=>{if(!n)return e in t?t[e](...r):Reflect[e](...r);console.error("illegal operation attempted on a revoked proxy")};return{proxy:new Proxy(e,r),revoke:()=>{n=!0}}}class p extends l{constructor(e={}){super(),e=Object.assign({delete:!0,get:!0,set:!0},e);const t=new WeakMap;this.add=(n,r=[])=>{if(t.has(n))return t.get(n);for(const e in n)n[e]&&"object"==typeof n[e]&&(n[e]=this.add(n[e],[...r,e]));const s={};e.delete&&(s.deleteProperty=(e,t)=>{if(!Reflect.has(e,t))return!0;this.remove(e,t);const n=Reflect.deleteProperty(e,t);return n&&this.dispatchEvent("delete",[e,Array.isArray(e)?[...r]:[...r,t]]),n}),e.get&&(s.get=(e,t,n)=>(t!==Symbol.unscopables&&this.dispatchEvent("get",[e,[...r,t],n]),Reflect.get(e,t,n))),e.set&&(s.set=(e,t,n,s)=>(e[t]===n||("object"==typeof n&&(n=this.add(n,[...r,t])),e[t]=n,this.dispatchEvent("set",[e,Array.isArray(e)?[...r]:[...r,t],n,s])),!0));const o=h(n,s);return t.set(o,n),o.proxy},this.remove=e=>{if(!t.has(e))return;const n=t.get(e);t.delete(n);for(const e in n.proxy)"object"==typeof n.proxy[e]&&this.remove(n.proxy[e]);n.revoke()}}}const g=(e,t)=>{for(const n in t)if("class"!==n)e.setAttribute(n,t[n]);else for(const n of t.class)e.classList.add(n)},m=(e,t)=>{for(const n in t)if("class"!==n)t[n]&&e.attributes[n]!==t[n]||e.removeAttribute(n);else for(const n of t.class)e.classList.remove(n)},v=(e,t,n)=>{if("value"!==t||"INPUT"!==e.tagName)"checked"!==t||"checkbox"!==e.type&&"radio"!==e.type?("class"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).filter((([e,t])=>t)).map((([e])=>e)).join(" "))),"style"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).map((([e,t])=>e+":"+t)).join(";"))),!1===n||null==n?e.removeAttribute(t):e.setAttribute(t,n)):e.checked=!!n;else{if(n||(n=""),e.getAttribute(t)===n)return;e.setAttribute(t,n)}},b=(e,t)=>{for(const n in t)v(e,n,t[n])},y=(e,t)=>{e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},E=(e,t)=>e.isSameNode?e.isSameNode(t):e.tagName===t.tagName&&3===e.type&&e.nodeValue===t.nodeValue,x=(e,t)=>{let n=-1,r=null;return()=>{if(n>=0&&r){const e=r();if(e)return e}let s=null;do{if(n++,n>=e.childElementCount)return null;s=e.children[n]}while(!t(s));return s.childElementCount&&(r=x(s,t)),s}},A=(e,t)=>{const n=t.nodeType,r=t.nodeName;1===n&&((e,t)=>{const n=e.attributes,r=t.attributes;let s=null,o=null,i=null,a=null,c=null;for(let t=r.length-1;t>=0;--t)c=r[t],a=c.name,s=c.namespaceURI,o=c.value,s?(a=c.localName||a,i=e.getAttributeNS(s,a),i!==o&&e.setAttributeNS(s,a,o)):e.hasAttribute(a)?(i=e.getAttribute(a),i!==o&&("null"===o||"undefined"===o?e.removeAttribute(a):e.setAttribute(a,o))):e.setAttribute(a,o);for(let r=n.length-1;r>=0;--r)c=n[r],!1!==c.specified&&(a=c.name,s=c.namespaceURI,s?(a=c.localName||a,t.hasAttributeNS(s,a)||e.removeAttributeNS(s,a)):t.hasAttributeNS(null,a)||e.removeAttribute(a))})(e,t),3!==n&&8!==n||e.nodeValue!==t.nodeValue&&(e.nodeValue=t.nodeValue),"INPUT"===r?w(e,t):"OPTION"===r?k(e,t,"selected"):"TEXTAREA"===r&&N(e,t)},w=(e,t)=>{const n=t.value,r=e.value;k(e,t,"checked"),k(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(e.indeterminate=t.indeterminate),"file"!==e.type&&(r!==n&&(e.setAttribute("value",n),e.value=n),"null"===n&&(e.value="",e.removeAttribute("value")),t.hasAttributeNS(null,"value")?"range"===e.type&&(e.value=n):e.removeAttribute("value"))},N=(e,t)=>{const n=t.value;if(e.value!==n&&(e.value=n),e.firstChild&&e.firstChild.nodeValue!==n){if(e.firstChild.nodeValue===e.placeholder&&""===n)return;e.firstChild.nodeValue=n}},k=(e,t,n)=>{e[n]!==t[n]&&(e[n]=t[n],t[n]?e.setAttribute(n,""):e.removeAttribute(n))},O=(e,t)=>e?t?e.isSameNode&&e.isSameNode(t)?e:e.tagName!==t.tagName?t:(A(e,t),L(e,t),e):null:t,L=(e,t)=>{let n,r,s,o,i=0;for(let a=0;n=e.childNodes[a],r=t.childNodes[a-i],n||r;a++)if(r)if(n)if(E(n,r))s=O(n,r),s!==n&&(e.replaceChild(s,n),i++);else{o=null;for(let t=a;t<e.childNodes.length;t++)if(E(e.childNodes[t],r)){o=e.childNodes[t];break}o?(s=O(o,r),s!==o&&i++,e.insertBefore(s,n)):r.id||n.id?(e.insertBefore(r,n),i++):(s=O(n,r),s!==n&&(e.replaceChild(s,n),i++))}else e.appendChild(r),i++;else e.removeChild(n),a--},S=e=>{if(e.parentElement)return(e=e.parentElement)[t]?e[t]:S(e)},C=()=>({createContexts:j,createContextsProxy:T,RevocableProxy:h}),j=(e,t,n,r=null)=>{const s={},o=[];let i="",a="";const c=e.getLibrary().getContexts();for(const r of c){if(!r||!r.name)continue;const c=r.create(e,t,n,C());c&&c.value&&(c.destroy&&"function"==typeof c.destroy&&o.push(c.destroy),r.deconstruct&&"object"==typeof c.value&&(a+="with("+r.name+") { ",i+=" }"),s[r.name]=c.value)}if("object"==typeof r)for(const e in r)s[e]=r[e];return{after:i,before:a,destroy:()=>{o.forEach((e=>e(C())))},contexts:s}},T=(e,t,n,r=null)=>{let s=null;const o=h({},{get:(o,i)=>(s||(s=j(e,t,n,r)),i in s.contexts?(t.accessed(e.getId(),i),s.contexts[i]):s.contexts.$state&&i in s.contexts.$state?(t.accessed(e.getId(),"$state"),s.contexts.$state[i]):void 0)});return{contexts:o.proxy,destroy:()=>{s&&s.destroy&&s.destroy(e,t),o.revoke()}}},D=(e,t,n,r=null,s=null)=>{s=Object.assign({return:!0},s);const o=[];let i,{after:a,before:c,contexts:l,destroy:u}=j(e,t,((e,t)=>{o.push({id:e,path:t})}),r);s.return&&(c+="return ");try{i=new Function(...Object.keys(l),c+n+a)(...Object.values(l))}catch(e){console.error(e,"Error encountered when executing the following expression: ",n),i=null}return u(),o.length>0&&e.getLibrary().update(o),i},$=(e,t,n,r=null)=>{if(1!==n.nodeType)return void(r&&r());const{prefix:s}=t.getLibrary().getOptions(),o=s+"-transition:"+e,i=t=>{n.dispatchEvent(new CustomEvent("transition-"+t)),n.dispatchEvent(new CustomEvent("transition-"+e+"-"+t))};let a,c,l,d,f=!1;const h={};return a=o,c=n.getAttribute(a),c&&(h.during=u(c),g(n,h.during)),a=o+".from",c=n.getAttribute(a),c&&(h.from=u(c),g(n,h.from)),i("start"),d=requestAnimationFrame((()=>{if(d=null,f)return;if(h.from&&(m(n,h.from),h.from=void 0),a=o+".to",c=n.getAttribute(a),c)h.to=u(c),g(n,h.to);else if(!h.during)return i("end"),r&&r(),void(f=!0);const e=getComputedStyle(n);let t=1e3*Number(e.transitionDuration.replace(/,.*/,"").replace("s",""));0===t&&(t=1e3*Number(e.animationDuration.replace("s",""))),l=setTimeout((()=>{l=null,f||(h.during&&(m(n,h.during),h.during=void 0),h.to&&(m(n,h.to),h.to=void 0),i("end"),r&&r(),f=!0)}),t)})),()=>{f&&(f=!0,h.during&&(m(n,h.during),h.during=void 0),h.from?(m(n,h.from),h.from=void 0):h.to&&(m(n,h.to),h.to=void 0),d?(cancelAnimationFrame(d),d=null):l&&(clearTimeout(l),l=null),i("end"),r&&r())}},P=(e,t,n)=>$("in",e,t,n),I=(e,t,n)=>$("out",e,t,n),V=Object.freeze({executeExpression:D,morphNode:A,morphTree:(e,t,n)=>{if("object"!=typeof e)throw new Error("Existing tree should be an object.");if("string"==typeof t)t=(e=>{const t=document.createElement("template");return t.innerHTML=e,t.content.childNodes[0]})(t);else if("object"!=typeof t)throw new Error("New tree should be an object.");return n&&n.childrenOnly||11===t.nodeType?(L(e,t),e):O(e,t)},transition:$,transitionIn:P,transitionOut:I});class R{constructor(e,n){const r=Symbol(),{prefix:s}=e.getOptions();let o,i,a,c=[],l=!1,u=!1;if(!n.attributes[s+"-state"])return void console.error("Doars: element given to component does not contain a state attribute!");n[t]=this;const f=[];let h=S(n);h&&(h.getChildren().includes(this)||(h.getChildren().push(this),e.update([{id:h.getId(),path:"children"}]))),this.getAttributes=()=>c,this.getChildren=()=>f,this.getElement=()=>n,this.getId=()=>r,this.getLibrary=()=>e,this.getParent=()=>h,this.getProxy=()=>i,this.getState=()=>a,this.setParent=e=>{h=e},this.initialize=()=>{if(u)return;u=!0;const e=s+"-state",t=n.attributes[e].value;o=D(this,new d(this,n,null,t),t)??{},Array.isArray(o)||"object"!=typeof o?console.error("Doars: component tag must return an object!"):(i=new p,a=i.add(o),this.scanAttributes(n))},this.destroy=()=>{if(!u)return;if(c.length>0){const t=e.getDirectivesObject();for(const e in t)t[e].destroy||(t[e]=void 0);for(const e of c){const n=t[e.getKey()];n&&n.destroy(this,e,V),e.destroy()}}delete n[t],c=[],u=!1,i.remove(o),a=null,i=null,o=null;const s=[];if(f.length>0){for(const e of f)e.setParent(h),s.push({id:e.getId(),path:"parent"});s.push({id:r,path:"children"})}h&&(f.length>0&&(h.getChildren().push(...f),s.push({id:h.getId(),path:"children"})),s.push({id:r,path:"parent"})),s.length>0&&e.update(s),g("destroyed",{element:n,id:r})},this.addAttribute=(t,n,r)=>{const s=e.getDirectivesNames(),o=new d(this,t,n,r);let i=o.length;const a=s.indexOf(o.getDirective());for(let e=c.length-1;e>=0;e--)if(s.indexOf(c[e].getDirective())<=a){i=e+1;break}return c.splice(i,0,o),o},this.removeAttribute=t=>{const n=c.indexOf(t);if(n<0)return;const r=e.getDirectivesObject[t.getKey()];r&&r.destroy&&r.destroy(this,t,V),c.splice(n,1),t.destroy()},this.scanAttributes=t=>{const n=s+"-state",r=s+"-ignore",o=[],i=x(t,(e=>!e.hasAttribute(n)&&!e.hasAttribute(r)));do{for(const{name:n,value:r}of t.attributes)e.isDirectiveName(n)&&o.push(this.addAttribute(t,n,r))}while(t=i());return o},this.updateAttribute=t=>{if(!t.getElement()||null===t.getValue()||void 0===t.getValue())return void this.removeAttribute(t);const n=e.getDirectivesObject();t.clearAccessed();const r=n[t.getDirective()];r&&r.update(this,t,V)},this.updateAttributes=e=>{if(!u||e.length<=0)l||(l=!0,g("updated",{attributes:e,element:n,id:r}));else{for(const t of e)this.updateAttribute(t);l=!0,g("updated",{attributes:e,element:n,id:r})}},this.update=e=>{if(!u)return;const t=Object.getOwnPropertySymbols(e),s=[];for(const n of c)for(const r of t)n.hasAccessed(r,e[r])&&(this.updateAttribute(n),s.push(n));(!l||s.length>0)&&(l=!0,g("updated",{attributes:s,element:n,id:r}))};const g=(e,t)=>{n.dispatchEvent(new CustomEvent(s+"-"+e,{detail:t,bubbles:!0}))}}}var z={name:"$children",create:(e,t,n,{createContextsProxy:r,RevocableProxy:s})=>{let o;const i=s(e.getChildren(),{get:(s,i,a)=>{if(o||(o=s.map((e=>r(e,t,n))),t.accessed(e.getId(),"children")),isNaN(i))return Reflect.get(o,i,a);const c=Reflect.get(o,i,a);return c?c.contexts:void 0}});return{value:i.proxy,destroy:()=>{o&&o.forEach((e=>e.destroy())),i.revoke()}}}},M={name:"$component",create:e=>({value:e.getElement()})},U={name:"$element",create:(e,t)=>({value:t.getElement()})},_={name:"$dispatch",create:e=>({value:(t,n={})=>{e.getElement().dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0}))}})},K={deconstruct:!0,name:"$for",create:(e,t,r,{RevocableProxy:s})=>{if(e!==t.getComponent())return;let o=t.getElement();const i=e.getElement(),a=[],c={};for(;o&&!o.isSameNode(i);){const e=o[n];if(e){a.push(e);for(const t in e.variables)c[t]=e.variables[t]}o=o.parentNode}if(0===a.length)return;const l=s(c,{get:(e,n)=>{for(const e of a)if(n in e.variables)return t.accessed(e.id,"$for"),e.variables[n]}});return{value:l.proxy,destroy:()=>{l.revoke()}}}},q={name:"$inContext",create:(e,t,n,{createContexts:r})=>({value:s=>{const{contexts:o,destroy:i}=r(e,t,n,{}),a=s(o);return i(),a}})},H={name:"$nextTick",create:(e,t,n,{createContexts:r})=>{let s,o=!1;return{value:i=>{(()=>{if(o)return;o=!0;const i=e.getLibrary();s=[];const a=()=>{c();const{contexts:o,destroy:i}=r(e,t,n,{});for(const e of s)e(o);i()},c=()=>{i.removeEventListener("updated",a),t.removeEventListener("changed",c),t.removeEventListener("destroyed",c)};i.addEventListener("updated",a),t.addEventListener("changed",c),t.addEventListener("destroyed",c)})(),s.push(i)}}}},W={name:"$parent",create:(e,t,n,{createContextsProxy:r})=>{const s=e.getParent();if(!s)return{key:"$parent",value:null};const{contexts:o,destroy:i}=r(s,t,n);return{value:o,destroy:i}}},B={name:"$references",create:(e,t,n,{RevocableProxy:r})=>{if(!e[i])return{key:"$references",value:[]};let s=e[a];if(!s){const t=e[i],n=Object.getOwnPropertySymbols(t);s={};for(const e of n){const{element:n,name:r}=t[e];s[r]=n}e[a]=s}const o=r(s,{get:(n,r,s)=>(t.accessed(e.getId(),"$references."+r),Reflect.get(n,r,s))});return{value:o.proxy,destroy:()=>{o.revoke()}}}},F={deconstruct:!0,name:"$state",create:(e,t,n,{RevocableProxy:r})=>{const s=e.getProxy(),o=e.getState();if(!s||!o)return;const i=(t,r)=>n(e.getId(),"$state."+r.join(".")),a=(n,r)=>t.accessed(e.getId(),"$state."+r.join(".")),c=(t,r)=>n(e.getId(),"$state."+r.join("."));s.addEventListener("delete",i),s.addEventListener("get",a),s.addEventListener("set",c);const l=r(o,{});return{value:l.proxy,destroy:()=>{s.removeEventListener("delete",i),s.removeEventListener("get",a),s.removeEventListener("set",c),l.revoke()}}}},X={name:"attribute",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers();let o=n(e,t,t.getValue());if(s.selector)return"string"!=typeof o?void console.error("Doars: Value returned to attribute directive must be a string if the selector modifier is set."):(o=u(o),void b(r,o));if(Array.isArray(o))return void console.error("Doars: Value returned to attribute directive can not be of type array.");if("object"==typeof o)return void b(r,o);const i=t.getKeyRaw();v(r,i,o)}},G={name:"cloak",update:function(e,t,{transitionIn:n}){const r=t.getElement();r.removeAttribute(e.getLibrary().getOptions().prefix+"-"+this.name),n(e,r)}};const J=(e,...t)=>{const n={};for(let r=0;r<t.length&&!(r>=e.length);r++)n[e[r]]=t[r];return n},Q=(e,t,r=-1)=>++r>=e.length?-1:e[r][n].value===t?r:Q(e,t,r),Y=(e,t,r,s,o,i,a)=>{const c=Q(s,i,o);if(c>=0){if(c===o+1)return;const e=s[c];return y(s[o]??r,e),void t(e[n].id)}let l=document.importNode(r.content,!0);const u=-1===o?r:s[o];y(u,l),l=u.nextElementSibling,P(e,l),l[n]={id:Symbol(),value:i,variables:a},s.splice(o+1,0,l)},Z=(e,t,n)=>{if(!(t.length<n))for(let r=t.length-1;r>=n;r--){const n=t[r];t.splice(r,1),I(e,n,(()=>{n.remove()}))}};var ee={name:"for",update:(e,t,{executeExpression:r})=>{const s=t.getElement();if("TEMPLATE"!==s.tagName)return void console.warn("Doars: `for` directive must be placed on a `<template>` tag.");const o=(e=>{const t=e.match(/^([$_a-z0-9,(){}\s]{1,}?)\s+(?:in|of)\s+([\s\S]{1,})$/i);if(!t)return;let n=t[1].replace(/^[\s({]*|[)}\s]*$/g,"");return n=n.match(/^([$_a-z0-9]{1,})?(?:,\s+?)?([$_a-z0-9]{1,})?(?:,\s+)?([$_a-z0-9]{1,})?$/i),n?(n.shift(),{iterable:t[2].trim(),variables:[...n]}):void 0})(t.getValue());if(!o)return void console.error("Doars: Error in `for` expression: ",t.getValue());t[n]||(t[n]=[]);const i=t[n],a={},c=e=>{a[e]||(a[e]=["$for"])};let l;l=isNaN(o.iterable)?r(e,t,o.iterable):Number(o.iterable);const u=typeof l;if("number"===u){for(let t=0;t<l;t++){const n=J(o.variables,t);Y(e,c,s,i,t-1,l,n)}Z(e,i,l)}else if("string"===u){for(let t=0;t<l.length;t++){const n=l[t],r=J(o.variables,n,t);Y(e,c,s,i,t-1,n,r)}Z(e,i,l.length)}else{let t,n;try{const e=[...l];t=!0,n=e.length}catch{}if(t)for(let t=0;t<n;t++){const n=l[t],r=J(o.variables,n,t);Y(e,c,s,i,t-1,n,r)}else{const t=Object.keys(l);n=t.length;for(let r=0;r<n;r++){const n=t[r],a=l[n],u=J(o.variables,n,a,r);Y(e,c,s,i,r-1,a,u)}}Z(e,i,n)}Object.getOwnPropertySymbols(a).length>0&&e.update(a)},destroy:(e,t)=>{if(!e[n])return;if(!t[n])return;const r=t[n];for(const t of r)I(e,t,(()=>{t.remove()}));delete t[n]}};const te={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'},ne=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;var re={name:"html",update:(e,t,{executeExpression:n,morphTree:r})=>{const s=t.getElement(),o=t.getModifiers();let i=n(e,t,t.getValue());var a;if(o.decode&&"string"==typeof i&&(i="string"!=typeof(a=i)?a:a.replaceAll(ne,(e=>te[e]))),o.morph){if(0===s.children.length)s.appendChild(document.createElement("div"));else if(s.children.length>1)for(let e=s.children.length-1;e>=1;e--)s.children[e].remove();r(s.children[0],i)}else if(i instanceof HTMLElement){for(const e of s.children)e.remove();s.appendChild(i.cloneNode(!0))}else"string"!=typeof i?console.error("Doars/directives/html: Unknown type returned to directive!"):s.innerHTML!==i&&(s.innerHTML=i)}},se={name:"if",update:(e,t,{executeExpression:n,transitionIn:s,transitionOut:o})=>{const i=t.getElement();if("TEMPLATE"!==i.tagName)return void console.warn("Doars: `if` directive must be placed on a `<template>` tag.");if(i.childCount>1)return void console.warn("Doars: `if` directive must have only one child node.");const a=n(e,t,t.getValue());let c=i[r];a?c||(c=document.importNode(i.content,!0),y(i,c),i[r]=c=i.nextElementSibling,s(e,c)):c&&o(e,c,(()=>{c.remove()}))},destroy:(e,t,{transitionOut:n})=>{const s=t.getElement(),o=s[r];o&&n(e,o,(()=>{o.remove(),s[r]=void 0}))}};const oe=(e,t)=>{if(!t[s])return;const n=e.getElement(),r=e.getLibrary().getOptions().prefix+"-updated";n.removeEventListener(r,t[s].handler),delete t[s]};var ie={name:"initialized",update:(e,t,{executeExpression:n})=>{const r=e.getElement(),o=t.getValue(),i=e.getLibrary().getOptions().prefix+"-updated";if(t[s]){if(t[s].value===o)return;r.removeEventListener(i,t[s].handler),delete t[s]}const a=({detail:s})=>{s.element===r&&(n(e,t.clone(),o,{},{return:!1}),oe(e,t))};r.addEventListener(i,a,{once:!0}),t[s]={handler:a,value:o}},destroy:oe};const ae=["alt","ctrl","meta","shift"];var ce={name:"on",update:(e,t,{executeExpression:n})=>{let r,s=t.getKeyRaw();if(!s)return void console.warn("Doars: `on` directive must have a key.");s.startsWith("keydown-")?(r=s.substring(8).toLowerCase(),s="keydown"):s.startsWith("keyup-")&&(r=s.substring(6).toLowerCase(),s="keyup");const i=t.getElement(),a=t.getValue();if(t[o]){if(t[o].value===a)return;t[o].target.removeEventListener(s,t[o].handler),t[o].timeout&&clearTimeout(t[o].timeout),delete t[o]}const c=t.getModifiers(),l={};c.capture&&(l.capture=!0),c.once&&(l.once=!0),c.passive&&(l.passive=!0);let u=0;c.buffer?(u=1,!0===c.buffer&&(c.buffer=5)):c.debounce?(u=2,!0===c.debounce&&(c.debounce=500)):c.throttle&&(u=3,!0===c.throttle&&(c.throttle=500));const d=[];if(r){c.meta=!!c.meta||c.cmd||c.super;for(const e of ae)c[e]&&d.push(e)}const f=l=>{if(c.self&&l.target!==i)return;if(c.outside&&i.contains(l.target))return;if(("keydown"===s||"keyup"===s)&&r){for(const e of d)if(!l[e+"Key"])return;let e=c.code?l.code:l.key;if(" "===e&&(e="space"),e=e.toLowerCase(),r!==e)return}c.prevent&&l.preventDefault(),c.stop&&l.stopPropagation();const f=()=>{n(e,t.clone(),a,{$event:l,$events:t[o].buffer},{return:!1}),t[o].buffer=[]};if(t[o].buffer.push(l),1===u){if(t[o].buffer.length<c.buffer)return;f()}else if(1===u)t[o].timeout&&(clearTimeout(t[o].timeout),t[o].timeout=null),t[o].timeout=setTimeout(f,c.debounce);else if(3===u){const e=window.performance.now();if(t[o].lastExecution&&e-t[o].lastExecution<c.throttle)return;f(),t[o].lastExecution=e}else f()},h=c.outside?document:i;h.addEventListener(s,f,l),t[o]={buffer:[],handler:f,target:h,timeout:t[o]?t[o].timeout:void 0,value:a}},destroy:(e,t)=>{if(!t[o])return;const n=t.getKeyRaw();t[o].target.removeEventListener(n,t[o].handler),t[o].timeout&&clearTimeout(t[o].timeout),delete t[o]}};const le=(e,t)=>{if(!e[i])return;const n=t.getId();if(!e[i][n])return;const r=e.getLibrary(),s=e.getId(),o=t.getValue().trim();delete e[i][n],delete e[a],0===Object.keys(e[i]).length&&delete e[i],r.update([{id:s,path:"$references."+o}])};var ue={name:"reference",update:(e,t)=>{const n=t.getValue().trim();if(!/^[_$a-z]{1}[_\-$a-z0-9]{0,}$/i.test(n))return le(e,t),void console.warn("Doars: `reference` directive's value not a valid variable name: \""+n+'".');const r=e.getLibrary(),s=e.getId(),o=t.getElement(),c=t.getId();e[i]||(e[i]={}),e[i][c]={element:o,name:n},delete e[a],r.update([{id:s,path:"$references."+n}])},destroy:le},de={name:"select",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=r.getAttribute("type");if("SELECT"!==r.tagName&&("INPUT"!==r.tagName||"checkbox"!==s&&"radio"!==s))return void console.warn("Doars: `select` directive must be placed on a `select` tag or `input` of type checkbox or radio.");const o=n(e,t,t.getValue());if("SELECT"===r.tagName)for(const e of Array.from(r.options)){const t=Array.isArray(o)?o.includes(e.value):o===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}else if("checkbox"===s){const e=o.includes(r.value);r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}else{const e=o===r.value;r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}}},fe={name:"show",update:(e,t,{executeExpression:n,transitionIn:r,transitionOut:s})=>{const o=t.getElement();n(e,t,t.getValue())?(o.style.display=null,r(e,o)):s(e,o,(()=>{o.style.display="none"}))}};const he=(e,t,n)=>{if("object"!=typeof e)return;let r=0;for(;r<t.length-1;r++)if("object"!=typeof(e=e[t[r]]))return;e[t[r]]=n},pe="$state.",ge=function(e,t,n){const r=(t,n)=>{n[e]&&(n.getElement().removeEventListener("input",n[e]),delete n[e])};return{update:(t,s,{executeExpression:o})=>{const i=s.getElement(),a=!s[e];if(a&&("DIV"!==i.tagName||!i.hasAttribute("contenteditable"))&&"INPUT"!==i.tagName&&"SELECT"!==i.tagName&&"TEXTAREA"!==i.tagName)return void console.warn("Doars: `sync` directive must be placed on an `<input>`, `<select>`, `<textarea>` tag, or a content editable `div`.");const c=s.getValue();if(!/^[_$a-z]{1}[._$a-z0-9]{0,}$/i.test(c))return r(0,s),void console.warn("Doars: `sync` directive's value not a valid variable name: \""+c+'".');let l=c;if(l.startsWith(n)&&(l=l.substring(n.length)),l=l.split("."),a){const{data:n,id:r,path:a}=((e,t)=>{let n=t.getValue();return n.startsWith(pe)||(n=pe+n),{data:e.getState(),id:e.getId(),path:n}})(t,s);let u;switch(i.tagName){case"DIV":u=()=>(he(n,l,i.innerText),!0);break;case"INPUT":u=()=>{if("checkbox"===i.type){const e=o(t,s.clone(),c);if(i.checked){if(!e)return he(n,l,[i.value]),!0;if(!e.includes(i.value))return e.push(i.value),!0}else if(e){const t=e.indexOf(i.value);if(t>=0)return e.splice(t,1),!0}}else{if("radio"!==i.type)return he(n,l,i.value),!0;{const e=o(t,s.clone(),c);if(i.checked){if(e!==i.value)return he(n,l,i.value),!0}else if(e===i.value)return he(n,l,null),!0}}return!1};break;case"TEXTAREA":u=()=>(he(n,l,i.value),!0);break;case"SELECT":u=()=>{if(i.multiple){const e=[];for(const t of i.selectedOptions)e.push(t.value);return he(n,l,e),!0}return he(n,l,i.selectedOptions[0].value),!0}}const d=()=>{u()&&t.getLibrary().update([{id:r,path:a}])};i.addEventListener("input",d),s[e]=d}const u=o(t,s,c);switch(i.tagName){case"DIV":case"TEXTAREA":u!==i.innerText&&(i.innerText=u);break;case"INPUT":if("checkbox"===i.type){const e=u.includes(i.value);i.checked!==e&&(i.checked=e,e?i.setAttribute("checked",""):i.removeAttribute("checked"))}else if("radio"===i.type){const e=u===i.value;i.checked!==e&&(i.checked=e,e?i.setAttribute("checked",""):i.removeAttribute("checked"))}else u!==i.value&&i.setAttribute("value",u);break;case"SELECT":for(const e of Array.from(i.options)){const t=Array.isArray(u)?u.includes(e.value):u===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}}},destroy:r}}(c,0,pe);ge.name="sync-state";var me={name:"text",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers(),o=n(e,t,t.getValue());s.content?r.textContent!==o&&(r.textContent=o):r.innerText!==o&&(r.innerText=o)}},ve={name:"watch",update:(e,t,{executeExpression:n})=>{const r=t.getValue();n(e,t,r,{},{return:!1})}};class be extends l{constructor(n){super();let{prefix:r,root:s}=n=Object.assign({prefix:"d",root:document.body.firstElementChild},n);if("string"==typeof s&&(n.root=s=document.querySelector(s)),!r)return void console.error("Doars: `prefix` option not set.");if("string"!=typeof r)return void console.error("Doars: `prefix` option must be of type string.");if(!s)return void console.error("Doars: `root` option not set.");if("object"!=typeof s)return void console.error("Doars: `root` option must be a string or HTMLElement.");const o=Symbol();let i,a,c,l=!1,u=!1;const d=[],f=[z,M,U,_,q,H,W,B,F,K],h=[ue,X,ee,re,se,me,G,ie,ce,de,fe,ge,ve];let p,g,m;this.getEnabled=()=>l,this.getId=()=>o,this.getOptions=()=>Object.assign({},n),this.enable=()=>{if(l)return this;u=!1,i=[],c={},this.dispatchEvent("enabling",[this]),l=!0,p=h.map((e=>e.name)),g={};for(const e of h)g[e.name]=e;m=new RegExp("^"+r+"-("+p.join("|")+")(?:[$-_.a-z0-9]{0,})?$","i"),a=new MutationObserver(y.bind(this)),a.observe(s,{attributes:!0,childList:!0,subtree:!0});const e=r+"-state",t=r+"-ignore",n=[...s.querySelectorAll("["+e+"]")];for(let e=n.length-1;e>=0;e--)n[e].closest("["+t+"]")&&n.splice(e,1);return v(s.hasAttribute(e)&&!s.hasAttribute(t)?s:null,...n),this.dispatchEvent("enabled",[this]),this.dispatchEvent("updated",[this]),this},this.disable=()=>l?(a.disconnect(),a=null,u=i=c=null,this.dispatchEvent("disabling",[this],{reverse:!0}),b(...d),p=g=m=null,l=!1,this.dispatchEvent("disabled",[this],{reverse:!0}),this):this;const v=(...e)=>{const n=[],r=[];for(const s of e){if(!s)continue;if(s[t])continue;const e=new R(this,s);d.push(e),n.push(e),r.push(s)}r.length>0&&this.dispatchEvent("components-added",[this,r]);for(const e of n)e.initialize();for(const e of n)e.updateAttributes(e.getAttributes());return n},b=(...e)=>{const t=[];for(const n of e){const e=d.indexOf(n);e<0||(t.push(n.getElement()),n.destroy(),d.splice(e,1))}return t.length>0&&this.dispatchEvent("components-removed",[this,t]),t};this.getContexts=()=>[...f],this.addContexts=(e,...t)=>{if(l)return void console.warn("Doars: Unable to add contexts after being enabled!");e<0?e=f.length+e%f.length:e>f.length&&(e=f.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];f.includes(s)||(f.splice(e+r,0,s),n.push(s))}return n.length>0&&this.dispatchEvent("contexts-added",[this,n]),n},this.removeContexts=(...e)=>{if(l)return void console.warn("Doars: Unable to remove contexts after being enabled!");const t=[];for(const n of e)f.indexOf(n)<0||t.push(n);return t.length>0&&this.dispatchEvent("contexts-removed",[this,t]),t},this.getDirectives=()=>[...h],this.getDirectivesNames=()=>[...p],this.getDirectivesObject=()=>Object.assign({},g),this.isDirectiveName=e=>m.test(e),this.addDirectives=(e,...t)=>{if(l)return void console.warn("Doars: Unable to add directives after being enabled!");e<0?e=h.length+e%h.length:e>h.length&&(e=h.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];h.includes(s)||(h.splice(e+r,0,s),n.push(s))}return n.length>0&&(p=g=m=null,this.dispatchEvent("directives-added",[this,n])),n},this.removeDirectives=(...e)=>{if(l)return void console.warn("Doars: Unable to remove directives after being enabled!");const t=[];for(const n of e)h.indexOf(n)<0||t.push(n);return t.length>0&&(p=g=m=null,this.dispatchEvent("directives-removed",[this,t])),t},this.update=e=>{if(l){if(e)for(const t of e){const{id:e,path:n}=t;e in c?c[e].includes(n)||c[e].push(n):c[e]=[n]}if(!u&&0!==Object.getOwnPropertySymbols(c).length){u=!0,e=c,c={};for(const t of d)t.update(e);if(u=!1,Object.getOwnPropertySymbols(c).length>0)return console.warn("Doars: during an update another update has been triggered. Normally this should not happen unless an expression in one of the directives is modifying a state which could cause a infinite loop!"),void window.requestAnimationFrame((()=>this.update()));i.length>0?y():this.dispatchEvent("updated",[this])}}};const y=n=>{if(i.push(...n),u)return;if(0===i.length)return;u=!0,n=[...i],i=[];const s=r+"-state",o=r+"-ignore",a=[],l=[],d=n=>{if(1===n.nodeType)if(n[t]){l.unshift(n[t]);const e=n.querySelectorAll(s);for(const n of e)n[t]&&l.unshift(n)}else{const r=x(n,(e=>!e[t]||(l.unshift(e[t]),!1)));do{if(n[e])for(const t of n[e])t.getComponent().removeAttribute(t)}while(n=r())}},f=e=>{if(1!==e.nodeType)return;if(e.closest("["+o+"]"))return;const t=e.querySelectorAll("["+s+"]");for(const e of t)e.closest("["+o+"]")||a.push(e);if(e.hasAttribute(s))return void a.push(e);const n=S(e);if(n){const t=n.scanAttributes(e);n.updateAttributes(t)}};for(const r of n)if("childList"===r.type){for(const e of r.removedNodes)d(e);for(const e of r.addedNodes)f(e)}else if("attributes"===r.type){const n=r.target;if(r.attributeName===s){if(n[t])continue;const r=S(n);if(r){let t=n;const o=x(n,(e=>e.hasAttribute(s)));do{for(const n of t[e])r.removeAttribute(n)}while(t=o())}v(n);continue}if(r.attributeName===o){if(n.hasAttribute(o)){d(n);continue}f(n);continue}if(!m.test(r.attributeName))continue;const i=S(n);if(!i)continue;let a=null;for(const t of n[e])if(t.getName()===r.attributeName){a=t;break}const c=n.getAttribute(r.attributeName);if(!a){c&&i.addAttribute(n,r.attributeName,c);continue}a.setValue(c),i.updateAttribute(a)}l.length>0&&b(...l),a.length>0&&v(...a),u=!1,i.length>0?y():Object.getOwnPropertySymbols(c).length>0&&this.update()}}}const ye=function(){(new be).enable()};"complete"===document.readyState||"interactive"===document.readyState?ye():document.addEventListener("DOMContentLoaded",ye,{once:!0,passive:!0}),window.copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,document.body.append(t),t.select(),t.setSelectionRange(0,999999),document.execCommand("copy"),t.remove()};let Ee=0,xe=document.getElementById("counter-text");window.increment=()=>{Ee++,xe.setAttribute("d-text",Ee)}}();
