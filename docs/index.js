!function(){"use strict";const e=Symbol(),t=Symbol(),n="-state",r=Symbol(),s=Symbol(),o=Symbol(),i=Symbol(),a=Symbol(),c=Symbol(),l=Symbol();class u{constructor(){let e={};this.addEventListener=(t,n,r=null)=>{t in e||(e[t]=[]),e[t].push({callback:n,options:r})},this.removeEventListener=(t,n)=>{if(!Object.keys(e).includes(t))return;const r=e[t];let s=-1;for(let e=0;e<r.length;e++)if(r[e].callback===n){s=e;break}s<0||(r.splice(s,1),0===Object.keys(r).length&&delete e[t])},this.removeEventListeners=t=>{t&&delete e[t]},this.removeAllEventListeners=()=>{e={}},this.dispatchEvent=(t,n,r=null)=>{if(!e[t])return;const s=e[t];for(let e=0;e<s.length;e++){const t=r&&r.reverse?s[s.length-(e+1)]:s[e];t.options&&t.options.once&&s.splice(e,1),t.callback(...n)}}}}const d=e=>{if("string"==typeof e&&(e=e.split(/(?=\.)|(?=#)|(?=\[)/)),!Array.isArray(e))return void console.error("Doars: parseSelector expects Array of string or a single string.");const t={};for(let n of e)switch(n=n.trim(),n[0]){case"#":t.id=n.substring(1);break;case".":n=n.substring(1),t.class||(t.class=[]),t.class.includes(n)||t.class.push(n);break;case"[":const[e,r,s]=n.match(/^(?:\[)?([-$_.a-z0-9]{1,})(?:[$*^])?(?:=)?([\s\S]{0,})(?:\])$/i);t[r]=s}return t};class f extends u{constructor(t,n,r,s,o=!1){super();const i=Symbol();o||(n[e]||(n[e]=[]),n[e].push(this));let a,c,l,u,d,h={};if(r){const[e,n,s,o]=((e,t)=>{if(!(t=t.match(new RegExp("^"+e+"-([a-z][0-9a-z-]{1,}):?([a-z][0-9a-z-]*)?(\\..*]*)?$","i"))))return;let[n,r,s,o]=t;s=""!==s?s:null;const i=s?s.replace(/-(\w)/g,((e,t)=>t.toUpperCase())):null;return o=o?o.substring(1).split("."):[],[r,s,i,o]})(t.getLibrary().getOptions().prefix,r);a=e,c=s,l=n,u=o,o&&(d=(e=>{const t={};for(const n of e){const e=n.indexOf("-");if(e<0){t[n]=!0;continue}if(0===e){t[n.substring(1)]=!1;continue}const r=n.substring(0,e);let s=n.substring(e+1);const o=Number.parseInt(s);isNaN(o)||(s=o),t[r]=s}return t})(o))}this.getComponent=()=>t,this.getElement=()=>n,this.getId=()=>i,this.getDirective=()=>a,this.getKey=()=>c,this.getKeyRaw=()=>l,this.getModifiers=()=>Object.assign({},d),this.getModifiersRaw=()=>u,this.getName=()=>r,this.getValue=()=>s,this.setValue=e=>{s=e,this.dispatchEvent("changed",[this])},this.destroy=()=>{this.clearAccessed();const t=n[e].indexOf(this);t>=0&&n[e].splice(t,1),this.dispatchEvent("destroyed",[this]),this.removeAllEventListeners()},this.accessed=(e,t)=>{if(h[e]){if(h[e].includes(t))return}else h[e]=[];h[e].push(t),this.dispatchEvent("accessed",[this,e,t])},this.clearAccessed=()=>{h={}},this.hasAccessed=(e,t)=>{if(!(e in h))return!1;const n=h[e];for(const e of t)if(n.includes(e))return!0;return!1},this.clone=()=>new f(t,n,r,s,!0)}}const h=["apply","construct","defineProperty","deleteProperty","get","getOwnPropertyDescriptor","getPrototypeOf","isExtensible","ownKeys","preventExtensions","set","setPrototypeOf"];function p(e,t){let n=!1;const r={};for(const e of h)r[e]=(...r)=>{if(!n)return e in t?t[e](...r):Reflect[e](...r);console.error("illegal operation attempted on a revoked proxy")};return{proxy:new Proxy(e,r),revoke:()=>{n=!0}}}class g extends u{constructor(e={}){super(),e=Object.assign({delete:!0,get:!0,set:!0},e);const t=new WeakMap;this.add=(n,r=[])=>{if(t.has(n))return t.get(n);for(const e in n)n[e]&&"object"==typeof n[e]&&(n[e]=this.add(n[e],[...r,e]));const s={};e.delete&&(s.deleteProperty=(e,t)=>{if(!Reflect.has(e,t))return!0;this.remove(e,t);const n=Reflect.deleteProperty(e,t);return n&&this.dispatchEvent("delete",[e,Array.isArray(e)?[...r]:[...r,t]]),n}),e.get&&(s.get=(e,t,n)=>(t!==Symbol.unscopables&&this.dispatchEvent("get",[e,[...r,t],n]),Reflect.get(e,t,n))),e.set&&(s.set=(e,t,n,s)=>(e[t]===n||("object"==typeof n&&(n=this.add(n,[...r,t])),e[t]=n,this.dispatchEvent("set",[e,Array.isArray(e)?[...r]:[...r,t],n,s])),!0));const o=p(n,s);return t.set(o,n),o.proxy},this.remove=e=>{if(!t.has(e))return;const n=t.get(e);t.delete(n);for(const e in n.proxy)"object"==typeof n.proxy[e]&&this.remove(n.proxy[e]);n.revoke()}}}const m=e=>{if(e.parentElement)return(e=e.parentElement)[t]?e[t]:m(e)},v=()=>({createContexts:b,createContextsProxy:y,RevocableProxy:p}),b=(e,t,n,r=null)=>{const s={},o=[];let i="",a="";const c=e.getLibrary().getContexts();for(const r of c){if(!r||!r.name)continue;const c=r.create(e,t,n,v());c&&c.value&&(c.destroy&&"function"==typeof c.destroy&&o.push(c.destroy),r.deconstruct&&"object"==typeof c.value&&(a+="with("+r.name+") { ",i+=" }"),s[r.name]=c.value)}if("object"==typeof r)for(const e in r)s[e]=r[e];return{after:i,before:a,destroy:()=>{o.forEach((e=>e(v())))},contexts:s}},y=(e,t,n,r=null)=>{let s=null;const o=p({},{get:(o,i)=>(s||(s=b(e,t,n,r)),i in s.contexts?(t.accessed(e.getId(),i),s.contexts[i]):s.contexts.$state&&i in s.contexts.$state?(t.accessed(e.getId(),"$state"),s.contexts.$state[i]):void 0)});return{contexts:o.proxy,destroy:()=>{s&&s.destroy&&s.destroy(e,t),o.revoke()}}},E=(e,t,n,r=null,s=null)=>{s=Object.assign({return:!0},s);const o=[];let i,{after:a,before:c,contexts:l,destroy:u}=b(e,t,((e,t)=>{o.push({id:e,path:t})}),r);s.return&&(c+="return ");try{i=new Function(...Object.keys(l),c+n+a)(...Object.values(l))}catch(e){throw Error(e)}return u(),o.length>0&&e.getLibrary().update(o),i},x=(e,t)=>{for(const n in t)if("class"!==n)e.setAttribute(n,t[n]);else for(const n of t.class)e.classList.add(n)},A=(e,t)=>{for(const n in t)if("class"!==n)t[n]&&e.attributes[n]!==t[n]||e.removeAttribute(n);else for(const n of t.class)e.classList.remove(n)},w=(e,t,n)=>{if("value"!==t||"INPUT"!==e.tagName)"checked"!==t||"checkbox"!==e.type&&"radio"!==e.type?("class"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).filter((([e,t])=>t)).map((([e])=>e)).join(" "))),"style"===t&&(Array.isArray(n)?n=n.join(" "):"object"==typeof n&&(n=Object.entries(n).map((([e,t])=>e+":"+t)).join(";"))),!1===n||null==n?e.removeAttribute(t):e.setAttribute(t,n)):e.checked=!!n;else{if(n||(n=""),e.getAttribute(t)===n)return;e.setAttribute(t,n)}},k=(e,t)=>{for(const n in t)w(e,n,t[n])},O=(e,t,n,r=null)=>{if(1!==n.nodeType)return void(r&&r());const{prefix:s}=t.getLibrary().getOptions(),o=s+"-transition:"+e,i=t=>{n.dispatchEvent(new CustomEvent("transition-"+t)),n.dispatchEvent(new CustomEvent("transition-"+e+"-"+t))};let a,c,l,u,f=!1;const h={};return a=o,c=n.getAttribute(a),c&&(h.during=d(c),x(n,h.during)),a=o+".from",c=n.getAttribute(a),c&&(h.from=d(c),x(n,h.from)),i("start"),u=requestAnimationFrame((()=>{if(u=null,f)return;if(h.from&&(A(n,h.from),h.from=void 0),a=o+".to",c=n.getAttribute(a),c)h.to=d(c),x(n,h.to);else if(!h.during)return i("end"),r&&r(),void(f=!0);const e=getComputedStyle(n);let t=1e3*Number(e.transitionDuration.replace(/,.*/,"").replace("s",""));0===t&&(t=1e3*Number(e.animationDuration.replace("s",""))),l=setTimeout((()=>{l=null,f||(h.during&&(A(n,h.during),h.during=void 0),h.to&&(A(n,h.to),h.to=void 0),i("end"),r&&r(),f=!0)}),t)})),()=>{f&&(f=!0,h.during&&(A(n,h.during),h.during=void 0),h.from?(A(n,h.from),h.from=void 0):h.to&&(A(n,h.to),h.to=void 0),u?(cancelAnimationFrame(u),u=null):l&&(clearTimeout(l),l=null),i("end"),r&&r())}},L=(e,t,n)=>O("in",e,t,n),N=(e,t,n)=>O("out",e,t,n),D=(e,t)=>{e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},$=(e,t)=>{let n=-1,r=null;return()=>{if(n>=0&&r){const e=r();if(e)return e}let s=null;do{if(n++,n>=e.childElementCount)return null;s=e.children[n]}while(!t(s));return s.childElementCount&&(r=$(s,t)),s}},j=()=>({executeExpression:E,transition:O,transitionIn:L,transitionOut:N});class S{constructor(e,r){const s=Symbol(),{prefix:o}=e.getOptions();let i,a,c,l=[],u=!1,d=!1;if(!r.attributes[o+n])return void console.error("Doars: element given to component does not contain a state attribute!");r[t]=this;const h=[];let p=m(r);p&&(p.getChildren().includes(this)||(p.getChildren().push(this),e.update([{id:p.getId(),path:"children"}]))),this.getAttributes=()=>l,this.getChildren=()=>h,this.getElement=()=>r,this.getId=()=>s,this.getLibrary=()=>e,this.getParent=()=>p,this.getProxy=()=>a,this.getState=()=>c,this.setParent=e=>{p=e},this.initialize=()=>{if(d)return;d=!0;const e=o+n,t=r.attributes[e].value;i=E(this,new f(this,r,null,t),t)??{},Array.isArray(i)||"object"!=typeof i?console.error("Doars: component tag must return an object!"):(a=new g,c=a.add(i),this.scanAttributes(r))},this.destroy=()=>{if(!d)return;if(l.length>0){const t=e.getDirectivesObject();for(const e in t)t[e].destroy||(t[e]=void 0);for(const e of l){const n=t[e.getKey()];n&&n.destroy(this,e,j()),e.destroy()}}delete r[t],l=[],d=!1,a.remove(i),c=null,a=null,i=null;const n=[];if(h.length>0){for(const e of h)e.setParent(p),n.push({id:e.getId(),path:"parent"});n.push({id:s,path:"children"})}p&&(h.length>0&&(p.getChildren().push(...h),n.push({id:p.getId(),path:"children"})),n.push({id:s,path:"parent"})),n.length>0&&e.update(n),v("destroyed",{element:r,id:s})},this.addAttribute=(t,n,r)=>{const s=e.getDirectivesNames(),o=new f(this,t,n,r);let i=o.length;const a=s.indexOf(o.getDirective());for(let e=l.length-1;e>=0;e--)if(s.indexOf(l[e].getDirective())<=a){i=e+1;break}return l.splice(i,0,o),o},this.removeAttribute=t=>{const n=l.indexOf(t);if(n<0)return;const r=e.getDirectivesObject[t.getKey()];r&&r.destroy&&r.destroy(this,t,j()),l.splice(n,1),t.destroy()},this.scanAttributes=t=>{const r=o+n,s=[],i=$(t,(e=>!e.hasAttribute(r)));do{for(const{name:n,value:r}of t.attributes)e.isDirectiveName(n)&&s.push(this.addAttribute(t,n,r))}while(t=i());return s},this.updateAttribute=t=>{if(!t.getElement()||null===t.getValue()||void 0===t.getValue())return void this.removeAttribute(t);const n=e.getDirectivesObject();t.clearAccessed();const r=n[t.getDirective()];r&&r.update(this,t,j())},this.updateAttributes=e=>{if(!d||e.length<=0)u||(u=!0,v("updated",{attributes:e,element:r,id:s}));else{for(const t of e)this.updateAttribute(t);u=!0,v("updated",{attributes:e,element:r,id:s})}},this.update=e=>{if(!d)return;const t=Object.getOwnPropertySymbols(e),n=[];for(const r of l)for(const s of t)r.hasAccessed(s,e[s])&&(this.updateAttribute(r),n.push(r));(!u||n.length>0)&&(u=!0,v("updated",{attributes:n,element:r,id:s}))};const v=(e,t)=>{r.dispatchEvent(new CustomEvent(o+"-"+e,{detail:t,bubbles:!0}))}}}var C={name:"$children",create:(e,t,n,{createContextsProxy:r,RevocableProxy:s})=>{let o;const i=s(e.getChildren(),{get:(s,i,a)=>{if(o||(o=s.map((e=>r(e,t,n))),t.accessed(e.getId(),"children")),isNaN(i))return Reflect.get(o,i,a);const c=Reflect.get(o,i,a);return c?c.contexts:void 0}});return{value:i.proxy,destroy:()=>{o&&o.forEach((e=>e.destroy())),i.revoke()}}}},T={name:"$component",create:e=>({value:e.getElement()})},P={name:"$element",create:(e,t)=>({value:t.getElement()})},I={name:"$dispatch",create:e=>({value:(t,n={})=>{e.getElement().dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0}))}})},V={deconstruct:!0,name:"$for",create:(e,t,n,{RevocableProxy:s})=>{if(e!==t.getComponent())return;let o=t.getElement();const i=e.getElement(),a=[],c={};for(;o&&!o.isSameNode(i);){const e=o[r];if(e){a.push(e);for(const t in e.variables)c[t]=e.variables[t]}o=o.parentNode}if(0===a.length)return;const l=s(c,{get:(e,n)=>{for(const e of a)if(n in e.variables)return t.accessed(e.id,"$for"),e.variables[n]}});return{value:l.proxy,destroy:()=>{l.revoke()}}}},R={name:"$inContext",create:(e,t,n,{createContexts:r})=>({value:s=>{const{contexts:o,destroy:i}=r(e,t,n,{}),a=s(o);return i(),a}})},z={name:"$nextTick",create:(e,t,n,{createContexts:r})=>{let s,o=!1;return{value:i=>{(()=>{if(o)return;o=!0;const i=e.getLibrary();s=[];const a=()=>{c();const{contexts:o,destroy:i}=r(e,t,n,{});for(const e of s)e(o);i()},c=()=>{i.removeEventListener("updated",a),t.removeEventListener("changed",c),t.removeEventListener("destroyed",c)};i.addEventListener("updated",a),t.addEventListener("changed",c),t.addEventListener("destroyed",c)})(),s.push(i)}}}},M={name:"$parent",create:(e,t,n,{createContextsProxy:r})=>{const s=e.getParent();if(!s)return{key:"$parent",value:null};const{contexts:o,destroy:i}=r(s,t,n);return{value:o,destroy:i}}},U={name:"$references",create:(e,t,n,{RevocableProxy:r})=>{if(!e[c])return{key:"$references",value:[]};let s=e[l];if(!s){const t=e[c],n=Object.getOwnPropertySymbols(t);s={};for(const e of n){const{element:n,name:r}=t[e];s[r]=n}e[l]=s}const o=r(s,{get:(n,r,s)=>(t.accessed(e.getId(),"$references."+r),Reflect.get(n,r,s))});return{value:o.proxy,destroy:()=>{o.revoke()}}}},_={deconstruct:!0,name:"$state",create:(e,t,n,{RevocableProxy:r})=>{const s=e.getProxy(),o=e.getState();if(!s||!o)return;const i=(t,r)=>n(e.getId(),"$state."+r.join(".")),a=(n,r)=>t.accessed(e.getId(),"$state."+r.join(".")),c=(t,r)=>n(e.getId(),"$state."+r.join("."));s.addEventListener("delete",i),s.addEventListener("get",a),s.addEventListener("set",c);const l=r(o,{});return{value:l.proxy,destroy:()=>{s.removeEventListener("delete",i),s.removeEventListener("get",a),s.removeEventListener("set",c),l.revoke()}}}},K={name:"attribute",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers();let o=n(e,t,t.getValue());if(s.selector)return"string"!=typeof o?void console.error("Doars: Value returned to attribute directive must be a string if the selector modifier is set."):(o=d(o),void k(r,o));if(Array.isArray(o))return void console.error("Doars: Value returned to attribute directive can not be of type array.");if("object"==typeof o)return void k(r,o);const i=t.getKey();w(r,i,o)}},q={name:"cloak",update:function(e,t,{transitionIn:n}){const r=t.getElement();r.removeAttribute(e.getLibrary().getOptions().prefix+"-"+this.name),n(e,r)}};const W=(e,...t)=>{const n={};for(let r=0;r<t.length&&!(r>=e.length);r++)n[e[r]]=t[r];return n},F=(e,t,n=-1)=>++n>=e.length?-1:e[n][r].value===t?n:F(e,t,n),H=(e,t,n,s,o,i,a)=>{const c=F(s,i,o);if(c>=0){if(c===o+1)return;const e=s[c];return D(s[o]??n,e),void t(e[r].id)}let l=document.importNode(n.content,!0);const u=-1===o?n:s[o];D(u,l),l=u.nextElementSibling,L(e,l),l[r]={id:Symbol(),value:i,variables:a},s.splice(o+1,0,l)},X=(e,t,n)=>{if(!(t.length<n))for(let r=t.length-1;r>=n;r--){const n=t[r];t.splice(r,1),N(e,n,(()=>{n.remove()}))}};var B={name:"for",update:(e,t,{executeExpression:n})=>{const s=t.getElement();if("TEMPLATE"!==s.tagName)return void console.warn("Doars: `for` directive must be placed on a `<template>` tag.");const o=(e=>{const t=e.match(/^([$_a-z0-9,(){}\s]{1,}?)\s+(?:in|of)\s+([\s\S]{1,})$/i);if(!t)return;let n=t[1].replace(/^[\s({]*|[)}\s]*$/g,"");return n=n.match(/^([$_a-z0-9]{1,})?(?:,\s+?)?([$_a-z0-9]{1,})?(?:,\s+)?([$_a-z0-9]{1,})?$/i),n?(n.shift(),{iterable:t[2].trim(),variables:[...n]}):void 0})(t.getValue());if(!o)return void console.error("Doars: Error in `for` expression: ",t.getValue());t[r]||(t[r]=[]);const i=t[r],a={},c=e=>{a[e]||(a[e]=["$for"])};let l;l=isNaN(o.iterable)?n(e,t,o.iterable):Number(o.iterable);const u=typeof l;if("number"===u){for(let t=0;t<l;t++){const n=W(o.variables,t);H(e,c,s,i,t-1,l,n)}X(e,i,l)}else if("string"===u){for(let t=0;t<l.length;t++){const n=l[t],r=W(o.variables,n,t);H(e,c,s,i,t-1,n,r)}X(e,i,l.length)}else{let t,n;try{const e=[...l];t=!0,n=e.length}catch{}if(t)for(let t=0;t<n;t++){const n=l[t],r=W(o.variables,n,t);H(e,c,s,i,t-1,n,r)}else{const t=Object.keys(l);n=t.length;for(let r=0;r<n;r++){const n=t[r],a=l[n],u=W(o.variables,n,a,r);H(e,c,s,i,r-1,a,u)}}X(e,i,n)}Object.getOwnPropertySymbols(a).length>0&&e.update(a)},destroy:(e,t)=>{if(!e[r])return;if(!t[r])return;const n=t[r];for(const t of n)N(e,t,(()=>{t.remove()}));delete t[r]}},G={name:"html",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=n(e,t,t.getValue());r.innerHTML!==s&&(r.innerHTML=s)}},J={name:"if",update:(e,t,{executeExpression:n,transitionIn:r,transitionOut:o})=>{const i=t.getElement();if("TEMPLATE"!==i.tagName)return void console.warn("Doars: `if` directive must be placed on a `<template>` tag.");if(i.childCount>1)return void console.warn("Doars: `if` directive must have only one child node.");const a=n(e,t,t.getValue());let c=i[s];a?c||(c=document.importNode(i.content,!0),D(i,c),i[s]=c=i.nextElementSibling,r(e,c)):c&&o(e,c,(()=>{c.remove()}))},destroy:(e,t,{transitionOut:n})=>{const r=t.getElement(),o=r[s];o&&n(e,o,(()=>{o.remove(),r[s]=void 0}))}};const Q=(e,t)=>{if(!t[o])return;const n=e.getElement(),r=e.getLibrary().getOptions().prefix+"-updated";n.removeEventListener(r,t[o].handler),delete t[o]};var Y={name:"initialized",update:(e,t,{executeExpression:n})=>{const r=e.getElement(),s=t.getValue(),i=e.getLibrary().getOptions().prefix+"-updated";if(t[o]){if(t[o].value===s)return;r.removeEventListener(i,t[o].handler),delete t[o]}const a=({detail:o})=>{o.element===r&&(n(e,t.clone(),s,{},{return:!1}),Q(e,t))};r.addEventListener(i,a,{once:!0}),t[o]={handler:a,value:s}},destroy:Q};const Z=["alt","ctrl","meta","shift"];var ee={name:"on",update:(e,t,{executeExpression:n})=>{let r,s=t.getKeyRaw();if(!s)return void console.warn("Doars: `on` directive must have a key.");s.startsWith("keydown-")?(r=s.substring(8).toLowerCase(),s="keydown"):s.startsWith("keyup-")&&(r=s.substring(6).toLowerCase(),s="keyup");const o=t.getElement(),i=t.getValue();if(t[a]){if(t[a].value===i)return;t[a].target.removeEventListener(s,t[a].handler),t[a].timeout&&clearTimeout(t[a].timeout),delete t[a]}const c=t.getModifiers(),l={};c.capture&&(l.capture=!0),c.once&&(l.once=!0),c.passive&&(l.passive=!0);let u=0;c.buffer?(u=1,!0===c.buffer&&(c.buffer=5)):c.debounce?(u=2,!0===c.debounce&&(c.debounce=500)):c.throttle&&(u=3,!0===c.throttle&&(c.throttle=500));const d=[];if(r){c.meta=!!c.meta||c.cmd||c.super;for(const e of Z)c[e]&&d.push(e)}const f=l=>{if(c.self&&l.target!==o)return;if(c.outside&&o.contains(l.target))return;if(("keydown"===s||"keyup"===s)&&r){for(const e of d)if(!l[e+"Key"])return;let e=c.code?l.code:l.key;if(" "===e&&(e="space"),e=e.toLowerCase(),r!==e)return}c.prevent&&l.preventDefault(),c.stop&&l.stopPropagation();const f=()=>{n(e,t.clone(),i,{$event:l,$events:t[a].buffer},{return:!1}),t[a].buffer=[]};if(t[a].buffer.push(l),1===u){if(t[a].buffer.length<c.buffer)return;f()}else if(1===u)t[a].timeout&&(clearTimeout(t[a].timeout),t[a].timeout=null),t[a].timeout=setTimeout(f,c.debounce);else if(3===u){const e=window.performance.now();if(t[a].lastExecution&&e-t[a].lastExecution<c.throttle)return;f(),t[a].lastExecution=e}else f()},h=c.outside?document:o;h.addEventListener(s,f,l),t[a]={buffer:[],handler:f,target:h,timeout:t[a]?t[a].timeout:void 0,value:i}},destroy:(e,t)=>{if(!t[a])return;const n=t.getKeyRaw();t[a].target.removeEventListener(n,t[a].handler),t[a].timeout&&clearTimeout(t[a].timeout),delete t[a]}};const te=(e,t)=>{if(!e[c])return;const n=t.getId();if(!e[c][n])return;const r=e.getLibrary(),s=e.getId(),o=t.getValue().trim();delete e[c][n],delete e[l],0===Object.keys(e[c]).length&&delete e[c],r.update([{id:s,path:"$references."+o}])};var ne={name:"reference",update:(e,t)=>{const n=t.getValue().trim();if(!/^[_$a-z]{1}[_\-$a-z0-9]{0,}$/i.test(n))return te(e,t),void console.warn("Doars: `reference` directive's value not a valid variable name: \""+n+'".');const r=e.getLibrary(),s=e.getId(),o=t.getElement(),i=t.getId();e[c]||(e[c]={}),e[c][i]={element:o,name:n},delete e[l],r.update([{id:s,path:"$references."+n}])},destroy:te},re={name:"select",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=r.getAttribute("type");if("SELECT"!==r.tagName&&("INPUT"!==r.tagName||"checkbox"!==s&&"radio"!==s))return void console.warn("Doars: `select` directive must be placed on a `select` tag or `input` of type checkbox or radio.");const o=n(e,t,t.getValue());if("SELECT"===r.tagName)for(const e of Array.from(r.options)){const t=Array.isArray(o)?o.includes(e.value):o===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}else if("checkbox"===s){const e=o.includes(r.value);r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}else{const e=o===r.value;r.checked!==e&&(e?r.setAttribute("checked",""):r.removeAttribute("checked"))}}},se={name:"show",update:(e,t,{executeExpression:n,transitionIn:r,transitionOut:s})=>{const o=t.getElement();n(e,t,t.getValue())?(o.style.display=null,r(e,o)):s(e,o,(()=>{o.style.display="none"}))}};const oe=(e,t,n)=>{if("object"!=typeof e)return;let r=0;for(;r<t.length-1;r++)if("object"!=typeof(e=e[t[r]]))return;e[t[r]]=n},ie="$state.",ae=function(e,t,n){const r=(t,n)=>{n[e]&&(n.getElement().removeEventListener("input",n[e]),delete n[e])};return{update:(t,s,{executeExpression:o})=>{const i=s.getElement(),a=!s[e];if(a&&("DIV"!==i.tagName||!i.hasAttribute("contenteditable"))&&"INPUT"!==i.tagName&&"SELECT"!==i.tagName&&"TEXTAREA"!==i.tagName)return void console.warn("Doars: `sync` directive must be placed on an `<input>`, `<select>`, `<textarea>` tag, or a content editable `div`.");const c=s.getValue();if(!/^[_$a-z]{1}[._$a-z0-9]{0,}$/i.test(c))return r(0,s),void console.warn("Doars: `sync` directive's value not a valid variable name: \""+c+'".');let l=c;if(l.startsWith(n)&&(l=l.substring(n.length)),l=l.split("."),a){const{data:n,id:r,path:a}=((e,t)=>{let n=t.getValue();return n.startsWith(ie)||(n=ie+n),{data:e.getState(),id:e.getId(),path:n}})(t,s);let u;switch(i.tagName){case"DIV":u=()=>(oe(n,l,i.innerText),!0);break;case"INPUT":u=()=>{if("checkbox"===i.type){const e=o(t,s.clone(),c);if(i.checked){if(!e)return oe(n,l,[i.value]),!0;if(!e.includes(i.value))return e.push(i.value),!0}else if(e){const t=e.indexOf(i.value);if(t>=0)return e.splice(t,1),!0}}else{if("radio"!==i.type)return oe(n,l,i.value),!0;{const e=o(t,s.clone(),c);if(i.checked){if(e!==i.value)return oe(n,l,i.value),!0}else if(e===i.value)return oe(n,l,null),!0}}return!1};break;case"TEXTAREA":u=()=>(oe(n,l,i.value),!0);break;case"SELECT":u=()=>{if(i.multiple){const e=[];for(const t of i.selectedOptions)e.push(t.value);return oe(n,l,e),!0}return oe(n,l,i.selectedOptions[0].value),!0}}const d=()=>{u()&&t.getLibrary().update([{id:r,path:a}])};i.addEventListener("input",d),s[e]=d}const u=o(t,s,c);switch(i.tagName){case"DIV":case"TEXTAREA":u!==i.innerText&&(i.innerText=u);break;case"INPUT":if("checkbox"===i.type){const e=u.includes(i.value);i.checked!==e&&(i.checked=e,e?i.setAttribute("checked",""):i.removeAttribute("checked"))}else if("radio"===i.type){const e=u===i.value;i.checked!==e&&(i.checked=e,e?i.setAttribute("checked",""):i.removeAttribute("checked"))}else u!==i.value&&i.setAttribute("value",u);break;case"SELECT":for(const e of Array.from(i.options)){const t=Array.isArray(u)?u.includes(e.value):u===e.value;e.selected!==t&&(e.selected=t,t?e.setAttribute("selected",""):e.removeAttribute("selected"))}}},destroy:r}}(i,0,ie);ae.name="sync-state";var ce={name:"text",update:(e,t,{executeExpression:n})=>{const r=t.getElement(),s=t.getModifiers(),o=n(e,t,t.getValue());s.content?r.textContent!==o&&(r.textContent=o):r.innerText!==o&&(r.innerText=o)}},le={name:"watch",update:(e,t,{executeExpression:n})=>{const r=t.getValue();n(e,t,r,{},{return:!1})}};class ue extends u{constructor(r){super();let{prefix:s,root:o}=r=Object.assign({prefix:"d",root:document.body.firstElementChild},r);if("string"==typeof o&&(r.root=o=document.querySelector(o)),!s)return void console.error("Doars: `prefix` option not set.");if("string"!=typeof s)return void console.error("Doars: `prefix` option must be of type string.");if(!o)return void console.error("Doars: `root` option not set.");if("object"!=typeof o)return void console.error("Doars: `root` option must be a string or HTMLElement.");const i=Symbol();let a,c,l,u=!1,d=!1;const f=[],h=[C,T,P,I,R,z,M,U,_,V],p=[ne,K,B,G,J,ce,q,Y,ee,re,se,ae,le];let g,v,b;this.getEnabled=()=>u,this.getId=()=>i,this.getOptions=()=>Object.assign({},r),this.enable=()=>{if(u)return this;d=!1,a=[],l={},this.dispatchEvent("enabling",[this]),u=!0,g=p.map((e=>e.name)),v={};for(const e of p)v[e.name]=e;b=new RegExp("^"+s+"-("+g.join("|")+")(?:[$-_.a-z0-9]{0,})?$","i"),c=new MutationObserver(x.bind(this)),c.observe(o,{attributes:!0,childList:!0,subtree:!0});const e=s+n,t=o.querySelectorAll("["+e+"]");return y(o.hasAttribute(e)?o:null,...t),this.dispatchEvent("enabled",[this]),this.dispatchEvent("updated",[this]),this},this.disable=()=>u?(c.disconnect(),c=null,d=a=l=null,this.dispatchEvent("disabling",[this],{reverse:!0}),E(...f),g=v=b=null,u=!1,this.dispatchEvent("disabled",[this],{reverse:!0}),this):this;const y=(...e)=>{const n=[],r=[];for(const s of e){if(!s)continue;if(s[t])continue;const e=new S(this,s);f.push(e),n.push(e),r.push(s)}r.length>0&&this.dispatchEvent("components-added",[this,r]);for(const e of n)e.initialize();for(const e of n)e.updateAttributes(e.getAttributes());return n},E=(...e)=>{const t=[];for(const n of e){const e=f.indexOf(n);e<0||(t.push(n.getElement()),n.destroy(),f.splice(e,1))}return t.length>0&&this.dispatchEvent("components-removed",[this,t]),t};this.getContexts=()=>[...h],this.addContexts=(e,...t)=>{if(u)return void console.warn("Doars: Unable to add contexts after being enabled!");e<0?e=h.length+e%h.length:e>h.length&&(e=h.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];h.includes(s)||(h.splice(e+r,0,s),n.push(s))}return n.length>0&&this.dispatchEvent("contexts-added",[this,n]),n},this.removeContexts=(...e)=>{if(u)return void console.warn("Doars: Unable to remove contexts after being enabled!");const t=[];for(const n of e)h.indexOf(n)<0||t.push(n);return t.length>0&&this.dispatchEvent("contexts-removed",[this,t]),t},this.getDirectives=()=>[...p],this.getDirectivesNames=()=>[...g],this.getDirectivesObject=()=>Object.assign({},v),this.isDirectiveName=e=>b.test(e),this.addDirectives=(e,...t)=>{if(u)return void console.warn("Doars: Unable to add directives after being enabled!");e<0?e=p.length+e%p.length:e>p.length&&(e=p.length);const n=[];for(let r=0;r<t.length;r++){const s=t[r];p.includes(s)||(p.splice(e+r,0,s),n.push(s))}return n.length>0&&(g=v=b=null,this.dispatchEvent("directives-added",[this,n])),n},this.removeDirectives=(...e)=>{if(u)return void console.warn("Doars: Unable to remove directives after being enabled!");const t=[];for(const n of e)p.indexOf(n)<0||t.push(n);return t.length>0&&(g=v=b=null,this.dispatchEvent("directives-removed",[this,t])),t},this.update=e=>{if(u){if(e)for(const t of e){const{id:e,path:n}=t;e in l?l[e].includes(n)||l[e].push(n):l[e]=[n]}if(!d&&0!==Object.getOwnPropertySymbols(l).length){d=!0,e=l,l={};for(const t of f)t.update(e);if(d=!1,Object.getOwnPropertySymbols(l).length>0)return console.warn("Doars: during an update another update has been triggered. Normally this should not happen unless an expression in one of the directives is modifying a state which could cause a infinite loop!"),void window.requestAnimationFrame((()=>this.update()));a.length>0?x():this.dispatchEvent("updated",[this])}}};const x=r=>{if(a.push(...r),d)return;if(0===a.length)return;d=!0,r=[...a],a=[];const o=s+n,i=[],c=[];for(const n of r)if("childList"===n.type){for(let r of n.removedNodes)if(1===r.nodeType)if(r[t]){c.unshift(r[t]);const e=r.querySelectorAll(o);for(const n of e)n[t]&&c.unshift(n)}else{const n=$(r,(e=>!e[t]||(c.unshift(e[t]),!1)));do{if(r[e])for(const t of r[e])t.getComponent().removeAttribute(t)}while(r=n())}for(const e of n.addedNodes){if(1!==e.nodeType)continue;const t=e.querySelectorAll("["+o+"]");for(const e of t)i.push(e);if(e.hasAttribute(o)){i.push(e);continue}const n=m(e);if(n){const t=n.scanAttributes(e);n.updateAttributes(t)}}}else if("attributes"===n.type){if(n.attributeName===o){if(n.target[t])continue;const r=m(n.target);if(r){let t=n.target;const s=$(t,(e=>e.hasAttribute(o)));do{for(const n of t[e])r.removeAttribute(n)}while(t=s())}y(n.target);continue}if(!b.test(n.attributeName))continue;const r=m(n.target);if(!r)continue;let s=null;for(const t of n.target[e])if(t.getName()===n.attributeName){s=t;break}const i=n.target.getAttribute(n.attributeName);if(!s){i&&r.addAttribute(n.target,n.attributeName,i);continue}s.setValue(i),r.updateAttribute(s)}c.length>0&&E(...c),i.length>0&&y(...i),d=!1,a.length>0?x():Object.getOwnPropertySymbols(l).length>0&&this.update()}}}const de=function(){(new ue).enable()};"complete"===document.readyState||"interactive"===document.readyState?de():document.addEventListener("DOMContentLoaded",de,{once:!0,passive:!0}),window.copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,document.body.append(t),t.select(),t.setSelectionRange(0,999999),document.execCommand("copy"),t.remove()};let fe=0,he=document.getElementById("counter-text");window.increment=()=>{fe++,he.setAttribute("d-text",fe)}}();
